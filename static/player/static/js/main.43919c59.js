(()=>{var e={11:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte),i=(n.new_double,n.new_float,n.new_float_n,n.new_int,n.new_int_n,n.assert),o=a(466),s=a(811),l=a(710),c=a(568),u=a(320),d=a(328),_=a(590),f=a(293),h=a(408),m=(a(191),a(155)),p=a(81);function g(){this.setModules=function(e,t){0}}function b(){this.setModules=function(e,t,a){0}}function v(){}function S(){this.setModules=function(e,t){0}}function y(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function w(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}y.RIFF=w("RIFF"),y.WAVE=w("WAVE"),y.fmt_=w("fmt "),y.data=w("data"),y.readHeader=function(e){var t=new y,a=e.getUint32(0,!1);if(y.RIFF==a){e.getUint32(4,!0);if(y.WAVE==e.getUint32(8,!1)&&y.fmt_==e.getUint32(12,!1)){var n=e.getUint32(16,!0),r=20;switch(n){case 16:case 18:t.channels=e.getUint16(r+2,!0),t.sampleRate=e.getUint32(r+4,!0);break;default:throw"extended fmt chunk not implemented"}r+=n;for(var i=y.data,o=0;i!=a&&(a=e.getUint32(r,!1),o=e.getUint32(r+4,!0),i!=a);)r+=o+8;return t.dataLen=o,t.dataOffset=r+8,t}}},e.exports.x=function(e,t,a){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,a=128);var n=new o,y=new g,w=new l,E=new h,A=new s,x=new c,T=new u,B=new p,R=new m,M=new S,P=new _,k=new d,I=new b,L=new v;n.setModules(w,E,A,x,T,B,R,M,L),E.setModules(w,L,R,B),M.setModules(E,R),A.setModules(n),T.setModules(E,P,x,k),x.setModules(k,P,n.enc.psy),P.setModules(E),k.setModules(x),B.setModules(n,E,R),y.setModules(I,L),I.setModules(R,M,A);var C=n.lame_init();C.num_channels=e,C.in_samplerate=t,C.brate=a,C.mode=f.STEREO,C.quality=3,C.bWriteVbrTag=!1,C.disable_reservoir=!0,C.write_id3tag_automatic=!1;var D=n.lame_init_params(C);i(0==D);var N=1152,O=0|1.25*N+7200,F=r(O);this.encodeBuffer=function(t,a){1==e&&(a=t),i(t.length==a.length),t.length>N&&(N=t.length,F=r(O=0|1.25*N+7200));var o=n.lame_encode_buffer(C,t,a,t.length,F,0,O);return new Int8Array(F.subarray(0,o))},this.flush=function(){var e=n.lame_encode_flush(C,F,0,O);return new Int8Array(F.subarray(0,e))}},e.exports.E=y},17:(e,t,a)=>{var n=a(191),r={};r.SFBMAX=3*n.SBMAX_s,e.exports=r},42:(e,t,a)=>{var n=a(330),r=n.new_float,i=n.new_int;n.assert;e.exports=function(){this.global_gain=0,this.sfb_count1=0,this.step=i(39),this.noise=r(39),this.noise_log=r(39)}},45:(e,t,a)=>{var n=a(738).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},52:(e,t,a)=>{var n=a(330),r=n.System,i=(n.VbrMode,n.Float,n.ShortBlock,n.Util),o=n.Arrays,s=(n.new_array_n,n.new_byte,n.new_double,n.new_float),l=(n.new_float_n,n.new_int,n.new_int_n,n.assert,a(191));e.exports=function(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*i.SQRT2*.5/2384e-9,.017876148*i.SQRT2*.5/2384e-9,.003134727*i.SQRT2*.5/2384e-9,.002457142*i.SQRT2*.5/2384e-9,971317e-9*i.SQRT2*.5/2384e-9,218868e-9*i.SQRT2*.5/2384e-9,101566e-9*i.SQRT2*.5/2384e-9,13828e-9*i.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],a=t[l.SHORT_TYPE],n=t[l.SHORT_TYPE],c=t[l.SHORT_TYPE],u=t[l.SHORT_TYPE],d=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function _(t,a,n){for(var r,o,s,l=10,c=a+238-14-286,u=-15;u<0;u++){var d,_,f;d=e[l+-10],_=t[c+-224]*d,f=t[a+224]*d,d=e[l+-9],_+=t[c+-160]*d,f+=t[a+160]*d,d=e[l+-8],_+=t[c+-96]*d,f+=t[a+96]*d,d=e[l+-7],_+=t[c+-32]*d,f+=t[a+32]*d,d=e[l+-6],_+=t[c+32]*d,f+=t[a+-32]*d,d=e[l+-5],_+=t[c+96]*d,f+=t[a+-96]*d,d=e[l+-4],_+=t[c+160]*d,f+=t[a+-160]*d,d=e[l+-3],_+=t[c+224]*d,f+=t[a+-224]*d,d=e[l+-2],_+=t[a+-256]*d,f-=t[c+256]*d,d=e[l+-1],_+=t[a+-192]*d,f-=t[c+192]*d,d=e[l+0],_+=t[a+-128]*d,f-=t[c+128]*d,d=e[l+1],_+=t[a+-64]*d,f-=t[c+64]*d,d=e[l+2],_+=t[a+0]*d,f-=t[c+0]*d,d=e[l+3],_+=t[a+64]*d,f-=t[c+-64]*d,d=e[l+4],_+=t[a+128]*d,f-=t[c+-128]*d,d=e[l+5],_+=t[a+192]*d,d=(f-=t[c+-192]*d)-(_*=e[l+6]),n[30+2*u]=f+_,n[31+2*u]=e[l+7]*d,l+=18,a--,c++}f=t[a+-16]*e[l+-10],_=t[a+-32]*e[l+-2],f+=(t[a+-48]-t[a+16])*e[l+-9],_+=t[a+-96]*e[l+-1],f+=(t[a+-80]+t[a+48])*e[l+-8],_+=t[a+-160]*e[l+0],f+=(t[a+-112]-t[a+80])*e[l+-7],_+=t[a+-224]*e[l+1],f+=(t[a+-144]+t[a+112])*e[l+-6],_-=t[a+32]*e[l+2],f+=(t[a+-176]-t[a+144])*e[l+-5],_-=t[a+96]*e[l+3],f+=(t[a+-208]+t[a+176])*e[l+-4],_-=t[a+160]*e[l+4],f+=(t[a+-240]-t[a+208])*e[l+-3],r=(_-=t[a+224])-f,o=_+f,f=n[14],_=n[15]-f,n[31]=o+f,n[30]=r+_,n[15]=r-_,n[14]=o-f,s=n[28]-n[0],n[0]+=n[28],n[28]=s*e[l+-36+7],s=n[29]-n[1],n[1]+=n[29],n[29]=s*e[l+-36+7],s=n[26]-n[2],n[2]+=n[26],n[26]=s*e[l+-72+7],s=n[27]-n[3],n[3]+=n[27],n[27]=s*e[l+-72+7],s=n[24]-n[4],n[4]+=n[24],n[24]=s*e[l+-108+7],s=n[25]-n[5],n[5]+=n[25],n[25]=s*e[l+-108+7],s=n[22]-n[6],n[6]+=n[22],n[22]=s*i.SQRT2,s=n[23]-n[7],n[7]+=n[23],n[23]=s*i.SQRT2-n[7],n[7]-=n[6],n[22]-=n[7],n[23]-=n[22],s=n[6],n[6]=n[31]-s,n[31]=n[31]+s,s=n[7],n[7]=n[30]-s,n[30]=n[30]+s,s=n[22],n[22]=n[15]-s,n[15]=n[15]+s,s=n[23],n[23]=n[14]-s,n[14]=n[14]+s,s=n[20]-n[8],n[8]+=n[20],n[20]=s*e[l+-180+7],s=n[21]-n[9],n[9]+=n[21],n[21]=s*e[l+-180+7],s=n[18]-n[10],n[10]+=n[18],n[18]=s*e[l+-216+7],s=n[19]-n[11],n[11]+=n[19],n[19]=s*e[l+-216+7],s=n[16]-n[12],n[12]+=n[16],n[16]=s*e[l+-252+7],s=n[17]-n[13],n[13]+=n[17],n[17]=s*e[l+-252+7],s=-n[20]+n[24],n[20]+=n[24],n[24]=s*e[l+-216+7],s=-n[21]+n[25],n[21]+=n[25],n[25]=s*e[l+-216+7],s=n[4]-n[8],n[4]+=n[8],n[8]=s*e[l+-216+7],s=n[5]-n[9],n[5]+=n[9],n[9]=s*e[l+-216+7],s=n[0]-n[12],n[0]+=n[12],n[12]=s*e[l+-72+7],s=n[1]-n[13],n[1]+=n[13],n[13]=s*e[l+-72+7],s=n[16]-n[28],n[16]+=n[28],n[28]=s*e[l+-72+7],s=-n[17]+n[29],n[17]+=n[29],n[29]=s*e[l+-72+7],s=i.SQRT2*(n[2]-n[10]),n[2]+=n[10],n[10]=s,s=i.SQRT2*(n[3]-n[11]),n[3]+=n[11],n[11]=s,s=i.SQRT2*(-n[18]+n[26]),n[18]+=n[26],n[26]=s-n[18],s=i.SQRT2*(-n[19]+n[27]),n[19]+=n[27],n[27]=s-n[19],s=n[2],n[19]-=n[3],n[3]-=s,n[2]=n[31]-s,n[31]+=s,s=n[3],n[11]-=n[19],n[18]-=s,n[3]=n[30]-s,n[30]+=s,s=n[18],n[27]-=n[11],n[19]-=s,n[18]=n[15]-s,n[15]+=s,s=n[19],n[10]-=s,n[19]=n[14]-s,n[14]+=s,s=n[10],n[11]-=s,n[10]=n[23]-s,n[23]+=s,s=n[11],n[26]-=s,n[11]=n[22]-s,n[22]+=s,s=n[26],n[27]-=s,n[26]=n[7]-s,n[7]+=s,s=n[27],n[27]=n[6]-s,n[6]+=s,s=i.SQRT2*(n[0]-n[4]),n[0]+=n[4],n[4]=s,s=i.SQRT2*(n[1]-n[5]),n[1]+=n[5],n[5]=s,s=i.SQRT2*(n[16]-n[20]),n[16]+=n[20],n[20]=s,s=i.SQRT2*(n[17]-n[21]),n[17]+=n[21],n[21]=s,s=-i.SQRT2*(n[8]-n[12]),n[8]+=n[12],n[12]=s-n[8],s=-i.SQRT2*(n[9]-n[13]),n[9]+=n[13],n[13]=s-n[9],s=-i.SQRT2*(n[25]-n[29]),n[25]+=n[29],n[29]=s-n[25],s=-i.SQRT2*(n[24]+n[28]),n[24]-=n[28],n[28]=s-n[24],s=n[24]-n[16],n[24]=s,s=n[20]-s,n[20]=s,s=n[28]-s,n[28]=s,s=n[25]-n[17],n[25]=s,s=n[21]-s,n[21]=s,s=n[29]-s,n[29]=s,s=n[17]-n[1],n[17]=s,s=n[9]-s,n[9]=s,s=n[25]-s,n[25]=s,s=n[5]-s,n[5]=s,s=n[21]-s,n[21]=s,s=n[13]-s,n[13]=s,s=n[29]-s,n[29]=s,s=n[1]-n[0],n[1]=s,s=n[16]-s,n[16]=s,s=n[17]-s,n[17]=s,s=n[8]-s,n[8]=s,s=n[9]-s,n[9]=s,s=n[24]-s,n[24]=s,s=n[25]-s,n[25]=s,s=n[4]-s,n[4]=s,s=n[5]-s,n[5]=s,s=n[20]-s,n[20]=s,s=n[21]-s,n[21]=s,s=n[12]-s,n[12]=s,s=n[13]-s,n[13]=s,s=n[28]-s,n[28]=s,s=n[29]-s,n[29]=s,s=n[0],n[0]+=n[31],n[31]-=s,s=n[1],n[1]+=n[30],n[30]-=s,s=n[16],n[16]+=n[15],n[15]-=s,s=n[17],n[17]+=n[14],n[14]-=s,s=n[8],n[8]+=n[23],n[23]-=s,s=n[9],n[9]+=n[22],n[22]-=s,s=n[24],n[24]+=n[7],n[7]-=s,s=n[25],n[25]+=n[6],n[6]-=s,s=n[4],n[4]+=n[27],n[27]-=s,s=n[5],n[5]+=n[26],n[26]-=s,s=n[20],n[20]+=n[11],n[11]-=s,s=n[21],n[21]+=n[10],n[10]-=s,s=n[12],n[12]+=n[19],n[19]-=s,s=n[13],n[13]+=n[18],n[18]-=s,s=n[28],n[28]+=n[3],n[3]-=s,s=n[29],n[29]+=n[2],n[2]-=s}function f(e,a){for(var n=0;n<3;n++){var r,i,o,s,c,u;i=(s=e[a+6]*t[l.SHORT_TYPE][0]-e[a+15])+(r=e[a+0]*t[l.SHORT_TYPE][2]-e[a+9]),o=s-r,c=(s=e[a+15]*t[l.SHORT_TYPE][0]+e[a+6])+(r=e[a+9]*t[l.SHORT_TYPE][2]+e[a+0]),u=-s+r,r=2069978111953089e-26*(e[a+3]*t[l.SHORT_TYPE][1]-e[a+12]),s=2069978111953089e-26*(e[a+12]*t[l.SHORT_TYPE][1]+e[a+3]),e[a+0]=190752519173728e-25*i+r,e[a+15]=190752519173728e-25*-c+s,o=.8660254037844387*o*1907525191737281e-26,c=.5*c*1907525191737281e-26+s,e[a+3]=o-c,e[a+6]=o+c,i=.5*i*1907525191737281e-26-r,u=.8660254037844387*u*1907525191737281e-26,e[a+9]=i+u,e[a+12]=i-u,a++}}function h(e,t,a){var r,i,o,s,l,c,u,d,_,f,h,m,p,g,b,v,S,y;o=a[17]-a[9],l=a[15]-a[11],c=a[14]-a[12],u=a[0]+a[8],d=a[1]+a[7],_=a[2]+a[6],f=a[3]+a[5],e[t+17]=u+_-f-(d-a[4]),i=(u+_-f)*n[19]+(d-a[4]),r=(o-l-c)*n[18],e[t+5]=r+i,e[t+6]=r-i,s=(a[16]-a[10])*n[18],d=d*n[19]+a[4],r=o*n[12]+s+l*n[13]+c*n[14],i=-u*n[16]+d-_*n[17]+f*n[15],e[t+1]=r+i,e[t+2]=r-i,r=o*n[13]-s-l*n[14]+c*n[12],i=-u*n[17]+d-_*n[15]+f*n[16],e[t+9]=r+i,e[t+10]=r-i,r=o*n[14]-s+l*n[12]-c*n[13],i=u*n[15]-d+_*n[16]-f*n[17],e[t+13]=r+i,e[t+14]=r-i,h=a[8]-a[0],p=a[6]-a[2],g=a[5]-a[3],b=a[17]+a[9],v=a[16]+a[10],S=a[15]+a[11],y=a[14]+a[12],e[t+0]=b+S+y+(v+a[13]),r=(b+S+y)*n[19]-(v+a[13]),i=(h-p+g)*n[18],e[t+11]=r+i,e[t+12]=r-i,m=(a[7]-a[1])*n[18],v=a[13]-v*n[19],r=b*n[15]-v+S*n[16]+y*n[17],i=h*n[14]+m+p*n[12]+g*n[13],e[t+3]=r+i,e[t+4]=r-i,r=-b*n[17]+v-S*n[15]-y*n[16],i=h*n[13]+m-p*n[14]-g*n[12],e[t+7]=r+i,e[t+8]=r-i,r=-b*n[16]+v-S*n[17]-y*n[15],i=h*n[12]-m+p*n[13]-g*n[14],e[t+15]=r+i,e[t+16]=r-i}this.mdct_sub48=function(e,n,i){for(var m=n,p=286,g=0;g<e.channels_out;g++){for(var b=0;b<e.mode_gr;b++){for(var v,S=e.l3_side.tt[b][g],y=S.xr,w=0,E=e.sb_sample[g][1-b],A=0,x=0;x<9;x++)for(_(m,p,E[A]),_(m,p+32,E[A+1]),A+=2,p+=64,v=1;v<32;v+=2)E[A-1][v]*=-1;for(v=0;v<32;v++,w+=18){var T=S.block_type,B=e.sb_sample[g][b],R=e.sb_sample[g][1-b];if(0!=S.mixed_block_flag&&v<2&&(T=0),e.amp_filter[v]<1e-12)o.fill(y,w+0,w+18,0);else{if(e.amp_filter[v]<1)for(x=0;x<18;x++)R[x][d[v]]*=e.amp_filter[v];if(T==l.SHORT_TYPE){for(x=-3;x<0;x++){var M=t[l.SHORT_TYPE][x+3];y[w+3*x+9]=B[9+x][d[v]]*M-B[8-x][d[v]],y[w+3*x+18]=B[14-x][d[v]]*M+B[15+x][d[v]],y[w+3*x+10]=B[15+x][d[v]]*M-B[14-x][d[v]],y[w+3*x+19]=R[2-x][d[v]]*M+R[3+x][d[v]],y[w+3*x+11]=R[3+x][d[v]]*M-R[2-x][d[v]],y[w+3*x+20]=R[8-x][d[v]]*M+R[9+x][d[v]]}f(y,w)}else{var P=s(18);for(x=-9;x<0;x++){var k,I;k=t[T][x+27]*R[x+9][d[v]]+t[T][x+36]*R[8-x][d[v]],I=t[T][x+9]*B[x+9][d[v]]-t[T][x+18]*B[8-x][d[v]],P[x+9]=k-I*a[3+x+9],P[x+18]=k*a[3+x+9]+I}h(y,w,P)}}if(T!=l.SHORT_TYPE&&0!=v)for(x=7;x>=0;--x){var L,C;L=y[w+x]*c[20+x]+y[w+-1-x]*u[28+x],C=y[w+x]*u[28+x]-y[w+-1-x]*c[20+x],y[w+-1-x]=L,y[w+x]=C}}}if(m=i,p=286,1==e.mode_gr)for(var D=0;D<18;D++)r.arraycopy(e.sb_sample[g][1][D],0,e.sb_sample[g][0][D],0,32)}}}},81:(e,t,a)=>{var n=a(330),r=n.System,i=n.VbrMode,o=(n.Float,n.ShortBlock),s=(n.Util,n.Arrays),l=(n.new_array_n,n.new_byte),c=(n.new_double,n.new_float,n.new_float_n,n.new_int,n.new_int_n,n.assert);function u(){var e,t,a;this.setModules=function(n,r,i){e=n,t=r,a=i};var n=u.NUMTOCENTRIES,d=u.MAXFRAMESIZE,_=n+4+4+4+4+4+9+1+1+8+1+1+3+1+1+2+4+2+2,f="Xing",h="Info",m=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function p(e,t){var a=255&e[t+0];return a<<=8,a|=255&e[t+1],a<<=8,a|=255&e[t+2],a<<=8,a|=255&e[t+3]}function g(e,t,a){e[t+0]=255&a>>24,e[t+1]=255&a>>16,e[t+2]=255&a>>8,e[t+3]=255&a}function b(e,t,a){e[t+0]=255&a>>8,e[t+1]=255&a}function v(e,t,a){return 255&(e<<t|a&~(-1<<t))}function S(t,a){var n=t.internal_flags;a[0]=v(a[0],8,255),a[1]=v(a[1],3,7),a[1]=v(a[1],1,t.out_samplerate<16e3?0:1),a[1]=v(a[1],1,t.version),a[1]=v(a[1],2,1),a[1]=v(a[1],1,t.error_protection?0:1),a[2]=v(a[2],4,n.bitrate_index),a[2]=v(a[2],2,n.samplerate_index),a[2]=v(a[2],1,0),a[2]=v(a[2],1,t.extension),a[3]=v(a[3],2,t.mode.ordinal()),a[3]=v(a[3],2,n.mode_ext),a[3]=v(a[3],1,t.copyright),a[3]=v(a[3],1,t.original),a[3]=v(a[3],2,t.emphasis),a[0]=255;var r,o,s=241&a[1];r=1==t.version?128:t.out_samplerate<16e3?32:64,t.VBR==i.vbr_off&&(r=t.brate),o=t.free_format?0:255&16*e.BitrateIndex(r,t.version,t.out_samplerate),1==t.version?(a[1]=255&s|10,s=13&a[2],a[2]=255&(o|s)):(a[1]=255&s|2,s=13&a[2],a[2]=255&(o|s))}function y(e,t){return t=t>>8^m[255&(t^e)]}this.addVbrFrame=function(e){var t=e.internal_flags,a=Tables.bitrate_table[e.version][t.bitrate_index];c(null!=t.VBR_seek_table.bag),function(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var a=1;a<e.size;a+=2)e.bag[a/2]=e.bag[a];e.want*=2,e.pos/=2}}(t.VBR_seek_table,a)},this.getVbrTag=function(e){var t=new VBRTagData,a=0;t.flags=0;var r=e[a+1]>>3&1,i=e[a+2]>>2&3,o=e[a+3]>>6&3,s=e[a+2]>>4&15;if(s=Tables.bitrate_table[r][s],e[a+1]>>4==14?t.samprate=Tables.samplerate_table[2][i]:t.samprate=Tables.samplerate_table[r][i],!function(e,t){return new String(e,t,4(),null).equals(f)||new String(e,t,4(),null).equals(h)}(e,a+=0!=r?3!=o?36:21:3!=o?21:13))return null;a+=4,t.hId=r;var l=t.flags=p(e,a);if(a+=4,0!=(1&l)&&(t.frames=p(e,a),a+=4),0!=(2&l)&&(t.bytes=p(e,a),a+=4),0!=(4&l)){if(null!=t.toc)for(var c=0;c<n;c++)t.toc[c]=e[a+c];a+=n}t.vbrScale=-1,0!=(8&l)&&(t.vbrScale=p(e,a),a+=4),t.headersize=72e3*(r+1)*s/t.samprate;var u=e[(a+=21)+0]<<4;u+=e[a+1]>>4;var d=(15&e[a+1])<<8;return(u<0||u>3e3)&&(u=-1),((d+=255&e[a+2])<0||d>3e3)&&(d=-1),t.encDelay=u,t.encPadding=d,t},this.InitVbrTag=function(e){var a,n=e.internal_flags;a=1==e.version?128:e.out_samplerate<16e3?32:64,e.VBR==i.vbr_off&&(a=e.brate);var r=72e3*(e.version+1)*a/e.out_samplerate,o=n.sideinfo_len+_;if(n.VBR_seek_table.TotalFrameSize=r,r<o||r>d)e.bWriteVbrTag=!1;else{n.VBR_seek_table.nVbrNumFrames=0,n.VBR_seek_table.nBytesWritten=0,n.VBR_seek_table.sum=0,n.VBR_seek_table.seen=0,n.VBR_seek_table.want=1,n.VBR_seek_table.pos=0,null==n.VBR_seek_table.bag&&(n.VBR_seek_table.bag=new int[400],n.VBR_seek_table.size=400);var s=l(d);S(e,s);for(var c=n.VBR_seek_table.TotalFrameSize,u=0;u<c;++u)t.add_dummy_byte(e,255&s[u],1)}},this.updateMusicCRC=function(e,t,a,n){for(var r=0;r<n;++r)e[0]=y(t[a+r],e[0])},this.getLameTagFrame=function(e,c){var u=e.internal_flags;if(!e.bWriteVbrTag)return 0;if(u.Class_ID!=Lame.LAME_ID)return 0;if(u.VBR_seek_table.pos<=0)return 0;if(c.length<u.VBR_seek_table.TotalFrameSize)return u.VBR_seek_table.TotalFrameSize;s.fill(c,0,u.VBR_seek_table.TotalFrameSize,0),S(e,c);var d=l(n);if(e.free_format)for(var _=1;_<n;++_)d[_]=255&255*_/100;else!function(e,t){if(!(e.pos<=0))for(var a=1;a<n;++a){var r=a/n,i=0|Math.floor(r*e.pos);i>e.pos-1&&(i=e.pos-1);var o=0|256*e.bag[i]/e.sum;o>255&&(o=255),t[a]=255&o}}(u.VBR_seek_table,d);var m=u.sideinfo_len;e.error_protection&&(m-=2),e.VBR==i.vbr_off?(c[m++]=255&h.charAt(0),c[m++]=255&h.charAt(1),c[m++]=255&h.charAt(2),c[m++]=255&h.charAt(3)):(c[m++]=255&f.charAt(0),c[m++]=255&f.charAt(1),c[m++]=255&f.charAt(2),c[m++]=255&f.charAt(3)),g(c,m,15),g(c,m+=4,u.VBR_seek_table.nVbrNumFrames),m+=4;var p=u.VBR_seek_table.nBytesWritten+u.VBR_seek_table.TotalFrameSize;g(c,m,0|p),m+=4,r.arraycopy(d,0,c,m,d.length),m+=d.length,e.error_protection&&t.CRC_writeheader(u,c);var v=0;for(_=0;_<m;_++)v=y(c[_],v);return m+=function(e,t,n,r,i){var s,l,c,u,d,_=e.internal_flags,f=0,h=e.encoder_delay,m=e.encoder_padding,p=100-10*e.VBR_q-e.quality,v=a.getLameVeryShortVersion(),S=[1,5,3,2,4,0,3],w=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),E=0,A=0,x=e.internal_flags.noise_shaping,T=0,B=0,R=0,M=0!=(1&e.exp_nspsytune),P=0!=(2&e.exp_nspsytune),k=!1,I=!1,L=e.internal_flags.nogap_total,C=e.internal_flags.nogap_current,D=e.ATHtype;switch(e.VBR){case vbr_abr:d=e.VBR_mean_bitrate_kbps;break;case vbr_off:d=e.brate;break;default:d=e.VBR_min_bitrate_kbps}switch(s=0+(e.VBR.ordinal()<S.length?S[e.VBR.ordinal()]:0),_.findReplayGain&&(_.RadioGain>510&&(_.RadioGain=510),_.RadioGain<-510&&(_.RadioGain=-510),A=8192,A|=3072,_.RadioGain>=0?A|=_.RadioGain:(A|=512,A|=-_.RadioGain)),_.findPeakSample&&(E=Math.abs(0|_.PeakSample/32767*Math.pow(2,23)+.5)),-1!=L&&(C>0&&(I=!0),C<L-1&&(k=!0)),u=D+((M?1:0)<<4)+((P?1:0)<<5)+((k?1:0)<<6)+((I?1:0)<<7),p<0&&(p=0),e.mode){case MONO:T=0;break;case STEREO:T=1;break;case DUAL_CHANNEL:T=2;break;case JOINT_STEREO:T=e.force_ms?4:3;break;case NOT_SET:default:T=7}R=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==o.short_block_forced||e.short_blocks==o.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==D||e.in_samplerate<=32e3)&&(B=1),l=x+(T<<2)+(B<<5)+(R<<6),c=_.nMusicCRC,g(n,r+f,p),f+=4;for(var N=0;N<9;N++)n[r+f+N]=255&v.charAt(N);n[r+(f+=9)]=255&s,n[r+ ++f]=255&w,g(n,r+ ++f,E),b(n,r+(f+=4),A),b(n,r+(f+=2),0),n[r+(f+=2)]=255&u,n[r+ ++f]=d>=255?255:255&d,n[r+ ++f]=255&h>>4,n[r+f+1]=255&(h<<4)+(m>>8),n[r+f+2]=255&m,n[r+(f+=3)]=255&l,f++,n[r+f++]=0,b(n,r+f,e.preset),g(n,r+(f+=2),t),b(n,r+(f+=4),c),f+=2;for(var O=0;O<f;O++)i=y(n[r+O],i);return b(n,r+f,i),f+2}(e,p,c,m,v),u.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){if(e.internal_flags.VBR_seek_table.pos<=0)return-1;if(t.seek(t.length()),0==t.length())return-1;var a=function(e){e.seek(0);var t=l(10);return e.readFully(t),new String(t,"ISO-8859-1").startsWith("ID3")?0:((127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9])+t.length}(t);t.seek(a);var n=l(d),r=getLameTagFrame(e,n);return r>n.length?-1:(r<1||t.write(n,0,r),0)}}u.NUMTOCENTRIES=100,u.MAXFRAMESIZE=2880,e.exports=u},94:e=>{function t(e,t,a,n){this.xlen=e,this.linmax=t,this.table=a,this.hlen=n}var a={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};a.ht=[new t(0,0,null,null),new t(2,0,a.t1HB,a.t1l),new t(3,0,a.t2HB,a.t2l),new t(3,0,a.t3HB,a.t3l),new t(0,0,null,null),new t(4,0,a.t5HB,a.t5l),new t(4,0,a.t6HB,a.t6l),new t(6,0,a.t7HB,a.t7l),new t(6,0,a.t8HB,a.t8l),new t(6,0,a.t9HB,a.t9l),new t(8,0,a.t10HB,a.t10l),new t(8,0,a.t11HB,a.t11l),new t(8,0,a.t12HB,a.t12l),new t(16,0,a.t13HB,a.t13l),new t(0,0,null,a.t16_5l),new t(16,0,a.t15HB,a.t15l),new t(1,1,a.t16HB,a.t16l),new t(2,3,a.t16HB,a.t16l),new t(3,7,a.t16HB,a.t16l),new t(4,15,a.t16HB,a.t16l),new t(6,63,a.t16HB,a.t16l),new t(8,255,a.t16HB,a.t16l),new t(10,1023,a.t16HB,a.t16l),new t(13,8191,a.t16HB,a.t16l),new t(4,15,a.t24HB,a.t24l),new t(5,31,a.t24HB,a.t24l),new t(6,63,a.t24HB,a.t24l),new t(7,127,a.t24HB,a.t24l),new t(8,255,a.t24HB,a.t24l),new t(9,511,a.t24HB,a.t24l),new t(11,2047,a.t24HB,a.t24l),new t(13,8191,a.t24HB,a.t24l),new t(0,0,a.t32HB,a.t32l),new t(0,0,a.t33HB,a.t33l)],a.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],a.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],a.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],a.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],a.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],a.scfsi_band=[0,6,11,16,21],e.exports=a},134:e=>{e.exports=function(e){this.bits=e}},155:e=>{e.exports=function(){this.getLameVersion=function(){return"3.98.4"},this.getLameShortVersion=function(){return"3.98.4"},this.getLameVeryShortVersion=function(){return"LAME3.98r"},this.getPsyVersion=function(){return"0.93"},this.getLameUrl=function(){return"http://www.mp3dev.org/"},this.getLameOsBitness=function(){return"32bits"}}},161:(e,t,a)=>{var n=a(640);e.exports=function(){this.thm=new n,this.en=new n}},173:(e,t,a)=>{var n=a(693).default;class r{}n(r,"voices",[{voiceURI:"ttsreaderServer.gcp.en-US-Chirp-HD-D",name:"John Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"m",avatar:"/images/avatars/ttsreaderServer.gcp.en-US-Chirp-HD-D.webp",demo:"/audio/ttsreaderServer.gcp.en-US-Chirp-HD-D.mp3"},{voiceURI:"ttsreaderServer.azure.en-US-NovaTurboMultilingualNeural",name:"Nova Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.it-IT-AlessioMultilingualNeural",name:"Alessio Premium",lang:"it-IT",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.core1.StevenMultilingual",name:"Steven Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.core1.MarianaMultilingual",name:"Mariana Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-US-ShimmerTurboMultilingualNeural",name:"Shimmer Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-US-SerenaMultilingualNeural",name:"Serena Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-US-PhoebeMultilingualNeural",name:"Phoebe Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-US-AvaMultilingualNeural",name:"Ava Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-US-NancyMultilingualNeural",name:"Nancy Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-US-DerekMultilingualNeural",name:"Derek Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.en-US-DavisMultilingualNeural",name:"Davis Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.en-GB-LibbyNeural",name:"Libby Premium",lang:"en-GB",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-US-ChristopherMultilingualNeural",name:"Christopher Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.en-GB-OllieMultilingualNeural",name:"Ollie",lang:"en-GB",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.en-GB-SoniaNeural",name:"Sonia",lang:"en-GB",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-GB-AbbiNeural",name:"Abbi",lang:"en-GB",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.es-ES-SaulNeural",name:"Saul",lang:"es-ES",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.es-ES-VeraNeural",name:"Vera",lang:"es-ES",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.es-ES-AlvaroNeural",name:"Alvaro",lang:"es-ES",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.es-ES-ElviraNeural",name:"Elvira",lang:"es-ES",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.it-IT-MarcelloMultilingualNeural",name:"Marcello Premium",lang:"it-IT",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.it-IT-IsabellaNeural",name:"Isabella Premium",lang:"it-IT",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.hi-IN-ArjunNeural",name:"Arjun Premium",lang:"hi-IN",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.hi-IN-AartiNeural",name:"Aarti Premium",lang:"hi-IN",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.ar-EG-SalmaNeural",name:"Salma Premium",lang:"ar-EG",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.ar-EG-ShakirNeural",name:"Shakir Premium",lang:"ar-EG",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.en-US-AriaNeural",name:"Aria Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-US-AdamMultilingualNeural",name:"Adam Premium",lang:"en-US",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.core1.f1",name:"\u05e0\u05e2\u05de\u05d9 \u05d7\u05d3\u05e9 \u05e0\u05e1\u05d9\u05d5\u05e0\u05d9",lang:"he-IL",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.core1.f3",name:"\u05e8\u05d7\u05dc \u05d7\u05d3\u05e9 \u05e0\u05e1\u05d9\u05d5\u05e0\u05d9",lang:"he-IL",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.core1.f2",name:"\u05d0\u05e1\u05ea\u05e8 \u05d7\u05d3\u05e9 \u05e0\u05e1\u05d9\u05d5\u05e0\u05d9",lang:"he-IL",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.core1.m1",name:"\u05d3\u05d5\u05d3\u05d5 \u05d7\u05d3\u05e9 \u05e0\u05e1\u05d9\u05d5\u05e0\u05d9",lang:"he-IL",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.fr-FR-VivienneMultilingualNeural",name:"Vivienne Premium",lang:"fr-FR",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.fr-FR-HenriNeural",name:"Henri Premium",lang:"fr-FR",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.de-DE-ConradNeural",name:"Conrad Premium",lang:"de-DE",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.de-DE-SeraphinaMultilingualNeural",name:"Seraphina Premium",lang:"de-DE",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.en-GB-AdaMultilingualNeural",name:"Ada Premium",lang:"en-GB",localService:!1,default:!0,premiumLevel:2,gender:"f"},{voiceURI:"ttsreaderServer.azure.he-IL-AvriNeural",name:"\u05d0\u05d1\u05e8\u05d9",lang:"he-IL",localService:!1,default:!0,premiumLevel:2,gender:"m"},{voiceURI:"ttsreaderServer.azure.he-IL-HilaNeural",name:"\u05d4\u05d9\u05dc\u05d4",lang:"he-IL",localService:!1,default:!0,premiumLevel:2,gender:"f",avatar:"/images/avatars/ttsreaderServer.azure.he-IL-HilaNeural.webp",demo:"/audio/ttsreaderServer.azure.he-IL-HilaNeural.mp3"},{voiceURI:"ttsreaderServer.azure.es-MX-JorgeNeural",name:"Jorge Premium",lang:"es-MX",localService:!1,default:!0,premiumLevel:2,gender:"m",avatar:"/images/avatars/ttsreaderServer.azure.es-MX-JorgeNeural.webp",demo:"/audio/ttsreaderServer.azure.es-MX-JorgeNeural.mp3"},{voiceURI:"ttsreaderServer.azure.es-MX-DaliaNeural",name:"Dalia Premium",lang:"es-MX",localService:!1,default:!0,premiumLevel:2,gender:"f",avatar:"/images/avatars/ttsreaderServer.azure.es-MX-DaliaNeural.webp",demo:"/audio/ttsreaderServer.azure.es-MX-DaliaNeural.mp3"},{voiceURI:"ttsreaderServer.gcp.en-GB-Standard-A",name:"Olivia Premium",lang:"en-GB",localService:!1,default:!0,premiumLevel:1,gender:"f",avatar:"/images/avatars/ttsreaderServer.gcp.en-GB-Standard-A.webp",demo:"/audio/ttsreaderServer.gcp.en-GB-Standard-A.mp3"},{voiceURI:"ttsreaderServer.gcp.en-GB-Standard-D",name:"Noah Premium",lang:"en-GB",localService:!1,default:!0,premiumLevel:1,gender:"m",avatar:"/images/avatars/ttsreaderServer.gcp.en-GB-Standard-D.webp",demo:"/audio/ttsreaderServer.gcp.en-GB-Standard-D.mp3"},{voiceURI:"ttsreaderServer.gcp.en-GB-Standard-N",name:"Lilly Premium",lang:"en-GB",localService:!1,default:!0,premiumLevel:1,gender:"f",avatar:"/images/avatars/ttsreaderServer.gcp.en-GB-Standard-N.webp",demo:"/audio/ttsreaderServer.gcp.en-GB-Standard-N.mp3"}]),e.exports={ServerVoices:r}},191:(e,t,a)=>{var n=a(330),r=n.System,i=n.VbrMode,o=(n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n),s=(n.new_byte,n.new_double,n.new_float),l=n.new_float_n,c=n.new_int,u=(n.new_int_n,n.assert);function d(){var e=a(52),t=a(161),n=a(293),_=d.FFTOFFSET,f=d.MPG_MD_MS_LR,h=null;this.psy=null;var m=null,p=null,g=null;this.setModules=function(e,t,a,n){h=e,this.psy=t,m=t,p=n,g=a};var b=new e;this.lame_encode_mp3_frame=function(e,a,v,S,y,w){var E,A=o([2,2]);A[0][0]=new t,A[0][1]=new t,A[1][0]=new t,A[1][1]=new t;var x,T=o([2,2]);T[0][0]=new t,T[0][1]=new t,T[1][0]=new t,T[1][1]=new t;var B,R,M,P=[null,null],k=e.internal_flags,I=l([2,4]),L=[.5,.5],C=[[0,0],[0,0]],D=[[0,0],[0,0]];if(P[0]=a,P[1]=v,0==k.lame_encode_frame_init&&function(e,t){var a,n,r=e.internal_flags;if(0==r.lame_encode_frame_init){var i,o,l=s(2014),c=s(2014);for(r.lame_encode_frame_init=1,i=0,o=0;i<286+576*(1+r.mode_gr);++i)i<576*r.mode_gr?(l[i]=0,2==r.channels_out&&(c[i]=0)):(l[i]=t[0][o],2==r.channels_out&&(c[i]=t[1][o]),++o);for(n=0;n<r.mode_gr;n++)for(a=0;a<r.channels_out;a++)r.l3_side.tt[n][a].block_type=d.SHORT_TYPE;b.mdct_sub48(r,l,c),u(576>=d.FFTOFFSET),u(r.mf_size>=d.BLKSIZE+e.framesize-d.FFTOFFSET),u(r.mf_size>=512+e.framesize-32)}}(e,P),k.padding=0,(k.slot_lag-=k.frac_SpF)<0&&(k.slot_lag+=e.out_samplerate,k.padding=1),0!=k.psymodel){var N=[null,null],O=0,F=c(2);for(M=0;M<k.mode_gr;M++){for(R=0;R<k.channels_out;R++)N[R]=P[R],O=576+576*M-d.FFTOFFSET;if(0!=(e.VBR==i.vbr_mtrh||e.VBR==i.vbr_mt?m.L3psycho_anal_vbr(e,N,O,M,A,T,C[M],D[M],I[M],F):m.L3psycho_anal_ns(e,N,O,M,A,T,C[M],D[M],I[M],F)))return-4;for(e.mode==n.JOINT_STEREO&&(L[M]=I[M][2]+I[M][3],L[M]>0&&(L[M]=I[M][3]/L[M])),R=0;R<k.channels_out;R++){var U=k.l3_side.tt[M][R];U.block_type=F[R],U.mixed_block_flag=0}}}else for(M=0;M<k.mode_gr;M++)for(R=0;R<k.channels_out;R++)k.l3_side.tt[M][R].block_type=d.NORM_TYPE,k.l3_side.tt[M][R].mixed_block_flag=0,D[M][R]=C[M][R]=700;if(function(e){var t,a;if(0!=e.ATH.useAdjust)if(a=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(a+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(a+=a,t+=t),2==e.mode_gr&&(a=Math.max(a,t)),a*=.5,(a*=e.ATH.aaSensitivityP)>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var n=31.98*a+625e-6;e.ATH.adjust>=n?(e.ATH.adjust*=.075*n+.925,e.ATH.adjust<n&&(e.ATH.adjust=n)):e.ATH.adjustLimit>=n?e.ATH.adjust=n:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=n}else e.ATH.adjust=1}(k),b.mdct_sub48(k,P[0],P[1]),k.mode_ext=d.MPG_MD_LR_LR,e.force_ms)k.mode_ext=d.MPG_MD_MS_LR;else if(e.mode==n.JOINT_STEREO){var V=0,H=0;for(M=0;M<k.mode_gr;M++)for(R=0;R<k.channels_out;R++)V+=D[M][R],H+=C[M][R];if(V<=1*H){var q=k.l3_side.tt[0],z=k.l3_side.tt[k.mode_gr-1];q[0].block_type==q[1].block_type&&z[0].block_type==z[1].block_type&&(k.mode_ext=d.MPG_MD_MS_LR)}}if(k.mode_ext==f?(x=T,B=D):(x=A,B=C),e.analysis&&null!=k.pinfo)for(M=0;M<k.mode_gr;M++)for(R=0;R<k.channels_out;R++)k.pinfo.ms_ratio[M]=k.ms_ratio[M],k.pinfo.ms_ener_ratio[M]=L[M],k.pinfo.blocktype[M][R]=k.l3_side.tt[M][R].block_type,k.pinfo.pe[M][R]=B[M][R],r.arraycopy(k.l3_side.tt[M][R].xr,0,k.pinfo.xr[M][R],0,576),k.mode_ext==f&&(k.pinfo.ers[M][R]=k.pinfo.ers[M][R+2],r.arraycopy(k.pinfo.energy[M][R+2],0,k.pinfo.energy[M][R],0,k.pinfo.energy[M][R].length));if(e.VBR==i.vbr_off||e.VBR==i.vbr_abr){var G,X;for(G=0;G<18;G++)k.nsPsy.pefirbuf[G]=k.nsPsy.pefirbuf[G+1];for(X=0,M=0;M<k.mode_gr;M++)for(R=0;R<k.channels_out;R++)X+=B[M][R];for(k.nsPsy.pefirbuf[18]=X,X=k.nsPsy.pefirbuf[9],G=0;G<9;G++)X+=(k.nsPsy.pefirbuf[G]+k.nsPsy.pefirbuf[18-G])*d.fircoef[G];for(X=3350*k.mode_gr*k.channels_out/X,M=0;M<k.mode_gr;M++)for(R=0;R<k.channels_out;R++)B[M][R]*=X}if(k.iteration_loop.iteration_loop(e,B,L,x),h.format_bitstream(e),E=h.copy_buffer(k,S,y,w,1),e.bWriteVbrTag&&p.addVbrFrame(e),e.analysis&&null!=k.pinfo){for(R=0;R<k.channels_out;R++){var j;for(j=0;j<_;j++)k.pinfo.pcmdata[R][j]=k.pinfo.pcmdata[R][j+e.framesize];for(j=_;j<1600;j++)k.pinfo.pcmdata[R][j]=P[R][j-_]}g.set_frame_pinfo(e,x)}return function(e){var t,a;for(u(0<=e.bitrate_index&&e.bitrate_index<16),u(0<=e.mode_ext&&e.mode_ext<4),e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(a=0;a<e.channels_out;++a){var n=0|e.l3_side.tt[t][a].block_type;0!=e.l3_side.tt[t][a].mixed_block_flag&&(n=4),e.bitrate_blockType_Hist[e.bitrate_index][n]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][n]++,e.bitrate_blockType_Hist[15][5]++}}(k),E}}d.ENCDELAY=576,d.POSTDELAY=1152,d.MDCTDELAY=48,d.FFTOFFSET=224+d.MDCTDELAY,d.DECDELAY=528,d.SBLIMIT=32,d.CBANDS=64,d.SBPSY_l=21,d.SBPSY_s=12,d.SBMAX_l=22,d.SBMAX_s=13,d.PSFB21=6,d.PSFB12=6,d.BLKSIZE=1024,d.HBLKSIZE=d.BLKSIZE/2+1,d.BLKSIZE_s=256,d.HBLKSIZE_s=d.BLKSIZE_s/2+1,d.NORM_TYPE=0,d.START_TYPE=1,d.SHORT_TYPE=2,d.STOP_TYPE=3,d.MPG_MD_LR_LR=0,d.MPG_MD_LR_I=1,d.MPG_MD_MS_LR=2,d.MPG_MD_MS_I=3,d.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5],e.exports=d},206:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float),i=n.new_float_n,o=n.new_int,s=(n.new_int_n,n.assert,a(191));e.exports=function(){this.last_en_subshort=i([4,9]),this.lastAttacks=o(4),this.pefirbuf=r(19),this.longfact=r(s.SBMAX_l),this.shortfact=r(s.SBMAX_s),this.attackthre=0,this.attackthre_s=0}},228:()=>{},257:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float,n.new_float_n,n.new_int),i=(n.new_int_n,n.assert,a(985));e.exports=function(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[r(4),r(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new i}},293:e=>{function t(e){var t=e;this.ordinal=function(){return t}}t.STEREO=new t(0),t.JOINT_STEREO=new t(1),t.DUAL_CHANNEL=new t(2),t.MONO=new t(3),t.NOT_SET=new t(4),e.exports=t},294:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode),i=n.Float,o=n.ShortBlock,s=n.Util,l=n.Arrays,c=(n.new_array_n,n.new_byte,n.new_double,n.new_float),u=n.new_float_n,d=n.new_int,_=(n.new_int_n,n.assert),f=a(591),h=a(191);e.exports=function(){var e=a(293),t=new f,n=2.302585092994046,m=1/217621504/(h.BLKSIZE/2),p=.3,g=21,b=.2302585093;function v(e){return e}function S(e,t){for(var a=0,n=0;n<h.BLKSIZE/2;++n)a+=e[n]*t.ATH.eql_w[n];return a*=m}function y(e,a,n,r,i,o,l,c,u,d,_){var f=e.internal_flags;if(u<2)t.fft_long(f,r[i],u,d,_),t.fft_short(f,o[l],u,d,_);else if(2==u){for(var m=h.BLKSIZE-1;m>=0;--m){var p=r[i+0][m],g=r[i+1][m];r[i+0][m]=(p+g)*s.SQRT2*.5,r[i+1][m]=(p-g)*s.SQRT2*.5}for(var b=2;b>=0;--b)for(m=h.BLKSIZE_s-1;m>=0;--m){p=o[l+0][b][m],g=o[l+1][b][m];o[l+0][b][m]=(p+g)*s.SQRT2*.5,o[l+1][b][m]=(p-g)*s.SQRT2*.5}}a[0]=r[i+0][0],a[0]*=a[0];for(m=h.BLKSIZE/2-1;m>=0;--m){var y=r[i+0][h.BLKSIZE/2-m],w=r[i+0][h.BLKSIZE/2+m];a[h.BLKSIZE/2-m]=v(.5*(y*y+w*w))}for(b=2;b>=0;--b){n[b][0]=o[l+0][b][0],n[b][0]*=n[b][0];for(m=h.BLKSIZE_s/2-1;m>=0;--m){y=o[l+0][b][h.BLKSIZE_s/2-m],w=o[l+0][b][h.BLKSIZE_s/2+m];n[b][h.BLKSIZE_s/2-m]=v(.5*(y*y+w*w))}}var E=0;for(m=11;m<h.HBLKSIZE;m++)E+=a[m];if(f.tot_ener[u]=E,e.analysis){for(m=0;m<h.HBLKSIZE;m++)f.pinfo.energy[c][u][m]=f.pinfo.energy_save[u][m],f.pinfo.energy_save[u][m]=a[m];f.pinfo.pe[c][u]=f.pe[u]}2==e.athaa_loudapprox&&u<2&&(f.loudness_sq[c][u]=f.loudness_sq_save[u],f.loudness_sq_save[u]=S(a,f))}var w,E,A,x=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],T=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],B=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],R=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function M(e,t,a,n,r,i){var o;if(t>e){if(!(t<e*E))return e+t;o=t/e}else{if(e>=t*E)return e+t;o=e/t}if(_(e>=0),_(t>=0),e+=t,n+3<=6){if(o>=w)return e;var l=0|s.FAST_LOG10_X(o,16);return e*B[l]}var c,u;l=0|s.FAST_LOG10_X(o,16);return t=0!=i?r.ATH.cb_s[a]*r.ATH.adjust:r.ATH.cb_l[a]*r.ATH.adjust,_(t>=0),e<A*t?e>t?(c=1,l<=13&&(c=R[l]),u=s.FAST_LOG10_X(e/t,10/15),e*((T[l]-c)*u+c)):l>13?e:e*R[l]:e*T[l]}var P=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function k(e,t,a){var n;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(n=t>e?t/e:e/t,-2<=a&&a<=2){if(n>=w)return e+t;var r=0|s.FAST_LOG10_X(n,16);return(e+t)*P[r]}return n<E?e+t:(e<t&&(e=t),e)}function I(e,t,a,n,r){var i,o,s=0,l=0;for(i=o=0;i<h.SBMAX_s;++o,++i){for(var c=e.bo_s[i],u=e.npart_s,d=c<u?c:u;o<d;)_(t[o]>=0),_(a[o]>=0),s+=t[o],l+=a[o],o++;if(e.en[n].s[i][r]=s,e.thm[n].s[i][r]=l,o>=u){++i;break}_(t[o]>=0),_(a[o]>=0);var f=e.PSY.bo_s_weight[i],m=1-f;s=f*t[o],l=f*a[o],e.en[n].s[i][r]+=s,e.thm[n].s[i][r]+=l,s=m*t[o],l=m*a[o]}for(;i<h.SBMAX_s;++i)e.en[n].s[i][r]=0,e.thm[n].s[i][r]=0}function L(e,t,a,n){var r,i,o=0,s=0;for(r=i=0;r<h.SBMAX_l;++i,++r){for(var l=e.bo_l[r],c=e.npart_l,u=l<c?l:c;i<u;)_(t[i]>=0),_(a[i]>=0),o+=t[i],s+=a[i],i++;if(e.en[n].l[r]=o,e.thm[n].l[r]=s,i>=c){++r;break}_(t[i]>=0),_(a[i]>=0);var d=e.PSY.bo_l_weight[r],f=1-d;o=d*t[i],s=d*a[i],e.en[n].l[r]+=o,e.thm[n].l[r]+=s,o=f*t[i],s=f*a[i]}for(;r<h.SBMAX_l;++r)e.en[n].l[r]=0,e.thm[n].l[r]=0}function C(e,t,a,n,r,i){var o,s,l=e.internal_flags;for(s=o=0;s<l.npart_s;++s){for(var c=0,u=0,d=l.numlines_s[s],f=0;f<d;++f,++o){var m=t[i][o];c+=m,u<m&&(u=m)}a[s]=c}for(_(s==l.npart_s),_(129==o),o=s=0;s<l.npart_s;s++){var p=l.s3ind_s[s][0],g=l.s3_ss[o++]*a[p];for(++p;p<=l.s3ind_s[s][1];)g+=l.s3_ss[o]*a[p],++o,++p;var b=2*l.nb_s1[r][s];if(n[s]=Math.min(g,b),l.blocktype_old[1&r]==h.SHORT_TYPE){b=16*l.nb_s2[r][s];var v=n[s];n[s]=Math.min(b,v)}l.nb_s2[r][s]=l.nb_s1[r][s],l.nb_s1[r][s]=g,_(n[s]>=0)}for(;s<=h.CBANDS;++s)a[s]=0,n[s]=0}function D(e,t,a){return a>=1?e:a<=0?t:t>0?Math.pow(e/t,a)*t:0}var N=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function O(e,t){for(var a=309.07,r=0;r<h.SBMAX_s-1;r++)for(var i=0;i<3;i++){var o=e.thm.s[r][i];if(_(r<N.length),o>0){var l=o*t,c=e.en.s[r][i];c>l&&(c>1e10*l?a+=N[r]*(10*n):(_(l>0),a+=N[r]*s.FAST_LOG10(c/l)))}}return a}var F=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function U(e,t){for(var a=281.0575,r=0;r<h.SBMAX_l-1;r++){var i=e.thm.l[r];if(_(r<F.length),i>0){var o=i*t,l=e.en.l[r];l>o&&(l>1e10*o?a+=F[r]*(10*n):(_(o>0),a+=F[r]*s.FAST_LOG10(l/o)))}}return a}function V(e,t,a,n,r){var i,o;for(i=o=0;i<e.npart_l;++i){var s,l=0,c=0;for(s=0;s<e.numlines_l[i];++s,++o){var u=t[o];_(u>=0),l+=u,c<u&&(c=u)}a[i]=l,n[i]=c,r[i]=l*e.rnumlines_l[i],_(e.rnumlines_l[i]>=0),_(l>=0),_(a[i]>=0),_(n[i]>=0),_(r[i]>=0)}}function H(e,t,a,n){var r=x.length-1,i=0,o=a[i]+a[i+1];(_(o>=0),o>0)?((s=t[i])<t[i+1]&&(s=t[i+1]),_(e.numlines_l[i]+e.numlines_l[i+1]-1>0),(l=0|(o=20*(2*s-o)/(o*(e.numlines_l[i]+e.numlines_l[i+1]-1))))>r&&(l=r),n[i]=l):n[i]=0;for(i=1;i<e.npart_l-1;i++){var s,l;if(o=a[i-1]+a[i]+a[i+1],_(o>=0),o>0)(s=t[i-1])<t[i]&&(s=t[i]),s<t[i+1]&&(s=t[i+1]),_(e.numlines_l[i-1]+e.numlines_l[i]+e.numlines_l[i+1]-1>0),(l=0|(o=20*(3*s-o)/(o*(e.numlines_l[i-1]+e.numlines_l[i]+e.numlines_l[i+1]-1))))>r&&(l=r),n[i]=l;else n[i]=0}(_(i>0),_(i==e.npart_l-1),o=a[i-1]+a[i],_(o>=0),o>0)?((s=t[i-1])<t[i]&&(s=t[i]),_(e.numlines_l[i-1]+e.numlines_l[i]-1>0),(l=0|(o=20*(2*s-o)/(o*(e.numlines_l[i-1]+e.numlines_l[i]-1))))>r&&(l=r),n[i]=l):n[i]=0;_(i==e.npart_l-1)}var q=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function z(e,a,n,r,i,o,l,c){var u=e.internal_flags;if(r<2)t.fft_long(u,l[c],r,a,n);else if(2==r)for(var d=h.BLKSIZE-1;d>=0;--d){var _=l[c+0][d],f=l[c+1][d];l[c+0][d]=(_+f)*s.SQRT2*.5,l[c+1][d]=(_-f)*s.SQRT2*.5}o[0]=l[c+0][0],o[0]*=o[0];for(d=h.BLKSIZE/2-1;d>=0;--d){var m=l[c+0][h.BLKSIZE/2-d],p=l[c+0][h.BLKSIZE/2+d];o[h.BLKSIZE/2-d]=v(.5*(m*m+p*p))}var g=0;for(d=11;d<h.HBLKSIZE;d++)g+=o[d];if(u.tot_ener[r]=g,e.analysis){for(d=0;d<h.HBLKSIZE;d++)u.pinfo.energy[i][r][d]=u.pinfo.energy_save[r][d],u.pinfo.energy_save[r][d]=o[d];u.pinfo.pe[i][r]=u.pe[r]}}function G(e,a,n,r,i,o,l,c){var u=e.internal_flags;if(0==i&&r<2&&t.fft_short(u,l[c],r,a,n),2==r)for(var d=h.BLKSIZE_s-1;d>=0;--d){var _=l[c+0][i][d],f=l[c+1][i][d];l[c+0][i][d]=(_+f)*s.SQRT2*.5,l[c+1][i][d]=(_-f)*s.SQRT2*.5}o[i][0]=l[c+0][i][0],o[i][0]*=o[i][0];for(d=h.BLKSIZE_s/2-1;d>=0;--d){var m=l[c+0][i][h.BLKSIZE_s/2-d],p=l[c+0][i][h.BLKSIZE_s/2+d];o[i][h.BLKSIZE_s/2-d]=v(.5*(m*m+p*p))}}function X(e,t,a,n){var r=e.internal_flags;2==e.athaa_loudapprox&&a<2&&(r.loudness_sq[t][a]=r.loudness_sq_save[a],r.loudness_sq_save[a]=S(n,r))}this.L3psycho_anal_ns=function(t,a,n,i,s,f,m,b,v,S){var w,E,A,T,B,R,P,k,N,F,z=t.internal_flags,G=u([2,h.BLKSIZE]),X=u([2,3,h.BLKSIZE_s]),j=c(h.CBANDS+1),W=c(h.CBANDS+1),Y=c(h.CBANDS+2),K=d(2),Z=d(2),Q=u([2,576]),J=d(h.CBANDS+2),$=d(h.CBANDS+2);for(l.fill($,0),w=z.channels_out,t.mode==e.JOINT_STEREO&&(w=4),N=t.VBR==r.vbr_off?0==z.ResvMax?0:z.ResvSize/z.ResvMax*.5:t.VBR==r.vbr_rh||t.VBR==r.vbr_mtrh||t.VBR==r.vbr_mt?.6:1,E=0;E<z.channels_out;E++){var ee=a[E],te=n+576-350-g+192;for(_(10==q.length),T=0;T<576;T++){var ae,ne;for(ae=ee[te+T+10],ne=0,B=0;B<9;B+=2)ae+=q[B]*(ee[te+T+B]+ee[te+T+g-B]),ne+=q[B+1]*(ee[te+T+B+1]+ee[te+T+g-B-1]);Q[E][T]=ae+ne}s[i][E].en.assign(z.en[E]),s[i][E].thm.assign(z.thm[E]),w>2&&(f[i][E].en.assign(z.en[E+2]),f[i][E].thm.assign(z.thm[E+2]))}for(E=0;E<w;E++){var re,ie=c(12),oe=[0,0,0,0],se=c(12),le=1,ce=c(h.CBANDS),ue=c(h.CBANDS),de=[0,0,0,0],_e=c(h.HBLKSIZE),fe=u([3,h.HBLKSIZE_s]);for(_(z.npart_s<=h.CBANDS),_(z.npart_l<=h.CBANDS),T=0;T<3;T++)ie[T]=z.nsPsy.last_en_subshort[E][T+6],_(z.nsPsy.last_en_subshort[E][T+4]>0),se[T]=ie[T]/z.nsPsy.last_en_subshort[E][T+4],oe[0]+=ie[T];if(2==E)for(T=0;T<576;T++){var he,me;he=Q[0][T],me=Q[1][T],Q[0][T]=he+me,Q[1][T]=he-me}var pe=Q[1&E],ge=0;for(T=0;T<9;T++){for(var be=ge+64,ve=1;ge<be;ge++)ve<Math.abs(pe[ge])&&(ve=Math.abs(pe[ge]));z.nsPsy.last_en_subshort[E][T]=ie[T+3]=ve,oe[1+T/3]+=ve,ve>ie[T+3-2]?(_(ie[T+3-2]>0),ve/=ie[T+3-2]):ie[T+3-2]>10*ve?(_(ve>0),ve=ie[T+3-2]/(10*ve)):ve=0,se[T+3]=ve}if(t.analysis){var Se=se[0];for(T=1;T<12;T++)Se<se[T]&&(Se=se[T]);z.pinfo.ers[i][E]=z.pinfo.ers_save[E],z.pinfo.ers_save[E]=Se}for(re=3==E?z.nsPsy.attackthre_s:z.nsPsy.attackthre,T=0;T<12;T++)0==de[T/3]&&se[T]>re&&(de[T/3]=T%3+1);for(T=1;T<4;T++){var ye;oe[T-1]>oe[T]?(_(oe[T]>0),ye=oe[T-1]/oe[T]):(_(oe[T-1]>0),ye=oe[T]/oe[T-1]),ye<1.7&&(de[T]=0,1==T&&(de[0]=0))}for(0!=de[0]&&0!=z.nsPsy.lastAttacks[E]&&(de[0]=0),3!=z.nsPsy.lastAttacks[E]&&de[0]+de[1]+de[2]+de[3]==0||(le=0,0!=de[1]&&0!=de[0]&&(de[1]=0),0!=de[2]&&0!=de[1]&&(de[2]=0),0!=de[3]&&0!=de[2]&&(de[3]=0)),E<2?Z[E]=le:0==le&&(Z[0]=Z[1]=0),v[E]=z.tot_ener[E],y(t,_e,fe,G,1&E,X,1&E,i,E,a,n),V(z,_e,j,ce,ue),H(z,ce,ue,J),k=0;k<3;k++){var we,Ee;for(C(t,fe,W,Y,E,k),I(z,W,Y,E,k),P=0;P<h.SBMAX_s;P++){if(Ee=z.thm[E].s[P][k],Ee*=.8,de[k]>=2||1==de[k+1]){var Ae=0!=k?k-1:2;ve=D(z.thm[E].s[P][Ae],Ee,.6*N);Ee=Math.min(Ee,ve)}if(1==de[k]){Ae=0!=k?k-1:2,ve=D(z.thm[E].s[P][Ae],Ee,p*N);Ee=Math.min(Ee,ve)}else if(0!=k&&3==de[k-1]||0==k&&3==z.nsPsy.lastAttacks[E]){Ae=2!=k?k+1:0,ve=D(z.thm[E].s[P][Ae],Ee,p*N);Ee=Math.min(Ee,ve)}we=ie[3*k+3]+ie[3*k+4]+ie[3*k+5],6*ie[3*k+5]<we&&(Ee*=.5,6*ie[3*k+4]<we&&(Ee*=.5)),z.thm[E].s[P][k]=Ee}}for(z.nsPsy.lastAttacks[E]=de[2],R=0,A=0;A<z.npart_l;A++){for(var xe=z.s3ind[A][0],Te=j[xe]*x[J[xe]],Be=z.s3_ll[R++]*Te;++xe<=z.s3ind[A][1];)Te=j[xe]*x[J[xe]],Be=M(Be,z.s3_ll[R++]*Te,xe,xe-A,z,0);Be*=.158489319246111,z.blocktype_old[1&E]==h.SHORT_TYPE?Y[A]=Be:Y[A]=D(Math.min(Be,Math.min(2*z.nb_1[E][A],16*z.nb_2[E][A])),Be,N),z.nb_2[E][A]=z.nb_1[E][A],z.nb_1[E][A]=Be}for(;A<=h.CBANDS;++A)j[A]=0,Y[A]=0;L(z,j,Y,E)}(t.mode!=e.STEREO&&t.mode!=e.JOINT_STEREO||t.interChRatio>0&&function(e,t){var a=e.internal_flags;if(a.channels_out>1){for(var n=0;n<h.SBMAX_l;n++){var r=a.thm[0].l[n],i=a.thm[1].l[n];a.thm[0].l[n]+=i*t,a.thm[1].l[n]+=r*t}for(n=0;n<h.SBMAX_s;n++)for(var o=0;o<3;o++)r=a.thm[0].s[n][o],i=a.thm[1].s[n][o],a.thm[0].s[n][o]+=i*t,a.thm[1].s[n][o]+=r*t}}(t,t.interChRatio),t.mode==e.JOINT_STEREO)&&(!function(e){for(var t=0;t<h.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var a=e.mld_l[t]*e.en[3].l[t],n=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],a));a=e.mld_l[t]*e.en[2].l[t];var r=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],a));e.thm[2].l[t]=n,e.thm[3].l[t]=r}for(t=0;t<h.SBMAX_s;t++)for(var i=0;i<3;i++)e.thm[0].s[t][i]>1.58*e.thm[1].s[t][i]||e.thm[1].s[t][i]>1.58*e.thm[0].s[t][i]||(a=e.mld_s[t]*e.en[3].s[t][i],n=Math.max(e.thm[2].s[t][i],Math.min(e.thm[3].s[t][i],a)),a=e.mld_s[t]*e.en[2].s[t][i],r=Math.max(e.thm[3].s[t][i],Math.min(e.thm[2].s[t][i],a)),e.thm[2].s[t][i]=n,e.thm[3].s[t][i]=r)}(z),F=t.msfix,Math.abs(F)>0&&function(e,t,a){var n=t,r=Math.pow(10,a);t*=2,n*=2;for(var i=0;i<h.SBMAX_l;i++)u=e.ATH.cb_l[e.bm_l[i]]*r,(s=Math.min(Math.max(e.thm[0].l[i],u),Math.max(e.thm[1].l[i],u)))*t<(l=Math.max(e.thm[2].l[i],u))+(c=Math.max(e.thm[3].l[i],u))&&_((l*=d=s*n/(l+c))+(c*=d)>0),e.thm[2].l[i]=Math.min(l,e.thm[2].l[i]),e.thm[3].l[i]=Math.min(c,e.thm[3].l[i]);for(r*=h.BLKSIZE_s/h.BLKSIZE,i=0;i<h.SBMAX_s;i++)for(var o=0;o<3;o++){var s,l,c,u,d;u=e.ATH.cb_s[e.bm_s[i]]*r,(s=Math.min(Math.max(e.thm[0].s[i][o],u),Math.max(e.thm[1].s[i][o],u)))*t<(l=Math.max(e.thm[2].s[i][o],u))+(c=Math.max(e.thm[3].s[i][o],u))&&_((l*=d=s*t/(l+c))+(c*=d)>0),e.thm[2].s[i][o]=Math.min(e.thm[2].s[i][o],l),e.thm[3].s[i][o]=Math.min(e.thm[3].s[i][o],c)}}(z,F,t.ATHlower*z.ATH.adjust));for(function(e,t,a,n){var r=e.internal_flags;e.short_blocks!=o.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var i=0;i<r.channels_out;i++)n[i]=h.NORM_TYPE,e.short_blocks==o.short_block_dispensed&&(t[i]=1),e.short_blocks==o.short_block_forced&&(t[i]=0),0!=t[i]?(_(r.blocktype_old[i]!=h.START_TYPE),r.blocktype_old[i]==h.SHORT_TYPE&&(n[i]=h.STOP_TYPE)):(n[i]=h.SHORT_TYPE,r.blocktype_old[i]==h.NORM_TYPE&&(r.blocktype_old[i]=h.START_TYPE),r.blocktype_old[i]==h.STOP_TYPE&&(r.blocktype_old[i]=h.SHORT_TYPE)),a[i]=r.blocktype_old[i],r.blocktype_old[i]=n[i]}(t,Z,S,K),E=0;E<w;E++){var Re,Me,Pe,ke=0;E>1?(Re=b,ke=-2,Me=h.NORM_TYPE,S[0]!=h.SHORT_TYPE&&S[1]!=h.SHORT_TYPE||(Me=h.SHORT_TYPE),Pe=f[i][E-2]):(Re=m,ke=0,Me=S[E],Pe=s[i][E]),Me==h.SHORT_TYPE?Re[ke+E]=O(Pe,z.masking_lower):Re[ke+E]=U(Pe,z.masking_lower),t.analysis&&(z.pinfo.pe[i][E]=Re[ke+E])}return 0};var j=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function W(e,t,a){if(0==a)for(var n=0;n<e.npart_s;n++)e.nb_s2[t][n]=e.nb_s1[t][n],e.nb_s1[t][n]=0}function Y(e,t){for(var a=0;a<e.npart_l;a++)e.nb_2[t][a]=e.nb_1[t][a],e.nb_1[t][a]=0}function K(e,t,a,n,r,i){var o,s,l,u=e.internal_flags,d=new float[h.CBANDS],f=c(h.CBANDS),m=new int[h.CBANDS];for(l=s=0;l<u.npart_s;++l){var p=0,g=0,b=u.numlines_s[l];for(o=0;o<b;++o,++s){var v=t[i][s];p+=v,g<v&&(g=v)}a[l]=p,_(p>=0),d[l]=g,_(b>0),f[l]=p/b,_(f[l]>=0)}for(_(l==u.npart_s),_(129==s);l<h.CBANDS;++l)d[l]=0,f[l]=0;for(function(e,t,a,n){var r=x.length-1,i=0,o=a[i]+a[i+1];for(_(o>=0),o>0?((s=t[i])<t[i+1]&&(s=t[i+1]),_(e.numlines_s[i]+e.numlines_s[i+1]-1>0),(l=0|(o=20*(2*s-o)/(o*(e.numlines_s[i]+e.numlines_s[i+1]-1))))>r&&(l=r),n[i]=l):n[i]=0,i=1;i<e.npart_s-1;i++){var s,l;o=a[i-1]+a[i]+a[i+1],_(i+1<e.npart_s),_(o>=0),o>0?((s=t[i-1])<t[i]&&(s=t[i]),s<t[i+1]&&(s=t[i+1]),_(e.numlines_s[i-1]+e.numlines_s[i]+e.numlines_s[i+1]-1>0),(l=0|(o=20*(3*s-o)/(o*(e.numlines_s[i-1]+e.numlines_s[i]+e.numlines_s[i+1]-1))))>r&&(l=r),n[i]=l):n[i]=0}_(i>0),_(i==e.npart_s-1),o=a[i-1]+a[i],_(o>=0),o>0?((s=t[i-1])<t[i]&&(s=t[i]),_(e.numlines_s[i-1]+e.numlines_s[i]-1>0),(l=0|(o=20*(2*s-o)/(o*(e.numlines_s[i-1]+e.numlines_s[i]-1))))>r&&(l=r),n[i]=l):n[i]=0,_(i==e.npart_s-1)}(u,d,f,m),s=l=0;l<u.npart_s;l++){var S,y,w,E,A,T=u.s3ind_s[l][0],B=u.s3ind_s[l][1];for(S=m[T],y=1,E=u.s3_ss[s]*a[T]*x[m[T]],++s,++T;T<=B;)S+=m[T],y+=1,E=k(E,w=u.s3_ss[s]*a[T]*x[m[T]],T-l),++s,++T;E*=A=.5*x[S=(1+2*S)/(2*y)],n[l]=E,u.nb_s2[r][l]=u.nb_s1[r][l],u.nb_s1[r][l]=E,w=d[l],w*=u.minval_s[l],w*=A,n[l]>w&&(n[l]=w),u.masking_lower>1&&(n[l]*=u.masking_lower),n[l]>a[l]&&(n[l]=a[l]),u.masking_lower<1&&(n[l]*=u.masking_lower),_(n[l]>=0)}for(;l<h.CBANDS;++l)a[l]=0,n[l]=0}function Z(e,t,a,n,r){var i,o=c(h.CBANDS),s=c(h.CBANDS),l=d(h.CBANDS+2);V(e,t,a,o,s),H(e,o,s,l);var u=0;for(i=0;i<e.npart_l;i++){var f,m,g,b=e.s3ind[i][0],v=e.s3ind[i][1],S=0,y=0;for(S=l[b],y+=1,m=e.s3_ll[u]*a[b]*x[l[b]],++u,++b;b<=v;)S+=l[b],y+=1,m=k(m,f=e.s3_ll[u]*a[b]*x[l[b]],b-i),++u,++b;if(m*=g=.5*x[S=(1+2*S)/(2*y)],e.blocktype_old[1&r]==h.SHORT_TYPE){var w=2*e.nb_1[r][i];n[i]=w>0?Math.min(m,w):Math.min(m,a[i]*p)}else{var E=16*e.nb_2[r][i],A=2*e.nb_1[r][i];E<=0&&(E=m),A<=0&&(A=m),w=e.blocktype_old[1&r]==h.NORM_TYPE?Math.min(A,E):A,n[i]=Math.min(m,w)}e.nb_2[r][i]=e.nb_1[r][i],e.nb_1[r][i]=m,f=o[i],f*=e.minval_l[i],f*=g,n[i]>f&&(n[i]=f),e.masking_lower>1&&(n[i]*=e.masking_lower),n[i]>a[i]&&(n[i]=a[i]),e.masking_lower<1&&(n[i]*=e.masking_lower),_(n[i]>=0)}for(;i<h.CBANDS;++i)a[i]=0,n[i]=0}function Q(e,t,a,n,r,i,o){for(var s,l,c=2*i,u=i>0?Math.pow(10,r):1,d=0;d<o;++d){var f=e[2][d],h=e[3][d],m=t[0][d],p=t[1][d],g=t[2][d],b=t[3][d];if(m<=1.58*p&&p<=1.58*m){var v=a[d]*h,S=a[d]*f;l=Math.max(g,Math.min(b,v)),s=Math.max(b,Math.min(g,S))}else l=g,s=b;if(i>0){var y,w,E=n[d]*u;if(y=Math.min(Math.max(m,E),Math.max(p,E)),(w=(g=Math.max(l,E))+(b=Math.max(s,E)))>0&&y*c<w){var A=y*c/w;g*=A,b*=A,_(w>0)}l=Math.min(g,l),s=Math.min(b,s)}l>f&&(l=f),s>h&&(s=h),t[2][d]=l,t[3][d]=s}}function J(e,t){var a;return(a=e>=0?27*-e:e*t)<=-72?0:Math.exp(a*b)}function $(e){var t,a,n=0;for(n=0;J(n,e)>1e-20;n-=1);for(r=n,i=0;Math.abs(i-r)>1e-12;)J(n=(i+r)/2,e)>0?i=n:r=n;t=r;var r,i;n=0;for(n=0;J(n,e)>1e-20;n+=1);for(r=0,i=n;Math.abs(i-r)>1e-12;)J(n=(i+r)/2,e)>0?r=n:i=n;a=i;var o,s=0,l=1e3;for(o=0;o<=l;++o){s+=J(n=t+o*(a-t)/l,e)}return(l+1)/(s*(a-t))}function ee(e){var t,a,n,r;return t=e,a=(t*=t>=0?3:1.5)>=.5&&t<=2.5?8*((r=t-.5)*r-2*r):0,(n=15.811389+7.5*(t+=.474)-17.5*Math.sqrt(1+t*t))<=-60?0:(t=Math.exp((a+n)*b),t/=.6609193)}function te(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function ae(e,t,a,n,r,i,o,s,l,u,f,m){var p,g=c(h.CBANDS+1),b=s/(m>15?1152:384),v=d(h.HBLKSIZE);s/=l;var S=0,y=0;for(p=0;p<h.CBANDS;p++){var w;for(k=te(s*S),g[p]=s*S,w=S;te(s*w)-k<.34&&w<=l/2;w++);for(e[p]=w-S,y=p+1;S<w;)_(S<h.HBLKSIZE),v[S++]=p;if(S>l/2){S=l/2,++p;break}}_(p<h.CBANDS),g[p]=s*S;for(var E=0;E<m;E++){var A,x,T,B,R;T=u[E],B=u[E+1],(A=0|Math.floor(.5+f*(T-.5)))<0&&(A=0),(x=0|Math.floor(.5+f*(B-.5)))>l/2&&(x=l/2),a[E]=(v[A]+v[x])/2,t[E]=v[x];var M=b*B;o[E]=(M-g[t[E]])/(g[t[E]+1]-g[t[E]]),o[E]<0?o[E]=0:o[E]>1&&(o[E]=1),R=te(s*u[E]*f),R=Math.min(R,15.5)/15.5,i[E]=Math.pow(10,1.25*(1-Math.cos(Math.PI*R))-2.5)}S=0;for(var P=0;P<y;P++){var k,I,L=e[P];k=te(s*S),I=te(s*(S+L-1)),n[P]=.5*(k+I),k=te(s*(S-.5)),I=te(s*(S+L-.5)),r[P]=I-k,S+=L}return y}function ne(e,t,a,n,r,i){var o,s=u([h.CBANDS,h.CBANDS]),l=0;if(i)for(var d=0;d<t;d++)for(o=0;o<t;o++){var _=ee(a[d]-a[o])*n[o];s[d][o]=_*r[d]}else for(o=0;o<t;o++){var f=15+Math.min(21/a[o],12),m=$(f);for(d=0;d<t;d++){_=m*J(a[d]-a[o],f)*n[o];s[d][o]=_*r[d]}}for(d=0;d<t;d++){for(o=0;o<t&&!(s[d][o]>0);o++);for(e[d][0]=o,o=t-1;o>0&&!(s[d][o]>0);o--);e[d][1]=o,l+=e[d][1]-e[d][0]+1}var p=c(l),g=0;for(d=0;d<t;d++)for(o=e[d][0];o<=e[d][1];o++)p[g++]=s[d][o];return p}function re(e){var t=te(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function ie(e,t){return e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e),3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4)}this.L3psycho_anal_vbr=function(t,a,n,r,i,s,l,f,m,p){var b=t.internal_flags,v=c(h.HBLKSIZE),S=u([3,h.HBLKSIZE_s]),y=u([2,h.BLKSIZE]),w=u([2,3,h.BLKSIZE_s]),E=u([4,h.CBANDS]),A=u([4,h.CBANDS]),x=u([4,3]),T=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],B=d(2),R=t.mode==e.JOINT_STEREO?4:b.channels_out;!function(t,a,n,r,i,o,s,l,d,f){for(var h=u([2,576]),m=t.internal_flags,p=m.channels_out,b=t.mode==e.JOINT_STEREO?4:p,v=0;v<p;v++){firbuf=a[v];var S=n+576-350-g+192;_(10==j.length);for(var y=0;y<576;y++){var w,E;w=firbuf[S+y+10],E=0;for(var A=0;A<9;A+=2)w+=j[A]*(firbuf[S+y+A]+firbuf[S+y+g-A]),E+=j[A+1]*(firbuf[S+y+A+1]+firbuf[S+y+g-A-1]);h[v][y]=w+E}i[r][v].en.assign(m.en[v]),i[r][v].thm.assign(m.thm[v]),b>2&&(o[r][v].en.assign(m.en[v+2]),o[r][v].thm.assign(m.thm[v+2]))}for(v=0;v<b;v++){var x=c(12),T=c(12),B=[0,0,0,0],R=h[1&v],M=0,P=3==v?m.nsPsy.attackthre_s:m.nsPsy.attackthre,k=1;if(2==v)for(y=0,A=576;A>0;++y,--A){var I=h[0][y],L=h[1][y];h[0][y]=I+L,h[1][y]=I-L}for(y=0;y<3;y++)T[y]=m.nsPsy.last_en_subshort[v][y+6],_(m.nsPsy.last_en_subshort[v][y+4]>0),x[y]=T[y]/m.nsPsy.last_en_subshort[v][y+4],B[0]+=T[y];for(y=0;y<9;y++){for(var C=M+64,D=1;M<C;M++)D<Math.abs(R[M])&&(D=Math.abs(R[M]));m.nsPsy.last_en_subshort[v][y]=T[y+3]=D,B[1+y/3]+=D,D>T[y+3-2]?(_(T[y+3-2]>0),D/=T[y+3-2]):T[y+3-2]>10*D?(_(D>0),D=T[y+3-2]/(10*D)):D=0,x[y+3]=D}for(y=0;y<3;++y){var N=T[3*y+3]+T[3*y+4]+T[3*y+5],O=1;6*T[3*y+5]<N&&(O*=.5,6*T[3*y+4]<N&&(O*=.5)),l[v][y]=O}if(t.analysis){var F=x[0];for(y=1;y<12;y++)F<x[y]&&(F=x[y]);m.pinfo.ers[r][v]=m.pinfo.ers_save[v],m.pinfo.ers_save[v]=F}for(y=0;y<12;y++)0==d[v][y/3]&&x[y]>P&&(d[v][y/3]=y%3+1);for(y=1;y<4;y++){var U=B[y-1],V=B[y];Math.max(U,V)<4e4&&U<1.7*V&&V<1.7*U&&(1==y&&d[v][0]<=d[v][y]&&(d[v][0]=0),d[v][y]=0)}d[v][0]<=m.nsPsy.lastAttacks[v]&&(d[v][0]=0),3!=m.nsPsy.lastAttacks[v]&&d[v][0]+d[v][1]+d[v][2]+d[v][3]==0||(k=0,0!=d[v][1]&&0!=d[v][0]&&(d[v][1]=0),0!=d[v][2]&&0!=d[v][1]&&(d[v][2]=0),0!=d[v][3]&&0!=d[v][2]&&(d[v][3]=0)),v<2?f[v]=k:0==k&&(f[0]=f[1]=0),s[v]=m.tot_ener[v]}}(t,a,n,r,i,s,m,x,T,B),function(e,t){var a=e.internal_flags;e.short_blocks!=o.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var n=0;n<a.channels_out;n++)e.short_blocks==o.short_block_dispensed&&(t[n]=1),e.short_blocks==o.short_block_forced&&(t[n]=0)}(t,B);for(var M=0;M<R;M++){z(t,a,n,M,r,v,y,k=1&M),X(t,r,M,v),0!=B[k]?Z(b,v,E[M],A[M],M):Y(b,M)}B[0]+B[1]==2&&t.mode==e.JOINT_STEREO&&Q(E,A,b.mld_cb_l,b.ATH.cb_l,t.ATHlower*b.ATH.adjust,t.msfix,b.npart_l);for(M=0;M<R;M++){0!=B[k=1&M]&&L(b,E[M],A[M],M)}for(var P=0;P<3;P++){for(M=0;M<R;++M){0!=B[k=1&M]?W(b,M,P):(G(t,a,n,M,P,S,w,k),K(t,S,E[M],A[M],M,P))}B[0]+B[1]==0&&t.mode==e.JOINT_STEREO&&Q(E,A,b.mld_cb_s,b.ATH.cb_s,t.ATHlower*b.ATH.adjust,t.msfix,b.npart_s);for(M=0;M<R;++M){0==B[k=1&M]&&I(b,E[M],A[M],M,P)}}for(M=0;M<R;M++){var k;if(0==B[k=1&M])for(var C=0;C<h.SBMAX_s;C++){var N=c(3);for(P=0;P<3;P++){var F=b.thm[M].s[C][P];if(F*=.8,T[M][P]>=2||1==T[M][P+1]){var V=0!=P?P-1:2,H=D(b.thm[M].s[C][V],F,.36);F=Math.min(F,H)}else if(1==T[M][P]){V=0!=P?P-1:2,H=D(b.thm[M].s[C][V],F,.18);F=Math.min(F,H)}else if(0!=P&&3==T[M][P-1]||0==P&&3==b.nsPsy.lastAttacks[M]){V=2!=P?P+1:0,H=D(b.thm[M].s[C][V],F,.18);F=Math.min(F,H)}F*=x[M][P],N[P]=F}for(P=0;P<3;P++)b.thm[M].s[C][P]=N[P]}}for(M=0;M<R;M++)b.nsPsy.lastAttacks[M]=T[M][2];!function(e,t,a){for(var n=e.internal_flags,r=0;r<n.channels_out;r++){var i=h.NORM_TYPE;0!=t[r]?(_(n.blocktype_old[r]!=h.START_TYPE),n.blocktype_old[r]==h.SHORT_TYPE&&(i=h.STOP_TYPE)):(i=h.SHORT_TYPE,n.blocktype_old[r]==h.NORM_TYPE&&(n.blocktype_old[r]=h.START_TYPE),n.blocktype_old[r]==h.STOP_TYPE&&(n.blocktype_old[r]=h.SHORT_TYPE)),a[r]=n.blocktype_old[r],n.blocktype_old[r]=i}}(t,B,p);for(M=0;M<R;M++){var q,J,$,ee;M>1?(q=f,J=-2,$=h.NORM_TYPE,p[0]!=h.SHORT_TYPE&&p[1]!=h.SHORT_TYPE||($=h.SHORT_TYPE),ee=s[r][M-2]):(q=l,J=0,$=p[M],ee=i[r][M]),$==h.SHORT_TYPE?q[J+M]=O(ee,b.masking_lower):q[J+M]=U(ee,b.masking_lower),t.analysis&&(b.pinfo.pe[r][M]=q[J+M])}return 0},this.psymodel_init=function(e){var a,o=e.internal_flags,s=!0,l=13,u=24,d=0,f=0,m=-8.25,p=-4.5,g=c(h.CBANDS),b=c(h.CBANDS),v=c(h.CBANDS),S=e.out_samplerate;switch(e.experimentalZ){default:case 0:s=!0;break;case 1:s=e.VBR!=r.vbr_mtrh&&e.VBR!=r.vbr_mt;break;case 2:s=!1;break;case 3:l=8,d=-1.75,f=-.0125,m=-8.25,p=-2.25}for(o.ms_ener_ratio_old=.25,o.blocktype_old[0]=o.blocktype_old[1]=h.NORM_TYPE,a=0;a<4;++a){for(var y=0;y<h.CBANDS;++y)o.nb_1[a][y]=1e20,o.nb_2[a][y]=1e20,o.nb_s1[a][y]=o.nb_s2[a][y]=1;for(var x=0;x<h.SBMAX_l;x++)o.en[a].l[x]=1e20,o.thm[a].l[x]=1e20;for(y=0;y<3;++y){for(x=0;x<h.SBMAX_s;x++)o.en[a].s[x][y]=1e20,o.thm[a].s[x][y]=1e20;o.nsPsy.lastAttacks[a]=0}for(y=0;y<9;y++)o.nsPsy.last_en_subshort[a][y]=10}for(o.loudness_sq_save[0]=o.loudness_sq_save[1]=0,o.npart_l=ae(o.numlines_l,o.bo_l,o.bm_l,g,b,o.mld_l,o.PSY.bo_l_weight,S,h.BLKSIZE,o.scalefac_band.l,h.BLKSIZE/1152,h.SBMAX_l),_(o.npart_l<h.CBANDS),a=0;a<o.npart_l;a++){var T=d;g[a]>=l&&(T=f*(g[a]-l)/(u-l)+d*(u-g[a])/(u-l)),v[a]=Math.pow(10,T/10),o.numlines_l[a]>0?o.rnumlines_l[a]=1/o.numlines_l[a]:o.rnumlines_l[a]=0}o.s3_ll=ne(o.s3ind,o.npart_l,g,b,v,s);var B;y=0;for(a=0;a<o.npart_l;a++){P=i.MAX_VALUE;for(var R=0;R<o.numlines_l[a];R++,y++){var M=S*y/(1e3*h.BLKSIZE);k=this.ATHformula(1e3*M,e)-20,k=Math.pow(10,.1*k),P>(k*=o.numlines_l[a])&&(P=k)}o.ATH.cb_l[a]=P,(P=20*g[a]/10-20)>6&&(P=100),P<-15&&(P=-15),P-=8,o.minval_l[a]=Math.pow(10,P/10)*o.numlines_l[a]}for(o.npart_s=ae(o.numlines_s,o.bo_s,o.bm_s,g,b,o.mld_s,o.PSY.bo_s_weight,S,h.BLKSIZE_s,o.scalefac_band.s,h.BLKSIZE_s/384,h.SBMAX_s),_(o.npart_s<h.CBANDS),y=0,a=0;a<o.npart_s;a++){var P;T=m;g[a]>=l&&(T=p*(g[a]-l)/(u-l)+m*(u-g[a])/(u-l)),v[a]=Math.pow(10,T/10),P=i.MAX_VALUE;for(R=0;R<o.numlines_s[a];R++,y++){var k;M=S*y/(1e3*h.BLKSIZE_s);k=this.ATHformula(1e3*M,e)-20,k=Math.pow(10,.1*k),P>(k*=o.numlines_s[a])&&(P=k)}o.ATH.cb_s[a]=P,P=7*g[a]/12-7,g[a]>12&&(P*=1+3.1*Math.log(1+P)),g[a]<12&&(P*=1+2.3*Math.log(1-P)),P<-15&&(P=-15),P-=8,o.minval_s[a]=Math.pow(10,P/10)*o.numlines_s[a]}o.s3_ss=ne(o.s3ind_s,o.npart_s,g,b,v,s),w=Math.pow(10,9/16),E=Math.pow(10,1.5),A=Math.pow(10,1.5),t.init_fft(o),o.decay=Math.exp(-1*n/(.01*S/192)),B=3.5,0!=(2&e.exp_nspsytune)&&(B=1),Math.abs(e.msfix)>0&&(B=e.msfix),e.msfix=B;for(var I=0;I<o.npart_l;I++)o.s3ind[I][1]>o.npart_l-1&&(o.s3ind[I][1]=o.npart_l-1);var L=576*o.mode_gr/S;if(o.ATH.decay=Math.pow(10,-1.2*L),o.ATH.adjust=.01,o.ATH.adjustLimit=1,_(o.bo_l[h.SBMAX_l-1]<=o.npart_l),_(o.bo_s[h.SBMAX_s-1]<=o.npart_s),-1!=e.ATHtype){var C=e.out_samplerate/h.BLKSIZE,D=0;for(M=0,a=0;a<h.BLKSIZE/2;++a)M+=C,o.ATH.eql_w[a]=1/Math.pow(10,this.ATHformula(M,e)/10),D+=o.ATH.eql_w[a];for(D=1/D,a=h.BLKSIZE/2;--a>=0;)o.ATH.eql_w[a]*=D}for(I=y=0;I<o.npart_s;++I)for(a=0;a<o.numlines_s[I];++a)++y;_(129==y);for(I=y=0;I<o.npart_l;++I)for(a=0;a<o.numlines_l[I];++a)++y;for(_(513==y),y=0,a=0;a<o.npart_l;a++){M=S*(y+o.numlines_l[a]/2)/(1*h.BLKSIZE);o.mld_cb_l[a]=re(M),y+=o.numlines_l[a]}for(;a<h.CBANDS;++a)o.mld_cb_l[a]=1;for(y=0,a=0;a<o.npart_s;a++){M=S*(y+o.numlines_s[a]/2)/(1*h.BLKSIZE_s);o.mld_cb_s[a]=re(M),y+=o.numlines_s[a]}for(;a<h.CBANDS;++a)o.mld_cb_s[a]=1;return 0},this.ATHformula=function(e,t){var a;switch(t.ATHtype){case 0:a=ie(e,9);break;case 1:a=ie(e,-1);break;case 2:default:a=ie(e,0);break;case 3:a=ie(e,1)+6;break;case 4:a=ie(e,t.ATHcurve)}return a}}},320:(e,t,a)=>{var n=a(330),r=n.System,i=n.VbrMode,o=(n.Float,n.ShortBlock,n.Util),s=n.Arrays,l=(n.new_array_n,n.new_byte,n.new_double,n.new_float),c=(n.new_float_n,n.new_int,n.new_int_n,n.assert),u=a(554),d=a(583),_=a(42),f=a(191),h=a(985),m=a(17);e.exports=function(){var e,t,a;this.rv=null,this.qupvt=null;var n,p=new u;function g(e){this.ordinal=e}function b(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function v(e){return o.FAST_LOG10(.368+.632*e*e*e)}function S(e,t,a,n,r){var i;switch(e){default:case 9:t.over_count>0?(i=a.over_SSD<=t.over_SSD,a.over_SSD==t.over_SSD&&(i=a.bits<t.bits)):i=a.max_noise<0&&10*a.max_noise+a.bits<=10*t.max_noise+t.bits;break;case 0:i=a.over_count<t.over_count||a.over_count==t.over_count&&a.over_noise<t.over_noise||a.over_count==t.over_count&&BitStream.EQ(a.over_noise,t.over_noise)&&a.tot_noise<t.tot_noise;break;case 8:a.max_noise=function(e,t){for(var a=1e-37,n=0;n<t.psymax;n++)a+=v(e[n]);return Math.max(1e-20,a)}(r,n);case 1:i=a.max_noise<t.max_noise;break;case 2:i=a.tot_noise<t.tot_noise;break;case 3:i=a.tot_noise<t.tot_noise&&a.max_noise<t.max_noise;break;case 4:i=a.max_noise<=0&&t.max_noise>.2||a.max_noise<=0&&t.max_noise<0&&t.max_noise>a.max_noise-.2&&a.tot_noise<t.tot_noise||a.max_noise<=0&&t.max_noise>0&&t.max_noise>a.max_noise-.2&&a.tot_noise<t.tot_noise+t.over_noise||a.max_noise>0&&t.max_noise>-.05&&t.max_noise>a.max_noise-.1&&a.tot_noise+a.over_noise<t.tot_noise+t.over_noise||a.max_noise>0&&t.max_noise>-.1&&t.max_noise>a.max_noise-.15&&a.tot_noise+a.over_noise+a.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:i=a.over_noise<t.over_noise||BitStream.EQ(a.over_noise,t.over_noise)&&a.tot_noise<t.tot_noise;break;case 6:i=a.over_noise<t.over_noise||BitStream.EQ(a.over_noise,t.over_noise)&&(a.max_noise<t.max_noise||BitStream.EQ(a.max_noise,t.max_noise)&&a.tot_noise<=t.tot_noise);break;case 7:i=a.over_count<t.over_count||a.over_noise<t.over_noise}return 0==t.over_count&&(i=i&&a.bits<t.bits),i}function y(e,t,r,i,o){var l=e.internal_flags;!function(e,t,a,n,r){var i,o=e.internal_flags;i=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var s=0,l=0;l<t.sfbmax;l++)s<a[l]&&(s=a[l]);var c=o.noise_shaping_amp;switch(3==c&&(c=r?2:1),c){case 2:break;case 1:s>1?s=Math.pow(s,.5):s*=.95;break;default:s>1?s=1:s*=.95}var u=0;for(l=0;l<t.sfbmax;l++){var d,_=t.width[l];if(u+=_,!(a[l]<s)){if(0!=(2&o.substep_shaping)&&(o.pseudohalf[l]=0==o.pseudohalf[l]?1:0,0==o.pseudohalf[l]&&2==o.noise_shaping_amp))return;for(t.scalefac[l]++,d=-_;d<0;d++)n[u+d]*=i,n[u+d]>t.xrpow_max&&(t.xrpow_max=n[u+d]);if(2==o.noise_shaping_amp)return}}}(e,t,r,i,o);var u=b(t);return!u&&(!(u=2==l.mode_gr?n.scale_bitcount(t):n.scale_bitcount_lsf(l,t))||(l.noise_shaping>1&&(s.fill(l.pseudohalf,0),0==t.scalefac_scale?(!function(e,t){for(var n=0,r=0;r<e.sfbmax;r++){var i=e.width[r],o=e.scalefac[r];if(0!=e.preflag&&(o+=a.pretab[r]),n+=i,0!=(1&o)){o++;for(var s=-i;s<0;s++)t[n+s]*=1.2968395546510096,t[n+s]>e.xrpow_max&&(e.xrpow_max=t[n+s])}e.scalefac[r]=o>>1}e.preflag=0,e.scalefac_scale=1}(t,i),u=!1):t.block_type==f.SHORT_TYPE&&l.subblock_gain>0&&(u=function(e,t,n){var r,i=t.scalefac;for(r=0;r<t.sfb_lmax;r++)if(i[r]>=16)return!0;for(var o=0;o<3;o++){var s=0,l=0;for(r=t.sfb_lmax+o;r<t.sfbdivide;r+=3)s<i[r]&&(s=i[r]);for(;r<t.sfbmax;r+=3)l<i[r]&&(l=i[r]);if(!(s<16&&l<8)){if(t.subblock_gain[o]>=7)return!0;t.subblock_gain[o]++;var u=e.scalefac_band.l[t.sfb_lmax];for(r=t.sfb_lmax+o;r<t.sfbmax;r+=3){var d=t.width[r],_=i[r];if(c(_>=0),(_-=4>>t.scalefac_scale)>=0)i[r]=_,u+=3*d;else{i[r]=0;var f=210+(_<<t.scalefac_scale+1);m=a.IPOW20(f),u+=d*(o+1);for(var h=-d;h<0;h++)n[u+h]*=m,n[u+h]>t.xrpow_max&&(t.xrpow_max=n[u+h]);u+=d*(3-o-1)}}var m=a.IPOW20(202);for(u+=t.width[r]*(o+1),h=-t.width[r];h<0;h++)n[u+h]*=m,n[u+h]>t.xrpow_max&&(t.xrpow_max=n[u+h])}}return!1}(l,t,i)||b(t))),u||(u=2==l.mode_gr?n.scale_bitcount(t):n.scale_bitcount_lsf(l,t)),!u))}this.setModules=function(r,i,o,s){e=r,t=i,this.rv=i,a=o,this.qupvt=o,n=s,p.setModules(a,n)},this.ms_convert=function(e,t){for(var a=0;a<576;++a){var n=e.tt[t][0].xr[a],r=e.tt[t][1].xr[a];e.tt[t][0].xr[a]=(n+r)*(.5*o.SQRT2),e.tt[t][1].xr[a]=(n-r)*(.5*o.SQRT2)}},this.init_xrpow=function(e,t,a){var n=0,r=0|t.max_nonzero_coeff;if(c(null!=a),t.xrpow_max=0,c(0<=r&&r<=575),s.fill(a,r,576,0),n=function(e,t,a,n){n=0;for(var r=0;r<=a;++r){var i=Math.abs(e.xr[r]);n+=i,t[r]=Math.sqrt(i*Math.sqrt(i)),t[r]>e.xrpow_max&&(e.xrpow_max=t[r])}return n}(t,a,r,n),n>1e-20){var i=0;0!=(2&e.substep_shaping)&&(i=1);for(var o=0;o<t.psymax;o++)e.pseudohalf[o]=i;return!0}return s.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=f.SBPSY_l,t.sfb_smin=f.SBPSY_s,t.psy_lmax=e.sfb21_extra?f.SBMAX_l:f.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var n=0;n<f.SBMAX_l;n++)t.width[n]=e.scalefac_band.l[n+1]-e.scalefac_band.l[n],t.window[n]=3;if(t.block_type==f.SHORT_TYPE){var i=l(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?f.SBMAX_s:f.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(f.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var o=e.scalefac_band.l[t.sfb_lmax];r.arraycopy(t.xr,0,i,0,576);for(n=t.sfb_smin;n<f.SBMAX_s;n++)for(var c=e.scalefac_band.s[n],u=e.scalefac_band.s[n+1],d=0;d<3;d++)for(var _=c;_<u;_++)t.xr[o++]=i[3*_+d];var h=t.sfb_lmax;for(n=t.sfb_smin;n<f.SBMAX_s;n++)t.width[h]=t.width[h+1]=t.width[h+2]=e.scalefac_band.s[n+1]-e.scalefac_band.s[n],t.window[h]=0,t.window[h+1]=1,t.window[h+2]=2,h+=3}t.count1bits=0,t.sfb_partition_table=a.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,s.fill(t.scalefac,0),function(e,t){var n=e.ATH,r=t.xr;if(t.block_type!=f.SHORT_TYPE)for(var i=!1,o=f.PSFB21-1;o>=0&&!i;o--){var s=e.scalefac_band.psfb21[o],l=e.scalefac_band.psfb21[o+1],c=a.athAdjust(n.adjust,n.psfb21[o],n.floor);e.nsPsy.longfact[21]>1e-12&&(c*=e.nsPsy.longfact[21]);for(var u=l-1;u>=s;u--){if(!(Math.abs(r[u])<c)){i=!0;break}r[u]=0}}else for(var d=0;d<3;d++)for(i=!1,o=f.PSFB12-1;o>=0&&!i;o--){l=(s=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*d+(e.scalefac_band.psfb12[o]-e.scalefac_band.psfb12[0]))+(e.scalefac_band.psfb12[o+1]-e.scalefac_band.psfb12[o]);var _=a.athAdjust(n.adjust,n.psfb12[o],n.floor);for(e.nsPsy.shortfact[12]>1e-12&&(_*=e.nsPsy.shortfact[12]),u=l-1;u>=s;u--){if(!(Math.abs(r[u])<_)){i=!0;break}r[u]=0}}}(e,t)},g.BINSEARCH_NONE=new g(0),g.BINSEARCH_UP=new g(1),g.BINSEARCH_DOWN=new g(2),this.trancate_smallspectrums=function(e,t,r,i){var o=l(m.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=f.SHORT_TYPE)&&0==(128&e.substep_shaping)){a.calc_noise(t,r,o,new d,null);for(var c=0;c<576;c++){var u=0;0!=t.l3_enc[c]&&(u=Math.abs(t.xr[c])),i[c]=u}c=0;var _=8;t.block_type==f.SHORT_TYPE&&(_=6);do{var h,p,g,b,v=t.width[_];if(c+=v,!(o[_]>=1)&&(s.sort(i,c-v,v),!BitStream.EQ(i[c-1],0))){h=(1-o[_])*r[_],p=0,b=0;do{var S;for(g=1;b+g<v&&!BitStream.NEQ(i[b+c-v],i[b+c+g-v]);g++);if(h<(S=i[b+c-v]*i[b+c-v]*g)){0!=b&&(p=i[b+c-v-1]);break}h-=S,b+=g}while(b<v);if(!BitStream.EQ(p,0))do{Math.abs(t.xr[c-v])<=p&&(t.l3_enc[c-v]=0)}while(--v>0)}}while(++_<t.psymax);t.part2_3_length=n.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,o,s,u,p){var b=e.internal_flags,v=new h,w=l(576),E=l(m.SFBMAX),A=new d,x=new _,T=9999999,B=!1,R=!1,M=0;if(function(e,t,a,r,i){var o,s=e.CurrentStep[r],l=!1,u=e.OldValue[r],d=g.BINSEARCH_NONE;for(t.global_gain=u,a-=t.part2_length,c(0!=s);;){var _;if(o=n.count_bits(e,i,t,null),1==s||o==a)break;o>a?(d==g.BINSEARCH_DOWN&&(l=!0),l&&(s/=2),d=g.BINSEARCH_UP,_=s):(d==g.BINSEARCH_UP&&(l=!0),l&&(s/=2),d=g.BINSEARCH_DOWN,_=-s),t.global_gain+=_,t.global_gain<0&&(t.global_gain=0,l=!0),t.global_gain>255&&(t.global_gain=255,l=!0)}for(c(t.global_gain>=0),c(t.global_gain<256);o>a&&t.global_gain<255;)t.global_gain++,o=n.count_bits(e,i,t,null);e.CurrentStep[r]=u-t.global_gain>=4?4:2,e.OldValue[r]=t.global_gain,t.part2_3_length=o}(b,t,p,u,s),0==b.noise_shaping)return 100;a.calc_noise(t,o,E,A,x),A.bits=t.part2_3_length,v.assign(t);var P=0;for(r.arraycopy(s,0,w,0,576);!B;){do{var k,I=new d,L=255;if(k=0!=(2&b.substep_shaping)?20:3,b.sfb21_extra){if(E[v.sfbmax]>1)break;if(v.block_type==f.SHORT_TYPE&&(E[v.sfbmax+1]>1||E[v.sfbmax+2]>1))break}if(!y(e,v,E,s,R))break;0!=v.scalefac_scale&&(L=254);var C=p-v.part2_length;if(C<=0)break;for(;(v.part2_3_length=n.count_bits(b,s,v,x))>C&&v.global_gain<=L;)v.global_gain++;if(v.global_gain>L)break;if(0==A.over_count){for(;(v.part2_3_length=n.count_bits(b,s,v,x))>T&&v.global_gain<=L;)v.global_gain++;if(v.global_gain>L)break}if(a.calc_noise(v,o,E,I,x),I.bits=v.part2_3_length,0!=(S(t.block_type!=f.SHORT_TYPE?e.quant_comp:e.quant_comp_short,A,I,v,E)?1:0))T=t.part2_3_length,A=I,t.assign(v),P=0,r.arraycopy(s,0,w,0,576);else if(0==b.full_outer_loop){if(++P>k&&0==A.over_count)break;if(3==b.noise_shaping_amp&&R&&P>30)break;if(3==b.noise_shaping_amp&&R&&v.global_gain-M>15)break}}while(v.global_gain+v.scalefac_scale<255);3==b.noise_shaping_amp?R?B=!0:(v.assign(t),r.arraycopy(w,0,s,0,576),P=0,M=v.global_gain,R=!0):B=!0}return c(t.global_gain+t.scalefac_scale<=255),e.VBR==i.vbr_rh||e.VBR==i.vbr_mtrh?r.arraycopy(w,0,s,0,576):0!=(1&b.substep_shaping)&&trancate_smallspectrums(b,t,o,s),A.over_count},this.iteration_finish_one=function(e,a,r){var i=e.l3_side,o=i.tt[a][r];n.best_scalefac_store(e,a,r,i),1==e.use_best_huffman&&n.best_huffman_divide(e,o),t.ResvAdjust(e,o)},this.VBR_encode_granule=function(e,t,a,n,i,o,u){var d,_=e.internal_flags,f=new h,m=l(576),p=u,g=u+1,b=(u+o)/2,v=0,S=_.sfb21_extra;c(p<=LameInternalFlags.MAX_BITS_PER_CHANNEL),s.fill(f.l3_enc,0);do{c(b>=o),c(b<=u),c(o<=u),_.sfb21_extra=!(b>p-42)&&S,outer_loop(e,t,a,n,i,b)<=0?(v=1,g=t.part2_3_length,f.assign(t),r.arraycopy(n,0,m,0,576),d=(u=g-32)-o,b=(u+o)/2):(d=u-(o=b+32),b=(u+o)/2,0!=v&&(v=2,t.assign(f),r.arraycopy(m,0,n,0,576)))}while(d>12);_.sfb21_extra=S,2==v&&r.arraycopy(f.l3_enc,0,t.l3_enc,0,576),c(t.part2_3_length<=p)},this.get_framebits=function(a,n){var r=a.internal_flags;r.bitrate_index=r.VBR_min_bitrate;var i=e.getframebits(a);r.bitrate_index=1,i=e.getframebits(a);for(var o=1;o<=r.VBR_max_bitrate;o++){r.bitrate_index=o;var s=new MeanBits(i);n[o]=t.ResvFrameBegin(a,s),i=s.bits}},this.VBR_old_prepare=function(e,n,r,i,o,s,l,c,u){var d,_=e.internal_flags,h=0,m=1,p=0;_.bitrate_index=_.VBR_max_bitrate;var g=t.ResvFrameBegin(e,new MeanBits(0))/_.mode_gr;get_framebits(e,s);for(var b=0;b<_.mode_gr;b++){var v=a.on_pe(e,n,c[b],g,b,0);_.mode_ext==f.MPG_MD_MS_LR&&(ms_convert(_.l3_side,b),a.reduce_side(c[b],r[b],g,v));for(var S=0;S<_.channels_out;++S){var y=_.l3_side.tt[b][S];y.block_type!=f.SHORT_TYPE?(h=1.28/(1+Math.exp(3.5-n[b][S]/300))-.05,d=_.PSY.mask_adjust-h):(h=2.56/(1+Math.exp(3.5-n[b][S]/300))-.14,d=_.PSY.mask_adjust_short-h),_.masking_lower=Math.pow(10,.1*d),init_outer_loop(_,y),u[b][S]=a.calc_xmin(e,i[b][S],y,o[b][S]),0!=u[b][S]&&(m=0),l[b][S]=126,p+=c[b][S]}}for(b=0;b<_.mode_gr;b++)for(S=0;S<_.channels_out;S++)p>s[_.VBR_max_bitrate]&&(c[b][S]*=s[_.VBR_max_bitrate],c[b][S]/=p),l[b][S]>c[b][S]&&(l[b][S]=c[b][S]);return m},this.bitpressure_strategy=function(e,t,a,n){for(var r=0;r<e.mode_gr;r++)for(var i=0;i<e.channels_out;i++){for(var o=e.l3_side.tt[r][i],s=t[r][i],l=0,c=0;c<o.psy_lmax;c++)s[l++]*=1+.029*c*c/f.SBMAX_l/f.SBMAX_l;if(o.block_type==f.SHORT_TYPE)for(c=o.sfb_smin;c<f.SBMAX_s;c++)s[l++]*=1+.029*c*c/f.SBMAX_s/f.SBMAX_s,s[l++]*=1+.029*c*c/f.SBMAX_s/f.SBMAX_s,s[l++]*=1+.029*c*c/f.SBMAX_s/f.SBMAX_s;n[r][i]=0|Math.max(a[r][i],.9*n[r][i])}},this.VBR_new_prepare=function(e,n,r,i,o,s){var l,c=e.internal_flags,u=1,d=0,_=0;if(e.free_format){c.bitrate_index=0;h=new MeanBits(d);l=t.ResvFrameBegin(e,h),d=h.bits,o[0]=l}else{c.bitrate_index=c.VBR_max_bitrate;var h=new MeanBits(d);t.ResvFrameBegin(e,h),d=h.bits,get_framebits(e,o),l=o[c.VBR_max_bitrate]}for(var m=0;m<c.mode_gr;m++){a.on_pe(e,n,s[m],d,m,0),c.mode_ext==f.MPG_MD_MS_LR&&ms_convert(c.l3_side,m);for(var p=0;p<c.channels_out;++p){var g=c.l3_side.tt[m][p];c.masking_lower=Math.pow(10,.1*c.PSY.mask_adjust),init_outer_loop(c,g),0!=a.calc_xmin(e,r[m][p],g,i[m][p])&&(u=0),_+=s[m][p]}}for(m=0;m<c.mode_gr;m++)for(p=0;p<c.channels_out;p++)_>l&&(s[m][p]*=l,s[m][p]/=_);return u},this.calc_target_bits=function(n,r,i,o,s,l){var c,u,d,_,h=n.internal_flags,m=h.l3_side,p=0;h.bitrate_index=h.VBR_max_bitrate;var g=new MeanBits(p);for(l[0]=t.ResvFrameBegin(n,g),p=g.bits,h.bitrate_index=1,p=e.getframebits(n)-8*h.sideinfo_len,s[0]=p/(h.mode_gr*h.channels_out),p=n.VBR_mean_bitrate_kbps*n.framesize*1e3,0!=(1&h.substep_shaping)&&(p*=1.09),p/=n.out_samplerate,p-=8*h.sideinfo_len,p/=h.mode_gr*h.channels_out,(c=.93+.07*(11-n.compression_ratio)/5.5)<.9&&(c=.9),c>1&&(c=1),u=0;u<h.mode_gr;u++){var b=0;for(d=0;d<h.channels_out;d++){if(o[u][d]=int(c*p),r[u][d]>700){var v=int((r[u][d]-700)/1.4),S=m.tt[u][d];o[u][d]=int(c*p),S.block_type==f.SHORT_TYPE&&v<p/2&&(v=p/2),v>3*p/2?v=3*p/2:v<0&&(v=0),o[u][d]+=v}o[u][d]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(o[u][d]=LameInternalFlags.MAX_BITS_PER_CHANNEL),b+=o[u][d]}if(b>LameInternalFlags.MAX_BITS_PER_GRANULE)for(d=0;d<h.channels_out;++d)o[u][d]*=LameInternalFlags.MAX_BITS_PER_GRANULE,o[u][d]/=b}if(h.mode_ext==f.MPG_MD_MS_LR)for(u=0;u<h.mode_gr;u++)a.reduce_side(o[u],i[u],p*h.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(_=0,u=0;u<h.mode_gr;u++)for(d=0;d<h.channels_out;d++)o[u][d]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(o[u][d]=LameInternalFlags.MAX_BITS_PER_CHANNEL),_+=o[u][d];if(_>l[0])for(u=0;u<h.mode_gr;u++)for(d=0;d<h.channels_out;d++)o[u][d]*=l[0],o[u][d]/=_}}},328:(e,t,a)=>{var n=a(330),r=n.System,i=(n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays),o=(n.new_array_n,n.new_byte,n.new_double,n.new_float,n.new_float_n,n.new_int),s=(n.new_int_n,n.assert),l=a(191),c=a(94),u=a(985),d=a(568);e.exports=function e(){var t=null;function a(e){this.bits=0|e}this.qupvt=null,this.setModules=function(e){this.qupvt=e,t=e};var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function _(e,t,a,n,r,i){var o=.5946/t;for(s(e>0),e>>=1;0!=e--;)r[i++]=o>a[n++]?0:1,r[i++]=o>a[n++]?0:1}function f(e,a,n,r,i,o){s(e>0);var l=(e>>=1)%2;for(e>>=1;0!=e--;){var c,u,d,_,f,h,m,p;c=n[r++]*a,u=n[r++]*a,f=0|c,d=n[r++]*a,h=0|u,_=n[r++]*a,m=0|d,c+=t.adj43[f],p=0|_,u+=t.adj43[h],i[o++]=0|c,d+=t.adj43[m],i[o++]=0|u,_+=t.adj43[p],i[o++]=0|d,i[o++]=0|_}0!=l&&(f=0|(c=n[r++]*a),h=0|(u=n[r++]*a),c+=t.adj43[f],u+=t.adj43[h],i[o++]=0|c,i[o++]=0|u)}var h=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function m(e,t,a,n){var r=function(e,t,a){var n=0,r=0;do{var i=e[t++],o=e[t++];n<i&&(n=i),r<o&&(r=o)}while(t<a);return n<r&&(n=r),n}(e,t,a);switch(r){case 0:return r;case 1:return function(e,t,a,n){var r=0,i=c.ht[1].hlen;do{var o=2*e[t+0]+e[t+1];t+=2,r+=i[o]}while(t<a);return n.bits+=r,1}(e,t,a,n);case 2:case 3:return function(e,t,a,n,r){var i,o,s=0,l=c.ht[n].xlen;o=2==n?c.table23:c.table56;do{var u=e[t+0]*l+e[t+1];t+=2,s+=o[u]}while(t<a);return i=65535&s,(s>>=16)>i&&(s=i,n++),r.bits+=s,n}(e,t,a,h[r-1],n);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(e,t,a,n,r){var i=0,o=0,s=0,l=c.ht[n].xlen,u=c.ht[n].hlen,d=c.ht[n+1].hlen,_=c.ht[n+2].hlen;do{var f=e[t+0]*l+e[t+1];t+=2,i+=u[f],o+=d[f],s+=_[f]}while(t<a);var h=n;return i>o&&(i=o,h++),i>s&&(i=s,h=n+2),r.bits+=i,h}(e,t,a,h[r-1],n);default:if(r>d.IXMAX_VAL)return n.bits=d.LARGE_BITS,-1;var i,o;for(r-=15,i=24;i<32&&!(c.ht[i].linmax>=r);i++);for(o=i-8;o<24&&!(c.ht[o].linmax>=r);o++);return function(e,t,a,n,r,i){var o,s=65536*c.ht[n].xlen+c.ht[r].xlen,l=0;do{var u=e[t++],d=e[t++];0!=u&&(u>14&&(u=15,l+=s),u*=16),0!=d&&(d>14&&(d=15,l+=s),u+=d),l+=c.largetbl[u]}while(t<a);return o=65535&l,(l>>=16)>o&&(l=o,n=r),i.bits+=l,n}(e,t,a,o,i,n)}}function p(e,t,n,r,i,o,s,c){for(var u=t.big_values,d=2;d<l.SBMAX_l+1;d++){var _=e.scalefac_band.l[d];if(_>=u)break;var f=i[d-2]+t.count1bits;if(n.part2_3_length<=f)break;var h=new a(f),p=m(r,_,u,h);f=h.bits,n.part2_3_length<=f||(n.assign(t),n.part2_3_length=f,n.region0_count=o[d-2],n.region1_count=d-2-o[d-2],n.table_select[0]=s[d-2],n.table_select[1]=c[d-2],n.table_select[2]=p)}}this.noquant_count_bits=function(e,t,n){var r=t.l3_enc,i=Math.min(576,t.max_nonzero_coeff+2>>1<<1);for(null!=n&&(n.sfb_count1=0);i>1&&0==(r[i-1]|r[i-2]);i-=2);t.count1=i;for(var o=0,u=0;i>3;i-=4){var d;if((2147483647&(r[i-1]|r[i-2]|r[i-3]|r[i-4]))>1)break;d=2*(2*(2*r[i-4]+r[i-3])+r[i-2])+r[i-1],o+=c.t32l[d],u+=c.t33l[d]}var _=o;if(t.count1table_select=0,o>u&&(_=u,t.count1table_select=1),t.count1bits=_,t.big_values=i,0==i)return _;if(t.block_type==l.SHORT_TYPE)(o=3*e.scalefac_band.s[3])>t.big_values&&(o=t.big_values),u=t.big_values;else if(t.block_type==l.NORM_TYPE){if(s(i<=576),o=t.region0_count=e.bv_scf[i-2],u=t.region1_count=e.bv_scf[i-1],s(o+u+2<l.SBPSY_l),u=e.scalefac_band.l[o+u+2],o=e.scalefac_band.l[o+1],u<i){var f=new a(_);t.table_select[2]=m(r,u,i,f),_=f.bits}}else t.region0_count=7,t.region1_count=l.SBMAX_l-1-7-1,(o=e.scalefac_band.l[8])>(u=i)&&(o=u);if(o=Math.min(o,i),u=Math.min(u,i),s(o>=0),s(u>=0),0<o){f=new a(_);t.table_select[0]=m(r,0,o,f),_=f.bits}if(o<u){f=new a(_);t.table_select[1]=m(r,o,u,f),_=f.bits}if(2==e.use_best_huffman&&(t.part2_3_length=_,best_huffman_divide(e,t),_=t.part2_3_length),null!=n&&t.block_type==l.NORM_TYPE){for(var h=0;e.scalefac_band.l[h]<t.big_values;)h++;n.sfb_count1=h}return _},this.count_bits=function(e,a,n,r){var o=n.l3_enc,c=d.IXMAX_VAL/t.IPOW20(n.global_gain);if(n.xrpow_max>c)return d.LARGE_BITS;if(function(e,a,n,r,o){var c,u,d,h=0,m=0,p=0,g=0,b=a,v=0,S=b,y=0,w=e,E=0;for(d=null!=o&&r.global_gain==o.global_gain,u=r.block_type==l.SHORT_TYPE?38:21,c=0;c<=u;c++){var A=-1;if((d||r.block_type==l.NORM_TYPE)&&(A=r.global_gain-(r.scalefac[c]+(0!=r.preflag?t.pretab[c]:0)<<r.scalefac_scale+1)-8*r.subblock_gain[r.window[c]]),s(r.width[c]>=0),d&&o.step[c]==A)0!=m&&(f(m,n,w,E,S,y),m=0),0!=p&&(_(p,n,w,E,S,y),p=0);else{var x,T=r.width[c];if(h+r.width[c]>r.max_nonzero_coeff&&(x=r.max_nonzero_coeff-h+1,i.fill(a,r.max_nonzero_coeff,576,0),(T=x)<0&&(T=0),c=u+1),0==m&&0==p&&(S=b,y=v,w=e,E=g),null!=o&&o.sfb_count1>0&&c>=o.sfb_count1&&o.step[c]>0&&A>=o.step[c]?(0!=m&&(f(m,n,w,E,S,y),m=0,S=b,y=v,w=e,E=g),p+=T):(0!=p&&(_(p,n,w,E,S,y),p=0,S=b,y=v,w=e,E=g),m+=T),T<=0){0!=p&&(_(p,n,w,E,S,y),p=0),0!=m&&(f(m,n,w,E,S,y),m=0);break}}c<=u&&(v+=r.width[c],g+=r.width[c],h+=r.width[c])}0!=m&&(f(m,n,w,E,S,y),m=0),0!=p&&(_(p,n,w,E,S,y),p=0)}(a,o,t.IPOW20(n.global_gain),n,r),0!=(2&e.substep_shaping))for(var u=0,h=n.global_gain+n.scalefac_scale,m=.634521682242439/t.IPOW20(h),p=0;p<n.sfbmax;p++){var g,b=n.width[p];if(s(b>=0),0==e.pseudohalf[p])u+=b;else for(g=u,u+=b;g<u;++g)o[g]=a[g]>=m?o[g]:0}return this.noquant_count_bits(e,n,r)},this.best_huffman_divide=function(e,t){var n=new u,r=t.l3_enc,i=o(23),_=o(23),f=o(23),h=o(23);if(t.block_type!=l.SHORT_TYPE||1!=e.mode_gr){n.assign(t),t.block_type==l.NORM_TYPE&&(!function(e,t,n,r,i,o,s){for(var l=t.big_values,c=0;c<=22;c++)r[c]=d.LARGE_BITS;for(c=0;c<16;c++){var u=e.scalefac_band.l[c+1];if(u>=l)break;var _=0,f=new a(_),h=m(n,0,u,f);_=f.bits;for(var p=0;p<8;p++){var g=e.scalefac_band.l[c+p+2];if(g>=l)break;var b=_,v=m(n,u,g,f=new a(b));b=f.bits,r[c+p]>b&&(r[c+p]=b,i[c+p]=c,o[c+p]=h,s[c+p]=v)}}}(e,t,r,i,_,f,h),p(e,n,t,r,i,_,f,h));var g=n.big_values;if(!(0==g||(r[g-2]|r[g-1])>1)&&!((g=t.count1+2)>576)){n.assign(t),n.count1=g;var b=0,v=0;for(s(g<=576);g>n.big_values;g-=4){var S=2*(2*(2*r[g-4]+r[g-3])+r[g-2])+r[g-1];b+=c.t32l[S],v+=c.t33l[S]}if(n.big_values=g,n.count1table_select=0,b>v&&(b=v,n.count1table_select=1),n.count1bits=b,n.block_type==l.NORM_TYPE)p(e,n,t,r,i,_,f,h);else{if(n.part2_3_length=b,(b=e.scalefac_band.l[8])>g&&(b=g),b>0){var y=new a(n.part2_3_length);n.table_select[0]=m(r,0,b,y),n.part2_3_length=y.bits}if(g>b){y=new a(n.part2_3_length);n.table_select[1]=m(r,b,g,y),n.part2_3_length=y.bits}t.part2_3_length>n.part2_3_length&&t.assign(n)}}}};var g=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],b=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],v=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],S=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];e.slen1_tab=v,e.slen2_tab=S,this.best_scalefac_store=function(e,a,n,r){var i,o,u,d,_=r.tt[a][n],f=0;for(u=0,i=0;i<_.sfbmax;i++){var h=_.width[i];for(s(h>=0),u+=h,d=-h;d<0&&0==_.l3_enc[d+u];d++);0==d&&(_.scalefac[i]=f=-2)}if(0==_.scalefac_scale&&0==_.preflag){var m=0;for(i=0;i<_.sfbmax;i++)_.scalefac[i]>0&&(m|=_.scalefac[i]);if(0==(1&m)&&0!=m){for(i=0;i<_.sfbmax;i++)_.scalefac[i]>0&&(_.scalefac[i]>>=1);_.scalefac_scale=f=1}}if(0==_.preflag&&_.block_type!=l.SHORT_TYPE&&2==e.mode_gr){for(i=11;i<l.SBPSY_l&&!(_.scalefac[i]<t.pretab[i]&&-2!=_.scalefac[i]);i++);if(i==l.SBPSY_l){for(i=11;i<l.SBPSY_l;i++)_.scalefac[i]>0&&(_.scalefac[i]-=t.pretab[i]);_.preflag=f=1}}for(o=0;o<4;o++)r.scfsi[n][o]=0;for(2==e.mode_gr&&1==a&&r.tt[0][n].block_type!=l.SHORT_TYPE&&r.tt[1][n].block_type!=l.SHORT_TYPE&&(!function(e,t){for(var a,n=t.tt[1][e],r=t.tt[0][e],i=0;i<c.scfsi_band.length-1;i++){for(a=c.scfsi_band[i];a<c.scfsi_band[i+1]&&!(r.scalefac[a]!=n.scalefac[a]&&n.scalefac[a]>=0);a++);if(a==c.scfsi_band[i+1]){for(a=c.scfsi_band[i];a<c.scfsi_band[i+1];a++)n.scalefac[a]=-1;t.scfsi[e][i]=1}}var o=0,s=0;for(a=0;a<11;a++)-1!=n.scalefac[a]&&(s++,o<n.scalefac[a]&&(o=n.scalefac[a]));for(var u=0,d=0;a<l.SBPSY_l;a++)-1!=n.scalefac[a]&&(d++,u<n.scalefac[a]&&(u=n.scalefac[a]));for(i=0;i<16;i++)if(o<g[i]&&u<b[i]){var _=v[i]*s+S[i]*d;n.part2_length>_&&(n.part2_length=_,n.scalefac_compress=i)}}(n,r),f=0),i=0;i<_.sfbmax;i++)-2==_.scalefac[i]&&(_.scalefac[i]=0);0!=f&&(2==e.mode_gr?this.scale_bitcount(_):this.scale_bitcount_lsf(e,_))};var y=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],w=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],E=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(e){var a,n,r,i=0,o=0,c=e.scalefac;if(s(function(e,t){for(var a=0;a<t;++a)if(e[a]<0)return!1;return!0}(c,e.sfbmax)),e.block_type==l.SHORT_TYPE)r=y,0!=e.mixed_block_flag&&(r=w);else if(r=E,0==e.preflag){for(n=11;n<l.SBPSY_l&&!(c[n]<t.pretab[n]);n++);if(n==l.SBPSY_l)for(e.preflag=1,n=11;n<l.SBPSY_l;n++)c[n]-=t.pretab[n]}for(n=0;n<e.sfbdivide;n++)i<c[n]&&(i=c[n]);for(;n<e.sfbmax;n++)o<c[n]&&(o=c[n]);for(e.part2_length=d.LARGE_BITS,a=0;a<16;a++)i<g[a]&&o<b[a]&&e.part2_length>r[a]&&(e.part2_length=r[a],e.scalefac_compress=a);return e.part2_length==d.LARGE_BITS};var A=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(e,a){var n,i,c,u,d,_,f,h,m=o(4),p=a.scalefac;for(n=0!=a.preflag?2:0,f=0;f<4;f++)m[f]=0;if(a.block_type==l.SHORT_TYPE){i=1;var g=t.nr_of_sfb_block[n][i];for(h=0,c=0;c<4;c++)for(u=g[c]/3,f=0;f<u;f++,h++)for(d=0;d<3;d++)p[3*h+d]>m[c]&&(m[c]=p[3*h+d])}else{i=0;g=t.nr_of_sfb_block[n][i];for(h=0,c=0;c<4;c++)for(u=g[c],f=0;f<u;f++,h++)p[h]>m[c]&&(m[c]=p[h])}for(_=!1,c=0;c<4;c++)m[c]>A[n][c]&&(_=!0);if(!_){var b,v,S,y;for(a.sfb_partition_table=t.nr_of_sfb_block[n][i],c=0;c<4;c++)a.slen[c]=x[m[c]];switch(b=a.slen[0],v=a.slen[1],S=a.slen[2],y=a.slen[3],n){case 0:a.scalefac_compress=(5*b+v<<4)+(S<<2)+y;break;case 1:a.scalefac_compress=400+(5*b+v<<2)+S;break;case 2:a.scalefac_compress=500+3*b+v;break;default:r.err.printf("intensity stereo not implemented yet\n")}}if(!_)for(s(null!=a.sfb_partition_table),a.part2_length=0,c=0;c<4;c++)a.part2_length+=a.slen[c]*a.sfb_partition_table[c];return _};var x=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){for(var a,r=0;e.scalefac_band.l[++r]<t;);for(a=n[r][0];e.scalefac_band.l[a+1]>t;)a--;for(a<0&&(a=n[r][0]),e.bv_scf[t-2]=a,a=n[r][1];e.scalefac_band.l[a+e.bv_scf[t-2]+2]>t;)a--;a<0&&(a=n[r][1]),e.bv_scf[t-1]=a}}}},330:e=>{function t(e){return new Int16Array(e)}function a(e){return new Int32Array(e)}function n(e){return new Float32Array(e)}var r={fill:function(e,t,a,n){if(2==arguments.length)for(var r=0;r<e.length;r++)e[r]=arguments[1];else for(r=t;r<a;r++)e[r]=n}},i={arraycopy:function(e,t,a,n,r){for(var i=t+r;t<i;)a[n++]=e[t++]},out:{}};i.out.println=function(e){console.log(e)},i.out.printf=function(){console.log.apply(console,arguments)};var o={};function s(e){this.ordinal=e}o.SQRT2=1.4142135623730951,o.FAST_LOG10=function(e){return Math.log10(e)},o.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},s.short_block_allowed=new s(0),s.short_block_coupled=new s(1),s.short_block_dispensed=new s(2),s.short_block_forced=new s(3);var l={};function c(e){this.ordinal=e}l.MAX_VALUE=34028235e31,c.vbr_off=new c(0),c.vbr_mt=new c(1),c.vbr_rh=new c(2),c.vbr_abr=new c(3),c.vbr_mtrh=new c(4),c.vbr_default=c.vbr_mtrh;e.exports={System:i,VbrMode:c,Float:l,ShortBlock:s,Util:o,Arrays:r,new_array_n:function e(t){if(1==t.length)return new Array(t[0]);var a=t[0];t=t.slice(1);for(var n=[],r=0;r<a;r++)n.push(e(t));return n},new_byte:function(e){return new Int8Array(e)},new_double:function(e){return new Float64Array(e)},new_float:n,new_float_n:function e(t){if(1==t.length)return n(t[0]);var a=t[0];t=t.slice(1);for(var r=[],i=0;i<a;i++)r.push(e(t));return r},new_int:a,new_int_n:function e(t){if(1==t.length)return a(t[0]);var n=t[0];t=t.slice(1);for(var r=[],i=0;i<n;i++)r.push(e(t));return r},new_short:t,new_short_n:function e(a){if(1==a.length)return t(a[0]);var n=a[0];a=a.slice(1);for(var r=[],i=0;i<n;i++)r.push(e(a));return r},assert:function(e){}}},361:e=>{e.exports=function(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}},366:(e,t,a)=>{var n=a(293);e.exports=function(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=n.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}},391:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float),i=(n.new_float_n,n.new_int),o=(n.new_int_n,n.assert,a(710));e.exports=function(){this.linprebuf=r(2*o.MAX_ORDER),this.linpre=0,this.lstepbuf=r(o.MAX_SAMPLES_PER_WINDOW+o.MAX_ORDER),this.lstep=0,this.loutbuf=r(o.MAX_SAMPLES_PER_WINDOW+o.MAX_ORDER),this.lout=0,this.rinprebuf=r(2*o.MAX_ORDER),this.rinpre=0,this.rstepbuf=r(o.MAX_SAMPLES_PER_WINDOW+o.MAX_ORDER),this.rstep=0,this.routbuf=r(o.MAX_SAMPLES_PER_WINDOW+o.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=i(0|o.STEPS_per_dB*o.MAX_dB),this.B=i(0|o.STEPS_per_dB*o.MAX_dB)}},408:(e,t,a)=>{var n=a(330),r=n.System,i=(n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays),o=(n.new_array_n,n.new_byte),s=(n.new_double,n.new_float,n.new_float_n),l=n.new_int,c=(n.new_int_n,n.assert),u=a(328),d=a(94),_=a(191),f=a(476);function h(){var e=a(466),t=this,n=32,h=null,m=null,p=null,g=null;this.setModules=function(e,t,a,n){h=e,m=t,p=a,g=n};var b=null,v=0,S=0,y=0;function w(e){r.arraycopy(e.header[e.w_ptr].buf,0,b,S,e.sideinfo_len),S+=e.sideinfo_len,v+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&f.MAX_HEADER_BUF-1}function E(t,a,r){for(c(r<30);r>0;){var i;0==y&&(y=8,S++,c(S<e.LAME_MAXMP3BUFFER),c(t.header[t.w_ptr].write_timing>=v),t.header[t.w_ptr].write_timing==v&&w(t),b[S]=0),i=Math.min(r,y),y-=i,c((r-=i)<n),c(y<n),b[S]|=a>>r<<y,v+=i}}function A(t,a,r){for(c(r<30);r>0;){var i;0==y&&(y=8,S++,c(S<e.LAME_MAXMP3BUFFER),b[S]=0),i=Math.min(r,y),y-=i,c((r-=i)<n),c(y<n),b[S]|=a>>r<<y,v+=i}}function x(e,t){var a,n=e.internal_flags;if(c(t>=0),t>=8&&(E(n,76,8),t-=8),t>=8&&(E(n,65,8),t-=8),t>=8&&(E(n,77,8),t-=8),t>=8&&(E(n,69,8),t-=8),t>=32){var r=p.getLameShortVersion();if(t>=32)for(a=0;a<r.length&&t>=8;++a)t-=8,E(n,r.charAt(a),8)}for(;t>=1;t-=1)E(n,n.ancillary_flag,1),n.ancillary_flag^=e.disable_reservoir?0:1;c(0==t)}function T(e,t,a){for(var r=e.header[e.h_ptr].ptr;a>0;){var i=Math.min(a,8-(7&r));c((a-=i)<n),e.header[e.h_ptr].buf[r>>3]|=t>>a<<8-(7&r)-i,r+=i}e.header[e.h_ptr].ptr=r}function B(e,t){e<<=8;for(var a=0;a<8;a++)0!=(65536&((t<<=1)^(e<<=1)))&&(t^=32773);return t}function R(e,t){var a,n=d.ht[t.count1table_select+32],r=0,i=t.big_values,o=t.big_values;for(c(t.count1table_select<2),a=(t.count1-t.big_values)/4;a>0;--a){var s,l=0,u=0;0!=(s=t.l3_enc[i+0])&&(u+=8,t.xr[o+0]<0&&l++,c(s<=1)),0!=(s=t.l3_enc[i+1])&&(u+=4,l*=2,t.xr[o+1]<0&&l++,c(s<=1)),0!=(s=t.l3_enc[i+2])&&(u+=2,l*=2,t.xr[o+2]<0&&l++,c(s<=1)),0!=(s=t.l3_enc[i+3])&&(u++,l*=2,t.xr[o+3]<0&&l++,c(s<=1)),i+=4,o+=4,E(e,l+n.table[u],n.hlen[u]),r+=n.hlen[u]}return r}function M(e,t,a,r,i){var o=d.ht[t],s=0;if(c(t<32),0==t)return s;for(var l=a;l<r;l+=2){var u=0,_=0,f=o.xlen,h=o.xlen,m=0,p=i.l3_enc[l],g=i.l3_enc[l+1];if(0!=p&&(i.xr[l]<0&&m++,u--),t>15){if(p>14){var b=p-15;c(b<=o.linmax),m|=b<<1,_=f,p=15}if(g>14){var v=g-15;c(v<=o.linmax),m<<=f,m|=v,_+=f,g=15}h=16}0!=g&&(m<<=1,i.xr[l+1]<0&&m++,u--),c((p|g)<16),p=p*h+g,_-=u,u+=o.hlen[p],c(u<=n),c(_<=n),E(e,o.table[p],u),E(e,m,_),s+=u+_}return s}function P(e,t){var a=3*e.scalefac_band.s[3];a>t.big_values&&(a=t.big_values);var n=M(e,t.table_select[0],0,a,t);return n+=M(e,t.table_select[1],a,t.big_values,t)}function k(e,t){var a,n,r,i;a=t.big_values,c(0<=a&&a<=576);var o=t.region0_count+1;return c(0<=o),c(o<e.scalefac_band.l.length),r=e.scalefac_band.l[o],o+=t.region1_count+1,c(0<=o),c(o<e.scalefac_band.l.length),r>a&&(r=a),(i=e.scalefac_band.l[o])>a&&(i=a),n=M(e,t.table_select[0],0,r,t),n+=M(e,t.table_select[1],r,i,t),n+=M(e,t.table_select[2],i,a,t)}function I(){this.total=0}function L(e,a){var n,i,o,s,l,c=e.internal_flags;return l=c.w_ptr,-1==(s=c.h_ptr-1)&&(s=f.MAX_HEADER_BUF-1),n=c.header[s].write_timing-v,a.total=n,n>=0&&(i=1+s-l,s<l&&(i=1+s-l+f.MAX_HEADER_BUF),n-=8*i*c.sideinfo_len),n+=o=t.getframebits(e),a.total+=o,a.total%8!=0?a.total=1+a.total/8:a.total=a.total/8,a.total+=S+1,n<0&&r.err.println("strange error flushing buffer ... \n"),n}this.getframebits=function(e){var t,a=e.internal_flags;return t=0!=a.bitrate_index?d.bitrate_table[e.version][a.bitrate_index]:e.brate,c(8<=t&&t<=640),8*(0|72e3*(e.version+1)*t/e.out_samplerate+a.padding)},this.CRC_writeheader=function(e,t){var a=65535;a=B(255&t[2],a),a=B(255&t[3],a);for(var n=6;n<e.sideinfo_len;n++)a=B(255&t[n],a);t[4]=byte(a>>8),t[5]=byte(255&a)},this.flush_bitstream=function(e){var t,a,n=e.internal_flags,r=n.h_ptr-1;if(-1==r&&(r=f.MAX_HEADER_BUF-1),t=n.l3_side,!((a=L(e,new I))<0)){if(x(e,a),c(n.header[r].write_timing+this.getframebits(e)==v),n.ResvSize=0,t.main_data_begin=0,n.findReplayGain){var i=h.GetTitleGain(n.rgdata);c(NEQ(i,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),n.RadioGain=0|Math.floor(10*i+.5)}n.findPeakSample&&(n.noclipGainChange=0|Math.ceil(20*Math.log10(n.PeakSample/32767)*10),n.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?n.noclipScale=Math.floor(32767/n.PeakSample*100)/100:n.noclipScale=-1)}},this.add_dummy_byte=function(e,t,a){for(var n,r=e.internal_flags;a-- >0;)for(A(0,t,8),n=0;n<f.MAX_HEADER_BUF;++n)r.header[n].write_timing+=8},this.format_bitstream=function(e){var t,a=e.internal_flags;t=a.l3_side;var n=this.getframebits(e);x(e,t.resvDrain_pre),function(e,t){var a,n,o,s=e.internal_flags;if(a=s.l3_side,s.header[s.h_ptr].ptr=0,i.fill(s.header[s.h_ptr].buf,0,s.sideinfo_len,0),e.out_samplerate<16e3?T(s,4094,12):T(s,4095,12),T(s,e.version,1),T(s,1,2),T(s,e.error_protection?0:1,1),T(s,s.bitrate_index,4),T(s,s.samplerate_index,2),T(s,s.padding,1),T(s,e.extension,1),T(s,e.mode.ordinal(),2),T(s,s.mode_ext,2),T(s,e.copyright,1),T(s,e.original,1),T(s,e.emphasis,2),e.error_protection&&T(s,0,16),1==e.version){for(c(a.main_data_begin>=0),T(s,a.main_data_begin,9),2==s.channels_out?T(s,a.private_bits,3):T(s,a.private_bits,5),o=0;o<s.channels_out;o++){var l;for(l=0;l<4;l++)T(s,a.scfsi[o][l],1)}for(n=0;n<2;n++)for(o=0;o<s.channels_out;o++)T(s,(u=a.tt[n][o]).part2_3_length+u.part2_length,12),T(s,u.big_values/2,9),T(s,u.global_gain,8),T(s,u.scalefac_compress,4),u.block_type!=_.NORM_TYPE?(T(s,1,1),T(s,u.block_type,2),T(s,u.mixed_block_flag,1),14==u.table_select[0]&&(u.table_select[0]=16),T(s,u.table_select[0],5),14==u.table_select[1]&&(u.table_select[1]=16),T(s,u.table_select[1],5),T(s,u.subblock_gain[0],3),T(s,u.subblock_gain[1],3),T(s,u.subblock_gain[2],3)):(T(s,0,1),14==u.table_select[0]&&(u.table_select[0]=16),T(s,u.table_select[0],5),14==u.table_select[1]&&(u.table_select[1]=16),T(s,u.table_select[1],5),14==u.table_select[2]&&(u.table_select[2]=16),T(s,u.table_select[2],5),c(0<=u.region0_count&&u.region0_count<16),c(0<=u.region1_count&&u.region1_count<8),T(s,u.region0_count,4),T(s,u.region1_count,3)),T(s,u.preflag,1),T(s,u.scalefac_scale,1),T(s,u.count1table_select,1)}else for(c(a.main_data_begin>=0),T(s,a.main_data_begin,8),T(s,a.private_bits,s.channels_out),n=0,o=0;o<s.channels_out;o++){var u;T(s,(u=a.tt[n][o]).part2_3_length+u.part2_length,12),T(s,u.big_values/2,9),T(s,u.global_gain,8),T(s,u.scalefac_compress,9),u.block_type!=_.NORM_TYPE?(T(s,1,1),T(s,u.block_type,2),T(s,u.mixed_block_flag,1),14==u.table_select[0]&&(u.table_select[0]=16),T(s,u.table_select[0],5),14==u.table_select[1]&&(u.table_select[1]=16),T(s,u.table_select[1],5),T(s,u.subblock_gain[0],3),T(s,u.subblock_gain[1],3),T(s,u.subblock_gain[2],3)):(T(s,0,1),14==u.table_select[0]&&(u.table_select[0]=16),T(s,u.table_select[0],5),14==u.table_select[1]&&(u.table_select[1]=16),T(s,u.table_select[1],5),14==u.table_select[2]&&(u.table_select[2]=16),T(s,u.table_select[2],5),c(0<=u.region0_count&&u.region0_count<16),c(0<=u.region1_count&&u.region1_count<8),T(s,u.region0_count,4),T(s,u.region1_count,3)),T(s,u.scalefac_scale,1),T(s,u.count1table_select,1)}e.error_protection&&CRC_writeheader(s,s.header[s.h_ptr].buf);var d=s.h_ptr;c(s.header[d].ptr==8*s.sideinfo_len),s.h_ptr=d+1&f.MAX_HEADER_BUF-1,s.header[s.h_ptr].write_timing=s.header[d].write_timing+t,s.h_ptr==s.w_ptr&&r.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}(e,n);var o=8*a.sideinfo_len;if(o+=function(e){var t,a,n,r,i=0,o=e.internal_flags,s=o.l3_side;if(1==e.version)for(t=0;t<2;t++)for(a=0;a<o.channels_out;a++){var l=s.tt[t][a],d=u.slen1_tab[l.scalefac_compress],f=u.slen2_tab[l.scalefac_compress];for(r=0,n=0;n<l.sfbdivide;n++)-1!=l.scalefac[n]&&(E(o,l.scalefac[n],d),r+=d);for(;n<l.sfbmax;n++)-1!=l.scalefac[n]&&(E(o,l.scalefac[n],f),r+=f);c(r==l.part2_length),l.block_type==_.SHORT_TYPE?r+=P(o,l):r+=k(o,l),r+=R(o,l),c(r==l.part2_3_length+l.part2_length),i+=r}else for(t=0,a=0;a<o.channels_out;a++){l=s.tt[t][a];var h,m,p=0;if(c(null!=l.sfb_partition_table),r=0,n=0,m=0,l.block_type==_.SHORT_TYPE){for(;m<4;m++){var g=l.sfb_partition_table[m]/3,b=l.slen[m];for(h=0;h<g;h++,n++)E(o,Math.max(l.scalefac[3*n+0],0),b),E(o,Math.max(l.scalefac[3*n+1],0),b),E(o,Math.max(l.scalefac[3*n+2],0),b),p+=3*b}r+=P(o,l)}else{for(;m<4;m++)for(g=l.sfb_partition_table[m],b=l.slen[m],h=0;h<g;h++,n++)E(o,Math.max(l.scalefac[n],0),b),p+=b;r+=k(o,l)}r+=R(o,l),c(r==l.part2_3_length),c(p==l.part2_length),i+=p+r}return i}(e),x(e,t.resvDrain_post),o+=t.resvDrain_post,t.main_data_begin+=(n-o)/8,L(e,new I)!=a.ResvSize&&r.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=a.ResvSize&&(r.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,a.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*a.sideinfo_len,o-t.resvDrain_post-8*a.sideinfo_len,o,o%8,n),r.err.println("This is a fatal error.  It has several possible causes:"),r.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),r.err.println(" 9%%  Your system is overclocked"),r.err.println(" 1%%  bug in LAME encoding library"),a.ResvSize=8*t.main_data_begin),c(v%8==0),v>1e9){var s;for(s=0;s<f.MAX_HEADER_BUF;++s)a.header[s].write_timing-=v;v=0}return 0},this.copy_buffer=function(e,t,a,n,i){var o=S+1;if(o<=0)return 0;if(0!=n&&o>n)return-1;if(r.arraycopy(b,0,t,a,o),S=-1,y=0,0!=i){var u=l(1);if(u[0]=e.nMusicCRC,g.updateMusicCRC(u,t,a,o),e.nMusicCRC=u[0],o>0&&(e.VBR_seek_table.nBytesWritten+=o),e.decode_on_the_fly)for(var d,_=s([2,1152]),f=o,p=-1;0!=p;)if(p=m.hip_decode1_unclipped(e.hip,t,a,f,_[0],_[1]),f=0,-1==p&&(p=0),p>0){if(c(p<=1152),e.findPeakSample){for(d=0;d<p;d++)_[0][d]>e.PeakSample?e.PeakSample=_[0][d]:-_[0][d]>e.PeakSample&&(e.PeakSample=-_[0][d]);if(e.channels_out>1)for(d=0;d<p;d++)_[1][d]>e.PeakSample?e.PeakSample=_[1][d]:-_[1][d]>e.PeakSample&&(e.PeakSample=-_[1][d])}if(e.findReplayGain&&h.AnalyzeSamples(e.rgdata,_[0],0,_[1],0,p,e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}return o},this.init_bit_stream_w=function(t){b=o(e.LAME_MAXMP3BUFFER),t.h_ptr=t.w_ptr=0,t.header[t.h_ptr].write_timing=0,S=-1,y=0,v=0}}h.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},h.NEQ=function(e,t){return!h.EQ(e,t)},e.exports=h},452:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float),i=(n.new_float_n,n.new_int,n.new_int_n,n.assert,a(191));e.exports=function(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=r(i.SBMAX_l),this.s=r(i.SBMAX_s),this.psfb21=r(i.PSFB21),this.psfb12=r(i.PSFB12),this.cb_l=r(i.CBANDS),this.cb_s=r(i.CBANDS),this.eql_w=r(i.BLKSIZE/2)}},466:(e,t,a)=>{var n=a(330),r=n.System,i=n.VbrMode,o=(n.Float,n.ShortBlock),s=(n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float),l=(n.new_float_n,n.new_int,n.new_int_n),c=n.new_short_n,u=n.assert,d=a(294),_=a(366),f=a(476),h=a(452),m=a(391),p=a(613),g=a(408),b=a(94),v=a(191);e.exports=function e(){var t,n,S,y,w,E=a(293),A=this;e.V9=410,e.V8=420,e.V7=430,e.V6=440,e.V5=450,e.V4=460,e.V3=470,e.V2=480,e.V1=490,e.V0=500,e.R3MIX=1e3,e.STANDARD=1001,e.EXTREME=1002,e.INSANE=1003,e.STANDARD_FAST=1004,e.EXTREME_FAST=1005,e.MEDIUM=1006,e.MEDIUM_FAST=1007,e.LAME_MAXMP3BUFFER=147456;var x,T,B,R=new d;function M(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=s(v.SBMAX_l),this.bo_s_weight=s(v.SBMAX_s)}function P(){this.lowerlimit=0}function k(e,t){this.lowpass=t}this.enc=new v,this.setModules=function(e,a,r,i,o,s,l,c,u){t=e,n=a,S=r,y=i,w=o,x=s,T=c,B=u,this.enc.setModules(n,R,y,x)};var I=4294479419;function L(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function C(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:case 11025:return t.version=0,0;case 24e3:case 12e3:return t.version=0,1;case 16e3:case 8e3:return t.version=0,2;default:return t.version=0,-1}}function D(e,t,a){a<16e3&&(t=2);for(var n=b.bitrate_table[t][1],r=2;r<=14;r++)b.bitrate_table[t][r]>0&&Math.abs(b.bitrate_table[t][r]-e)<Math.abs(n-e)&&(n=b.bitrate_table[t][r]);return n}function N(e,t,a){a<16e3&&(t=2);for(var n=0;n<=14;n++)if(b.bitrate_table[t][n]>0&&b.bitrate_table[t][n]==e)return n;return-1}function O(e,t){var a=[new k(8,2e3),new k(16,3700),new k(24,3900),new k(32,5500),new k(40,7e3),new k(48,7500),new k(56,1e4),new k(64,11e3),new k(80,13500),new k(96,15100),new k(112,15600),new k(128,17e3),new k(160,17500),new k(192,18600),new k(224,19400),new k(256,19700),new k(320,20500)],n=A.nearestBitrateFullIndex(t);e.lowerlimit=a[n].lowpass}function F(e){var t=v.BLKSIZE+e.framesize-v.FFTOFFSET;return t=Math.max(t,512+e.framesize-32),u(f.MFSIZE>=t),t}function U(e,t,a,n,r,i){var o=A.enc.lame_encode_mp3_frame(e,t,a,n,r,i);return e.frameNum++,o}function V(){this.n_in=0,this.n_out=0}function H(){this.num_used=0}function q(e,t){return 0!=t?q(t,e%t):e}function z(e,t,a){var n=Math.PI*t;(e/=a)<0&&(e=0),e>1&&(e=1);var r=e-.5,i=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(r)<1e-9?n/Math.PI:i*Math.sin(a*n*r)/(Math.PI*a*r)}function G(e,t,a,n,r,i,o,l,c){var d,_,h=e.internal_flags,m=0,p=e.out_samplerate/q(e.out_samplerate,e.in_samplerate);p>f.BPC&&(p=f.BPC);var g=Math.abs(h.resample_ratio-Math.floor(.5+h.resample_ratio))<1e-4?1:0,b=1/h.resample_ratio;b>1&&(b=1);var v=31;0==v%2&&--v;var S=(v+=g)+1;if(0==h.fill_buffer_resample_init){for(h.inbuf_old[0]=s(S),h.inbuf_old[1]=s(S),d=0;d<=2*p;++d)h.blackfilt[d]=s(S);for(h.itime[0]=0,h.itime[1]=0,m=0;m<=2*p;m++){var y=0,w=(m-p)/(2*p);for(d=0;d<=v;d++)y+=h.blackfilt[m][d]=z(d-w,b,v);for(d=0;d<=v;d++)h.blackfilt[m][d]/=y}h.fill_buffer_resample_init=1}var E=h.inbuf_old[c];for(_=0;_<n;_++){var A,x;if(A=_*h.resample_ratio,v+(m=0|Math.floor(A-h.itime[c]))-v/2>=o)break;w=A-h.itime[c]-(m+v%2*.5);u(Math.abs(w)<=.501),x=0|Math.floor(2*w*p+p+.5);var T=0;for(d=0;d<=v;++d){var B=0|d+m-v/2;u(B<o),u(B+S>=0),T+=(B<0?E[S+B]:r[i+B])*h.blackfilt[x][d]}t[a+_]=T}if(l.num_used=Math.min(o,v+m-v/2),h.itime[c]+=l.num_used-_*h.resample_ratio,l.num_used>=S)for(d=0;d<S;d++)E[d]=r[i+l.num_used+d-S];else{var R=S-l.num_used;for(d=0;d<R;++d)E[d]=E[d+l.num_used];for(m=0;d<S;++d,++m)E[d]=r[i+m];u(m==l.num_used)}return _}function X(e,t,a,n,r,i){var o=e.internal_flags;if(o.resample_ratio<.9999||o.resample_ratio>1.0001)for(var s=0;s<o.channels_out;s++){var l=new H;i.n_out=G(e,t[s],o.mf_size,e.framesize,a[s],n,r,l,s),i.n_in=l.num_used}else{i.n_out=Math.min(e.framesize,r),i.n_in=i.n_out;for(var c=0;c<i.n_out;++c)t[0][o.mf_size+c]=a[0][n+c],2==o.channels_out&&(t[1][o.mf_size+c]=a[1][n+c])}}this.lame_init=function(){var e=new _,t=function(e){var t;return e.class_id=I,t=e.internal_flags=new f,e.mode=E.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=i.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=v.ENCDELAY+v.POSTDELAY,e.encoder_padding=0,t.mf_size=v.ENCDELAY-v.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0}(e);return 0!=t?null:(e.lame_allocated_gfp=1,e)},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],a=0,n=0,r=0,i=0;i=t[16],r=16,n=t[16],a=16;for(var o=0;o<16;o++)if(Math.max(e,t[o+1])!=e){i=t[o+1],r=o+1,n=t[o],a=o;break}return i-e>e-n?a:r},this.lame_init_params=function(e){var a=e.internal_flags;if(a.Class_ID=0,null==a.ATH&&(a.ATH=new h),null==a.PSY&&(a.PSY=new M),null==a.rgdata&&(a.rgdata=new m),a.channels_in=e.num_channels,1==a.channels_in&&(e.mode=E.MONO),a.channels_out=e.mode==E.MONO?1:2,a.mode_ext=v.MPG_MD_MS_LR,e.mode==E.MONO&&(e.force_ms=!1),e.VBR==i.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==i.vbr_off||e.VBR==i.vbr_mtrh||e.VBR==i.vbr_mt||(e.free_format=!1),e.VBR==i.vbr_off&&0==e.brate&&g.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==i.vbr_off&&e.compression_ratio>0&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*a.channels_out/(1e3*e.compression_ratio),a.samplerate_index=C(e.out_samplerate,e),e.free_format||(e.brate=D(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var s=16e3;switch(e.VBR){case i.vbr_off:O(c=new P,e.brate),s=c.lowerlimit;break;case i.vbr_abr:var c;O(c=new P,e.VBR_mean_bitrate_kbps),s=c.lowerlimit;break;case i.vbr_rh:var _=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=e.VBR_q&&e.VBR_q<=9){var f=_[e.VBR_q],A=_[e.VBR_q+1],k=e.VBR_q_frac;s=linear_int(f,A,k)}else s=19500;break;default:_=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=e.VBR_q&&e.VBR_q<=9){f=_[e.VBR_q],A=_[e.VBR_q+1],k=e.VBR_q_frac;s=linear_int(f,A,k)}else s=19500}e.mode!=E.MONO||e.VBR!=i.vbr_off&&e.VBR!=i.vbr_abr||(s*=1.5),e.lowpassfreq=0|s}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),e.out_samplerate=function(e,t){var a=44100;return t>=48e3?a=48e3:t>=44100?a=44100:t>=32e3?a=32e3:t>=24e3?a=24e3:t>=22050?a=22050:t>=16e3?a=16e3:t>=12e3?a=12e3:t>=11025?a=11025:t>=8e3&&(a=8e3),-1==e?a:(e<=15960&&(a=44100),e<=15250&&(a=32e3),e<=11220&&(a=24e3),e<=9970&&(a=22050),e<=7230&&(a=16e3),e<=5420&&(a=12e3),e<=4510&&(a=11025),e<=3970&&(a=8e3),t<a?t>44100?48e3:t>32e3?44100:t>24e3?32e3:t>22050?24e3:t>16e3?22050:t>12e3?16e3:t>11025?12e3:t>8e3?11025:8e3:a)}(0|e.lowpassfreq,e.in_samplerate)),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==i.vbr_off&&(e.compression_ratio=16*e.out_samplerate*a.channels_out/(1e3*e.brate)),e.VBR==i.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*a.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,a.findPeakSample=!1),a.findReplayGain=e.findReplayGain,a.decode_on_the_fly=e.decode_on_the_fly,a.decode_on_the_fly&&(a.findPeakSample=!0),a.findReplayGain&&t.InitGainAnalysis(a.rgdata,e.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(a.decode_on_the_fly&&!e.decode_only&&(null!=a.hip&&B.hip_decode_exit(a.hip),a.hip=B.hip_decode_init()),a.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*a.mode_gr,e.encoder_delay=v.ENCDELAY,a.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case i.vbr_mt:case i.vbr_rh:case i.vbr_mtrh:e.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][e.VBR_q];break;case i.vbr_abr:e.compression_ratio=16*e.out_samplerate*a.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*a.channels_out/(1e3*e.brate)}if(e.mode==E.NOT_SET&&(e.mode=E.JOINT_STEREO),e.highpassfreq>0?(a.highpass1=2*e.highpassfreq,e.highpasswidth>=0?a.highpass2=2*(e.highpassfreq+e.highpasswidth):a.highpass2=2*e.highpassfreq,a.highpass1/=e.out_samplerate,a.highpass2/=e.out_samplerate):(a.highpass1=0,a.highpass2=0),e.lowpassfreq>0?(a.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?(a.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),a.lowpass1<0&&(a.lowpass1=0)):a.lowpass1=2*e.lowpassfreq,a.lowpass1/=e.out_samplerate,a.lowpass2/=e.out_samplerate):(a.lowpass1=0,a.lowpass2=0),function(e){var t=e.internal_flags,a=32,n=-1;if(t.lowpass1>0){for(var i=999,o=0;o<=31;o++)(u=o/31)>=t.lowpass2&&(a=Math.min(a,o)),t.lowpass1<u&&u<t.lowpass2&&(i=Math.min(i,o));t.lowpass1=999==i?(a-.75)/31:(i-.75)/31,t.lowpass2=a/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,r.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var s=-1;for(o=0;o<=31;o++)(u=o/31)<=t.highpass1&&(n=Math.max(n,o)),t.highpass1<u&&u<t.highpass2&&(s=Math.max(s,o));t.highpass1=n/31,t.highpass2=-1==s?(n+.75)/31:(s+.75)/31}for(o=0;o<32;o++){var l,c,u=o/31;l=t.highpass2>t.highpass1?L((t.highpass2-u)/(t.highpass2-t.highpass1+1e-20)):1,c=t.lowpass2>t.lowpass1?L((u-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[o]=l*c}}(e),a.samplerate_index=C(e.out_samplerate,e),a.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==i.vbr_off){if(e.free_format)a.bitrate_index=0;else if(e.brate=D(e.brate,e.version,e.out_samplerate),a.bitrate_index=N(e.brate,e.version,e.out_samplerate),a.bitrate_index<=0)return e.internal_flags=null,-1}else a.bitrate_index=1;e.analysis&&(e.bWriteVbrTag=!1),null!=a.pinfo&&(e.bWriteVbrTag=!1),n.init_bit_stream_w(a);for(var F,U=a.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),V=0;V<v.SBMAX_l+1;V++)a.scalefac_band.l[V]=y.sfBandIndex[U].l[V];for(V=0;V<v.PSFB21+1;V++){var H=(a.scalefac_band.l[22]-a.scalefac_band.l[21])/v.PSFB21,q=a.scalefac_band.l[21]+V*H;a.scalefac_band.psfb21[V]=q}a.scalefac_band.psfb21[v.PSFB21]=576;for(V=0;V<v.SBMAX_s+1;V++)a.scalefac_band.s[V]=y.sfBandIndex[U].s[V];for(V=0;V<v.PSFB12+1;V++){H=(a.scalefac_band.s[13]-a.scalefac_band.s[12])/v.PSFB12,q=a.scalefac_band.s[12]+V*H;a.scalefac_band.psfb12[V]=q}for(a.scalefac_band.psfb12[v.PSFB12]=192,1==e.version?a.sideinfo_len=1==a.channels_out?21:36:a.sideinfo_len=1==a.channels_out?13:21,e.error_protection&&(a.sideinfo_len+=2),function(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&T.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=l([16,5]),t.bitrate_blockType_Hist=l([16,6]),t.PeakSample=0,e.bWriteVbrTag&&x.InitVbrTag(e)}(e),a.Class_ID=I,F=0;F<19;F++)a.nsPsy.pefirbuf[F]=700*a.mode_gr*a.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),u(e.VBR_q<=9),u(e.VBR_q>=0),e.VBR){case i.vbr_mt:e.VBR=i.vbr_mtrh;case i.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),S.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),a.PSY.mask_adjust=e.maskingadjust,a.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?a.sfb21_extra=!1:a.sfb21_extra=e.out_samplerate>44e3,a.iteration_loop=new VBRNewIterationLoop(w);break;case i.vbr_rh:S.apply_preset(e,500-10*e.VBR_q,0),a.PSY.mask_adjust=e.maskingadjust,a.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?a.sfb21_extra=!1:a.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),a.iteration_loop=new VBROldIterationLoop(w);break;default:var z;a.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),(z=e.VBR)==i.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),S.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=z,a.PSY.mask_adjust=e.maskingadjust,a.PSY.mask_adjust_short=e.maskingadjust_short,z==i.vbr_off?a.iteration_loop=new p(w):a.iteration_loop=new ABRIterationLoop(w)}if(u(e.scale>=0),e.VBR!=i.vbr_off){if(a.VBR_min_bitrate=1,a.VBR_max_bitrate=14,e.out_samplerate<16e3&&(a.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=D(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),a.VBR_min_bitrate=N(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),a.VBR_min_bitrate<0))return-1;if(0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=D(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),a.VBR_max_bitrate=N(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),a.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=b.bitrate_table[e.version][a.VBR_min_bitrate],e.VBR_max_bitrate_kbps=b.bitrate_table[e.version][a.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(b.bitrate_table[e.version][a.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(b.bitrate_table[e.version][a.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}return e.tune&&(a.PSY.mask_adjust+=e.tune_value_a,a.PSY.mask_adjust_short+=e.tune_value_a),function(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0}}(e),u(e.scale>=0),e.athaa_type<0?a.ATH.useAdjust=3:a.ATH.useAdjust=e.athaa_type,a.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=o.short_block_allowed),e.short_blocks!=o.short_block_allowed||e.mode!=E.JOINT_STEREO&&e.mode!=E.STEREO||(e.short_blocks=o.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=d.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=d.NSATTACKTHRE_S),u(e.scale>=0),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),a.slot_lag=a.frac_SpF=0,e.VBR==i.vbr_off&&(a.slot_lag=a.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),y.iteration_init(e),R.psymodel_init(e),u(e.scale>=0),0},this.lame_encode_flush=function(e,t,a,r){var i,o,s,l,u=e.internal_flags,d=c([2,1152]),_=0,f=u.mf_samples_to_encode-v.POSTDELAY,h=F(e);if(u.mf_samples_to_encode<1)return 0;for(i=0,e.in_samplerate!=e.out_samplerate&&(f+=16*e.out_samplerate/e.in_samplerate),(s=e.framesize-f%e.framesize)<576&&(s+=e.framesize),e.encoder_padding=s,l=(f+s)/e.framesize;l>0&&_>=0;){var m=h-u.mf_size,p=e.frameNum;m*=e.in_samplerate,(m/=e.out_samplerate)>1152&&(m=1152),m<1&&(m=1),o=r-i,0==r&&(o=0),a+=_=this.lame_encode_buffer(e,d[0],d[1],m,t,a,o),i+=_,l-=p!=e.frameNum?1:0}if(u.mf_samples_to_encode=0,_<0)return _;if(o=r-i,0==r&&(o=0),n.flush_bitstream(e),(_=n.copy_buffer(u,t,a,o,1))<0)return _;if(a+=_,o=r-(i+=_),0==r&&(o=0),e.write_id3tag_automatic){if(T.id3tag_write_v1(e),(_=n.copy_buffer(u,t,a,o,0))<0)return _;i+=_}return i},this.lame_encode_buffer=function(e,a,r,i,o,l,c){var d=e.internal_flags,_=[null,null];if(d.Class_ID!=I)return-3;if(0==i)return 0;!function(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=s(t),e.in_buffer_1=s(t),e.in_buffer_nsamples=t)}(d,i),_[0]=d.in_buffer_0,_[1]=d.in_buffer_1;for(var h=0;h<i;h++)_[0][h]=a[h],d.channels_in>1&&(_[1][h]=r[h]);return function(e,a,r,i,o,s,l){var c,d,_,h,m,p=e.internal_flags,b=0,S=[null,null],y=[null,null];if(p.Class_ID!=I)return-3;if(0==i)return 0;if(m=n.copy_buffer(p,o,s,l,0),m<0)return m;if(s+=m,b+=m,y[0]=a,y[1]=r,g.NEQ(e.scale,0)&&g.NEQ(e.scale,1))for(d=0;d<i;++d)y[0][d]*=e.scale,2==p.channels_out&&(y[1][d]*=e.scale);if(g.NEQ(e.scale_left,0)&&g.NEQ(e.scale_left,1))for(d=0;d<i;++d)y[0][d]*=e.scale_left;if(g.NEQ(e.scale_right,0)&&g.NEQ(e.scale_right,1))for(d=0;d<i;++d)y[1][d]*=e.scale_right;if(2==e.num_channels&&1==p.channels_out)for(d=0;d<i;++d)y[0][d]=.5*(y[0][d]+y[1][d]),y[1][d]=0;h=F(e),S[0]=p.mfbuf[0],S[1]=p.mfbuf[1];var w=0;for(;i>0;){var E=[null,null],A=0,x=0;E[0]=y[0],E[1]=y[1];var T=new V;if(X(e,S,E,w,i,T),A=T.n_in,x=T.n_out,p.findReplayGain&&!p.decode_on_the_fly&&t.AnalyzeSamples(p.rgdata,S[0],p.mf_size,S[1],p.mf_size,x,p.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(i-=A,w+=A,p.channels_out,p.mf_size+=x,u(p.mf_size<=f.MFSIZE),p.mf_samples_to_encode<1&&(p.mf_samples_to_encode=v.ENCDELAY+v.POSTDELAY),p.mf_samples_to_encode+=x,p.mf_size>=h){var B=l-b;if(0==l&&(B=0),(c=U(e,S[0],S[1],o,s,B))<0)return c;for(s+=c,b+=c,p.mf_size-=e.framesize,p.mf_samples_to_encode-=e.framesize,_=0;_<p.channels_out;_++)for(d=0;d<p.mf_size;d++)S[_][d]=S[_][d+e.framesize]}}return u(0==i),b}(e,_[0],_[1],i,o,l,c)}}},476:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte),i=n.new_double,o=n.new_float,s=n.new_float_n,l=n.new_int,c=n.new_int_n,u=(n.assert,a(257)),d=a(952),_=a(206),f=a(361),h=a(640),m=a(191),p=a(17);function g(){function e(){this.write_timing=0,this.ptr=0,this.buf=r(40)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=s([2,g.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new u,this.ms_ratio=o(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=l(2),this.CurrentStep=l(2),this.masking_lower=0,this.bv_scf=l(576),this.pseudohalf=l(p.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*g.BPC+1),this.itime=i(2),this.sideinfo_len=0,this.sb_sample=s([2,2,18,m.SBLIMIT]),this.amp_filter=o(32),this.header=new Array(g.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new d,this.minval_l=o(m.CBANDS),this.minval_s=o(m.CBANDS),this.nb_1=s([4,m.CBANDS]),this.nb_2=s([4,m.CBANDS]),this.nb_s1=s([4,m.CBANDS]),this.nb_s2=s([4,m.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=o(4),this.loudness_sq=s([2,2]),this.loudness_sq_save=o(2),this.mld_l=o(m.SBMAX_l),this.mld_s=o(m.SBMAX_s),this.bm_l=l(m.SBMAX_l),this.bo_l=l(m.SBMAX_l),this.bm_s=l(m.SBMAX_s),this.bo_s=l(m.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=c([m.CBANDS,2]),this.s3ind_s=c([m.CBANDS,2]),this.numlines_s=l(m.CBANDS),this.numlines_l=l(m.CBANDS),this.rnumlines_l=o(m.CBANDS),this.mld_cb_l=o(m.CBANDS),this.mld_cb_s=o(m.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=o(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=l(2),this.nsPsy=new _,this.VBR_seek_table=new f,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=c([16,5]),this.bitrate_blockType_Hist=c([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var t=0;t<this.en.length;t++)this.en[t]=new h;for(t=0;t<this.thm.length;t++)this.thm[t]=new h;for(t=0;t<this.header.length;t++)this.header[t]=new e}g.MFSIZE=3456+m.ENCDELAY-m.MDCTDELAY,g.MAX_HEADER_BUF=256,g.MAX_BITS_PER_CHANNEL=4095,g.MAX_BITS_PER_GRANULE=7680,g.BPC=320,e.exports=g},495:(e,t,a)=>{t.TtsEngine=a(938).TtsEngine},554:e=>{e.exports=function(){this.setModules=function(e,t){0}}},555:(e,t,a)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function i(e,t,a){return(t=r(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach(function(t){i(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}a.d(t,{A:()=>s})},568:(e,t,a)=>{var n=a(952),r=a(330),i=(r.System,r.VbrMode),o=r.Float,s=(r.ShortBlock,r.Util),l=(r.Arrays,r.new_array_n,r.new_byte,r.new_double,r.new_float),c=(r.new_float_n,r.new_int),u=(r.new_int_n,r.assert),d=a(191),_=a(134),f=a(476);function h(){var e=a(408),t=null,r=null,m=null;function p(e){return u(0<=e+h.Q_MAX2&&e<h.Q_MAX),w[e+h.Q_MAX2]}this.setModules=function(e,a,n){t=e,r=a,m=n},this.IPOW20=function(e){return u(0<=e&&e<h.Q_MAX),E[e]};var g=2220446049250313e-31,b=h.IXMAX_VAL+2,v=h.Q_MAX,S=h.Q_MAX2;h.LARGE_BITS;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var y=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=y,this.sfBandIndex=[new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var w=l(v+S+1),E=l(v),A=l(b),x=l(b);function T(e,t){var a=m.ATHformula(t,e);return a-=100,a=Math.pow(10,a/10+e.ATHlower)}function B(e){this.s=e}this.adj43=x,this.iteration_init=function(e){var a,n=e.internal_flags,r=n.l3_side;if(0==n.iteration_init_init){for(n.iteration_init_init=1,r.main_data_begin=0,function(e){for(var t=e.internal_flags.ATH.l,a=e.internal_flags.ATH.psfb21,n=e.internal_flags.ATH.s,r=e.internal_flags.ATH.psfb12,i=e.internal_flags,s=e.out_samplerate,l=0;l<d.SBMAX_l;l++){var c=i.scalefac_band.l[l],u=i.scalefac_band.l[l+1];t[l]=o.MAX_VALUE;for(var _=c;_<u;_++){var f=T(e,_*s/1152);t[l]=Math.min(t[l],f)}}for(l=0;l<d.PSFB21;l++)for(c=i.scalefac_band.psfb21[l],u=i.scalefac_band.psfb21[l+1],a[l]=o.MAX_VALUE,_=c;_<u;_++)f=T(e,_*s/1152),a[l]=Math.min(a[l],f);for(l=0;l<d.SBMAX_s;l++){for(c=i.scalefac_band.s[l],u=i.scalefac_band.s[l+1],n[l]=o.MAX_VALUE,_=c;_<u;_++)f=T(e,_*s/384),n[l]=Math.min(n[l],f);n[l]*=i.scalefac_band.s[l+1]-i.scalefac_band.s[l]}for(l=0;l<d.PSFB12;l++){for(c=i.scalefac_band.psfb12[l],u=i.scalefac_band.psfb12[l+1],r[l]=o.MAX_VALUE,_=c;_<u;_++)f=T(e,_*s/384),r[l]=Math.min(r[l],f);r[l]*=i.scalefac_band.s[13]-i.scalefac_band.s[12]}if(e.noATH){for(l=0;l<d.SBMAX_l;l++)t[l]=1e-20;for(l=0;l<d.PSFB21;l++)a[l]=1e-20;for(l=0;l<d.SBMAX_s;l++)n[l]=1e-20;for(l=0;l<d.PSFB12;l++)r[l]=1e-20}i.ATH.floor=10*Math.log10(T(e,-1))}(e),A[0]=0,a=1;a<b;a++)A[a]=Math.pow(a,4/3);for(a=0;a<b-1;a++)x[a]=a+1-Math.pow(.5*(A[a]+A[a+1]),.75);for(x[a]=.5,a=0;a<v;a++)E[a]=Math.pow(2,-.1875*(a-210));for(a=0;a<=v+S;a++)w[a]=Math.pow(2,.25*(a-210-S));var i,s,l,c;for(t.huffman_init(n),(a=e.exp_nspsytune>>2&63)>=32&&(a-=64),i=Math.pow(10,a/4/10),(a=e.exp_nspsytune>>8&63)>=32&&(a-=64),s=Math.pow(10,a/4/10),(a=e.exp_nspsytune>>14&63)>=32&&(a-=64),l=Math.pow(10,a/4/10),(a=e.exp_nspsytune>>20&63)>=32&&(a-=64),c=l*Math.pow(10,a/4/10),a=0;a<d.SBMAX_l;a++){u=a<=6?i:a<=13?s:a<=20?l:c,n.nsPsy.longfact[a]=u}for(a=0;a<d.SBMAX_s;a++){var u;u=a<=5?i:a<=10?s:a<=11?l:c,n.nsPsy.shortfact[a]=u}}},this.on_pe=function(e,t,a,n,i,o){var s,l,d=e.internal_flags,h=0,m=c(2),p=new _(h),g=r.ResvMaxBits(e,n,p,o),b=(h=p.bits)+g;for(b>f.MAX_BITS_PER_GRANULE&&(b=f.MAX_BITS_PER_GRANULE),s=0,l=0;l<d.channels_out;++l)a[l]=Math.min(f.MAX_BITS_PER_CHANNEL,h/d.channels_out),m[l]=0|a[l]*t[i][l]/700-a[l],m[l]>3*n/4&&(m[l]=3*n/4),m[l]<0&&(m[l]=0),m[l]+a[l]>f.MAX_BITS_PER_CHANNEL&&(m[l]=Math.max(0,f.MAX_BITS_PER_CHANNEL-a[l])),s+=m[l];if(s>g)for(l=0;l<d.channels_out;++l)m[l]=g*m[l]/s;for(l=0;l<d.channels_out;++l)a[l]+=m[l],g-=m[l];for(s=0,l=0;l<d.channels_out;++l)s+=a[l];if(s>f.MAX_BITS_PER_GRANULE){var v=0;for(l=0;l<d.channels_out;++l)a[l]*=f.MAX_BITS_PER_GRANULE,a[l]/=s,v+=a[l];u(v<=f.MAX_BITS_PER_GRANULE)}return b},this.reduce_side=function(e,t,a,n){u(n<=f.MAX_BITS_PER_GRANULE),u(e[0]+e[1]<=f.MAX_BITS_PER_GRANULE);var r=.33*(.5-t)/.5;r<0&&(r=0),r>.5&&(r=.5);var i=0|.5*r*(e[0]+e[1]);i>f.MAX_BITS_PER_CHANNEL-e[0]&&(i=f.MAX_BITS_PER_CHANNEL-e[0]),i<0&&(i=0),e[1]>=125&&(e[1]-i>125?(e[0]<a&&(e[0]+=i),e[1]-=i):(e[0]+=e[1]-125,e[1]=125)),(i=e[0]+e[1])>n&&(e[0]=n*e[0]/i,e[1]=n*e[1]/i),u(e[0]<=f.MAX_BITS_PER_CHANNEL),u(e[1]<=f.MAX_BITS_PER_CHANNEL),u(e[0]+e[1]<=f.MAX_BITS_PER_GRANULE)},this.athAdjust=function(e,t,a){var n=90.30873362,r=s.FAST_LOG10_X(t,10),i=e*e,o=0;return r-=a,i>1e-20&&(o=1+s.FAST_LOG10_X(i,10/n)),o<0&&(o=0),r*=o,r+=a+n-94.82444863,Math.pow(10,.1*r)},this.calc_xmin=function(t,a,n,r){var o,s=0,l=t.internal_flags,c=0,u=0,_=l.ATH,f=n.xr,h=t.VBR==i.vbr_mtrh?1:0,m=l.masking_lower;for(t.VBR!=i.vbr_mtrh&&t.VBR!=i.vbr_mt||(m=1),o=0;o<n.psy_lmax;o++){A=(E=t.VBR==i.vbr_rh||t.VBR==i.vbr_mtrh?athAdjust(_.adjust,_.l[o],_.floor):_.adjust*_.l[o])/(S=n.width[o]),x=g,M=S>>1,R=0;do{R+=P=f[c]*f[c],x+=P<A?P:A,R+=k=f[++c]*f[c],x+=k<A?k:A,c++}while(--M>0);if(R>E&&u++,o==d.SBPSY_l)x<(B=E*l.nsPsy.longfact[o])&&(x=B);if(0!=h&&(E=x),!t.ATHonly)if((T=a.en.l[o])>0)B=R*a.thm.l[o]*m/T,0!=h&&(B*=l.nsPsy.longfact[o]),E<B&&(E=B);r[s++]=0!=h?E:E*l.nsPsy.longfact[o]}var p=575;if(n.block_type!=d.SHORT_TYPE)for(var b=576;0!=b--&&e.EQ(f[b],0);)p=b;n.max_nonzero_coeff=p;for(var v=n.sfb_smin;o<n.psymax;v++,o+=3){var S,y,w;for(w=t.VBR==i.vbr_rh||t.VBR==i.vbr_mtrh?athAdjust(_.adjust,_.s[v],_.floor):_.adjust*_.s[v],S=n.width[o],y=0;y<3;y++){var E,A,x,T,B,R=0,M=S>>1;A=w/S,x=g;do{var P,k;R+=P=f[c]*f[c],x+=P<A?P:A,R+=k=f[++c]*f[c],x+=k<A?k:A,c++}while(--M>0);if(R>w&&u++,v==d.SBPSY_s)x<(B=w*l.nsPsy.shortfact[v])&&(x=B);if(E=0!=h?x:w,!t.ATHonly&&!t.ATHshort)if((T=a.en.s[v][y])>0)B=R*a.thm.s[v][y]*m/T,0!=h&&(B*=l.nsPsy.shortfact[v]),E<B&&(E=B);r[s++]=0!=h?E:E*l.nsPsy.shortfact[v]}t.useTemporal&&(r[s-3]>r[s-3+1]&&(r[s-3+1]+=(r[s-3]-r[s-3+1])*l.decay),r[s-3+1]>r[s-3+2]&&(r[s-3+2]+=(r[s-3+1]-r[s-3+2])*l.decay))}return u},this.calc_noise_core=function(e,t,a,n){var r=0,i=t.s,o=e.l3_enc;if(i>e.count1)for(;0!=a--;){c=e.xr[i],i++,r+=c*c,c=e.xr[i],i++,r+=c*c}else if(i>e.big_values){var s=l(2);for(s[0]=0,s[1]=n;0!=a--;){c=Math.abs(e.xr[i])-s[o[i]],i++,r+=c*c,c=Math.abs(e.xr[i])-s[o[i]],i++,r+=c*c}}else for(;0!=a--;){var c;c=Math.abs(e.xr[i])-A[o[i]]*n,i++,r+=c*c,c=Math.abs(e.xr[i])-A[o[i]]*n,i++,r+=c*c}return t.s=i,r},this.calc_noise=function(e,t,a,n,r){var i,o,l=0,c=0,u=0,d=0,_=0,f=-20,h=0,m=e.scalefac,g=0;for(n.over_SSD=0,i=0;i<e.psymax;i++){var b,v=e.global_gain-(m[g++]+(0!=e.preflag?y[i]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[i]],S=0;if(null!=r&&r.step[i]==v)S=r.noise[i],h+=e.width[i],a[l++]=S/t[c++],S=r.noise_log[i];else{var w,E=p(v);if(o=e.width[i]>>1,h+e.width[i]>e.max_nonzero_coeff)o=(w=e.max_nonzero_coeff-h+1)>0?w>>1:0;var A=new B(h);S=this.calc_noise_core(e,A,o,E),h=A.s,null!=r&&(r.step[i]=v,r.noise[i]=S),S=a[l++]=S/t[c++],S=s.FAST_LOG10(Math.max(S,1e-20)),null!=r&&(r.noise_log[i]=S)}if(null!=r&&(r.global_gain=e.global_gain),_+=S,S>0)b=Math.max(0|10*S+.5,1),n.over_SSD+=b*b,u++,d+=S;f=Math.max(f,S)}return n.over_count=u,n.tot_noise=_,n.over_noise=d,n.max_noise=f,u},this.set_pinfo=function(e,t,a,n,r){var i,o,s,c,_,f=e.internal_flags,h=0==t.scalefac_scale?.5:1,m=t.scalefac,p=l(L3Side.SFBMAX),g=l(L3Side.SFBMAX),b=new CalcNoiseResult;calc_xmin(e,a,t,p),calc_noise(t,p,g,b,null);var v=0;for(o=t.sfb_lmax,t.block_type!=d.SHORT_TYPE&&0==t.mixed_block_flag&&(o=22),i=0;i<o;i++){var S=f.scalefac_band.l[i],w=(E=f.scalefac_band.l[i+1])-S;for(c=0;v<E;v++)c+=t.xr[v]*t.xr[v];c/=w,_=1e15,f.pinfo.en[n][r][i]=_*c,f.pinfo.xfsf[n][r][i]=_*p[i]*g[i]/w,a.en.l[i]>0&&!e.ATHonly?c/=a.en.l[i]:c=0,f.pinfo.thr[n][r][i]=_*Math.max(c*a.thm.l[i],f.ATH.l[i]),f.pinfo.LAMEsfb[n][r][i]=0,0!=t.preflag&&i>=11&&(f.pinfo.LAMEsfb[n][r][i]=-h*y[i]),i<d.SBPSY_l&&(u(m[i]>=0),f.pinfo.LAMEsfb[n][r][i]-=h*m[i])}if(t.block_type==d.SHORT_TYPE)for(o=i,i=t.sfb_smin;i<d.SBMAX_s;i++){S=f.scalefac_band.s[i],w=(E=f.scalefac_band.s[i+1])-S;for(var E,A=0;A<3;A++){for(c=0,s=S;s<E;s++)c+=t.xr[v]*t.xr[v],v++;c=Math.max(c/w,1e-20),_=1e15,f.pinfo.en_s[n][r][3*i+A]=_*c,f.pinfo.xfsf_s[n][r][3*i+A]=_*p[o]*g[o]/w,a.en.s[i][A]>0?c/=a.en.s[i][A]:c=0,(e.ATHonly||e.ATHshort)&&(c=0),f.pinfo.thr_s[n][r][3*i+A]=_*Math.max(c*a.thm.s[i][A],f.ATH.s[i]),f.pinfo.LAMEsfb_s[n][r][3*i+A]=-2*t.subblock_gain[A],i<d.SBPSY_s&&(f.pinfo.LAMEsfb_s[n][r][3*i+A]-=h*m[o]),o++}}f.pinfo.LAMEqss[n][r]=t.global_gain,f.pinfo.LAMEmainbits[n][r]=t.part2_3_length+t.part2_length,f.pinfo.LAMEsfbits[n][r]=t.part2_length,f.pinfo.over[n][r]=b.over_count,f.pinfo.max_noise[n][r]=10*b.max_noise,f.pinfo.over_noise[n][r]=10*b.over_noise,f.pinfo.tot_noise[n][r]=10*b.tot_noise,f.pinfo.over_SSD[n][r]=b.over_SSD}}h.Q_MAX=257,h.Q_MAX2=116,h.LARGE_BITS=1e5,h.IXMAX_VAL=8206,e.exports=h},571:function(e,t,a){!function(){var t;e.exports=(t=a(671),function(e){var a=t,n=a.lib,r=n.WordArray,i=n.Hasher,o=a.algo,s=[],l=[];!function(){function t(t){for(var a=e.sqrt(t),n=2;n<=a;n++)if(!(t%n))return!1;return!0}function a(e){return 4294967296*(e-(0|e))|0}for(var n=2,r=0;r<64;)t(n)&&(r<8&&(s[r]=a(e.pow(n,.5))),l[r]=a(e.pow(n,1/3)),r++),n++}();var c=[],u=o.SHA256=i.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var a=this._hash.words,n=a[0],r=a[1],i=a[2],o=a[3],s=a[4],u=a[5],d=a[6],_=a[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var h=c[f-15],m=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,p=c[f-2],g=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;c[f]=m+c[f-7]+g+c[f-16]}var b=n&r^n&i^r&i,v=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),S=_+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&d)+l[f]+c[f];_=d,d=u,u=s,s=o+S|0,o=i,i=r,r=n,n=S+(v+b)|0}a[0]=a[0]+n|0,a[1]=a[1]+r|0,a[2]=a[2]+i|0,a[3]=a[3]+o|0,a[4]=a[4]+s|0,a[5]=a[5]+u|0,a[6]=a[6]+d|0,a[7]=a[7]+_|0},_doFinalize:function(){var t=this._data,a=t.words,n=8*this._nDataBytes,r=8*t.sigBytes;return a[r>>>5]|=128<<24-r%32,a[14+(r+64>>>9<<4)]=e.floor(n/4294967296),a[15+(r+64>>>9<<4)]=n,t.sigBytes=4*a.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});a.SHA256=i._createHelper(u),a.HmacSHA256=i._createHmacHelper(u)}(Math),t.SHA256)}()},583:e=>{e.exports=function(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}},585:(e,t,a)=>{var n=a(693).default;const{ServerVoices:r}=a(173),i="localhost"===location.hostname||"127.0.0.1"===location.hostname?"http://127.0.0.1:5001/ttsreader/us-central1/tts":"https://us-central1-ttsreader.cloudfunctions.net/tts";window.SERVER_TTS_ENDPOINT=i;class o{static getVoices(){return o.voices}static init(e){e&&(o.listener=e),o.listener.onInit(o.voices)}static async bufferNewUtterance(e,t,a,n,r,s,l,c){let u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,_={text:e,voiceURI:t,langBCP47:a,rate:n,id:r,wasPlayed:!1,audio:null,renderStatus:"waiting",onSuccess:l,onError:c};async function f(i,f){await new Promise(e=>setTimeout(e,i)),d<f?(console.log("Retrying to generate audio for ".concat(_.id,", attempt ").concat(d+1)),o.bufferNewUtterance(e,t,a,n,r,s,l,c,u,d+1)):(console.error("Failed to generate audio for ".concat(_.id," after 3 attempts")),o.buffer=o.buffer.filter(e=>e.id!==r),c("Failed buffering ",_.id))}console.log("Buffering: ",_.id),d=d||0,o.buffer=o.buffer.filter(e=>e.id!==r),o.buffer.push(_),console.log("generating audio for: ",_),fetch(i,{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({text:e,lang:a,voice:t,rate:_.rate>=.95?1:_.rate,isTest:Boolean(u)})}).then(e=>e.ok?e.blob():(429===e.status?(o.buffer=o.buffer.filter(e=>e.id!==r),c(429)):f(500,3),Promise.reject())).then(e=>{console.log("Got AUDIO for: ",_.text);const t=URL.createObjectURL(e);_.audio=new Audio(t),_.audio.setAttribute("preload","auto"),_.audio.addEventListener("playing",()=>{console.log(Date.now()%6e4+" Ronen log20250106: audio is actually audible now, after: "+(Date.now()-o.timeStart)+"ms")}),_.blob=e,_.audio.playbackRate=_.rate>=.95?_.rate:1,_.renderStatus="done",_.onSuccess(_);try{for(;o.buffer.length>50&&o.buffer[0].wasPlayed||o.buffer.length>50;)o.buffer.shift()}catch(a){}}).catch(e=>{f(500,3)})}static async generateAudioSync(e,t,a,n,r,o,s,l,c){let u={text:e,voiceURI:t,langBCP47:a,rate:n,id:r,wasPlayed:!1,audio:null};console.log("Generating: ",u.id);let d="48khz_192kbps";c&&c.quality&&(d=c.quality);try{const r=await fetch(i,{method:"POST",headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"},body:JSON.stringify({text:e,lang:a,voice:t,rate:n,quality:d})});if(!r.ok)throw new Error("Server returned status ".concat(r.status));const l=await r.blob();s(URL.createObjectURL(l))}catch(error){return void l(error.message)}}static async speakUtterance(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o.stop();let n=e.id,r=0;for(;!e.audio&&r<1e3;)await new Promise(e=>setTimeout(e,200)),r+=200,e=getUtterance();e.audio?(o.currentAudio=e.audio,o.currentAudio.playbackRate=e.rate>=.95?e.rate:1,o.currentAudio.onended=()=>{console.log(Date.now()%6e4+" Ronen log20250106: audio ended"),e.wasPlayed=!0,t.onDone(n)},o.currentAudio.onerror=()=>{t.onError("Audio playback failed with onerror "+e.audio.length),o.buffer=o.buffer.filter(t=>t.id!==e.id),t.onDone(n)},t.onStart(n),console.log(Date.now()%6e4+" Ronen log20250106: started audio.play()"),o.timeStart=Date.now(),o.currentAudio.play().catch(a=>{t.onError("Audio playback failed with exception: "+a.message),e.wasPlayed=!1,t.onDone(n)})):a?(o.buffer=o.buffer.filter(t=>t.id!==e.id),o.bufferNewUtterance(e.text,e.voiceURI,e.langBCP47,e.rate,e.id,a,e=>{o.speakUtterance(e,{onStart:this.listener.onStart,onDone:this.listener.onDone,onError:this.listener.onError})},e=>{console.error("Error buffering utterance: ",e),this.listener.onError(e)},utt.isTest)):t.onError("Utterance has no audio")}static stop(){console.log("Got stop request, current audio: ",o.currentAudio),o.currentAudio&&(o.currentAudio.pause(),o.currentAudio.currentTime=0),o.buffer&&o.buffer.length>0&&o.buffer.forEach(e=>{e.onSuccess&&(e.onSuccess=()=>{})})}}n(o,"voices",r.voices),n(o,"buffer",[]),n(o,"currentAudio",null),n(o,"listener",{onInit:e=>{console.log("onInit ",e)},onStart:e=>{console.log("onStart ",e)},onDone:e=>{console.log("onDone ",e)},onError:(e,t)=>{console.log("onError ",e,t)},onReady:e=>{console.log("onReady ",e)}}),n(o,"timeStart",Date.now()),e.exports={ServerTts:o}},590:(e,t,a)=>{var n=a(330).assert;e.exports=function(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,a){var r,i=t.internal_flags,o=i.l3_side,s=e.getframebits(t);a.bits=(s-8*i.sideinfo_len)/i.mode_gr;var l=2048*i.mode_gr-8;t.brate>320?r=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(r=11520,t.strict_ISO&&(r=8*int(32e4/(t.out_samplerate/1152)/8+.5))),i.ResvMax=r-s,i.ResvMax>l&&(i.ResvMax=l),(i.ResvMax<0||t.disable_reservoir)&&(i.ResvMax=0);var c=a.bits*i.mode_gr+Math.min(i.ResvSize,i.ResvMax);return c>r&&(c=r),n(0==i.ResvMax%8),n(i.ResvMax>=0),o.resvDrain_pre=0,null!=i.pinfo&&(i.pinfo.mean_bits=a.bits/2,i.pinfo.resvsize=i.ResvSize),c},this.ResvMaxBits=function(e,t,a,n){var r,i=e.internal_flags,o=i.ResvSize,s=i.ResvMax;0!=n&&(o+=t),0!=(1&i.substep_shaping)&&(s*=.9),a.bits=t,10*o>9*s?(r=o-9*s/10,a.bits+=r,i.substep_shaping|=128):(r=0,i.substep_shaping&=127,e.disable_reservoir||0!=(1&i.substep_shaping)||(a.bits-=.1*t));var l=o<6*i.ResvMax/10?o:6*i.ResvMax/10;return(l-=r)<0&&(l=0),l},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var a,r=e.l3_side;e.ResvSize+=t*e.mode_gr;var i=0;r.resvDrain_post=0,r.resvDrain_pre=0,0!=(a=e.ResvSize%8)&&(i+=a),(a=e.ResvSize-i-e.ResvMax)>0&&(n(0==a%8),n(a>=0),i+=a);var o=Math.min(8*r.main_data_begin,i)/8;r.resvDrain_pre+=8*o,i-=8*o,e.ResvSize-=8*o,r.main_data_begin-=o,r.resvDrain_post+=i,e.ResvSize-=i}}},591:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util),i=(n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float),o=(n.new_float_n,n.new_int,n.new_int_n,n.assert,a(191));e.exports=function(){var e=i(o.BLKSIZE),t=i(o.BLKSIZE_s/2),a=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function n(e,t,n){var i,o,s,l=0,c=t+(n<<=1);i=4;do{var u,d,_,f,h,m,p;p=i>>1,m=(h=i<<1)+(f=i),i=h<<1,s=(o=t)+p;do{E=e[o+0]-e[o+f],w=e[o+0]+e[o+f],B=e[o+h]-e[o+m],x=e[o+h]+e[o+m],e[o+h]=w-x,e[o+0]=w+x,e[o+m]=E-B,e[o+f]=E+B,E=e[s+0]-e[s+f],w=e[s+0]+e[s+f],B=r.SQRT2*e[s+m],x=r.SQRT2*e[s+h],e[s+h]=w-x,e[s+0]=w+x,e[s+m]=E-B,e[s+f]=E+B,s+=i,o+=i}while(o<c);for(d=a[l+0],u=a[l+1],_=1;_<p;_++){var g,b;g=1-2*u*u,b=2*u*d,o=t+_,s=t+f-_;do{var v,S,y,w,E,A,x,T,B,R;S=b*e[o+f]-g*e[s+f],v=g*e[o+f]+b*e[s+f],E=e[o+0]-v,w=e[o+0]+v,A=e[s+0]-S,y=e[s+0]+S,S=b*e[o+m]-g*e[s+m],v=g*e[o+m]+b*e[s+m],B=e[o+h]-v,x=e[o+h]+v,R=e[s+h]-S,T=e[s+h]+S,S=u*x-d*R,v=d*x+u*R,e[o+h]=w-v,e[o+0]=w+v,e[s+m]=A-S,e[s+f]=A+S,S=d*T-u*B,v=u*T+d*B,e[s+h]=y-v,e[s+0]=y+v,e[o+m]=E-S,e[o+f]=E+S,s+=i,o+=i}while(o<c);d=(g=d)*a[l+0]-u*a[l+1],u=g*a[l+1]+u*a[l+0]}l+=2}while(i<n)}var s=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,a,r,i,l){for(var c=0;c<3;c++){var u=o.BLKSIZE_s/2,d=65535&192*(c+1),_=o.BLKSIZE_s/8-1;do{var f,h,m,p,g,b=255&s[_<<2];h=(f=t[b]*i[r][l+b+d])-(g=t[127-b]*i[r][l+b+d+128]),f+=g,p=(m=t[b+64]*i[r][l+b+d+64])-(g=t[63-b]*i[r][l+b+d+192]),m+=g,u-=4,a[c][u+0]=f+m,a[c][u+2]=f-m,a[c][u+1]=h+p,a[c][u+3]=h-p,h=(f=t[b+1]*i[r][l+b+d+1])-(g=t[126-b]*i[r][l+b+d+129]),f+=g,p=(m=t[b+65]*i[r][l+b+d+65])-(g=t[62-b]*i[r][l+b+d+193]),m+=g,a[c][u+o.BLKSIZE_s/2+0]=f+m,a[c][u+o.BLKSIZE_s/2+2]=f-m,a[c][u+o.BLKSIZE_s/2+1]=h+p,a[c][u+o.BLKSIZE_s/2+3]=h-p}while(--_>=0);n(a[c],u,o.BLKSIZE_s/2)}},this.fft_long=function(t,a,r,i,l){var c=o.BLKSIZE/8-1,u=o.BLKSIZE/2;do{var d,_,f,h,m,p=255&s[c];_=(d=e[p]*i[r][l+p])-(m=e[p+512]*i[r][l+p+512]),d+=m,h=(f=e[p+256]*i[r][l+p+256])-(m=e[p+768]*i[r][l+p+768]),f+=m,a[(u-=4)+0]=d+f,a[u+2]=d-f,a[u+1]=_+h,a[u+3]=_-h,_=(d=e[p+1]*i[r][l+p+1])-(m=e[p+513]*i[r][l+p+513]),d+=m,h=(f=e[p+257]*i[r][l+p+257])-(m=e[p+769]*i[r][l+p+769]),f+=m,a[u+o.BLKSIZE/2+0]=d+f,a[u+o.BLKSIZE/2+2]=d-f,a[u+o.BLKSIZE/2+1]=_+h,a[u+o.BLKSIZE/2+3]=_-h}while(--c>=0);n(a,u,o.BLKSIZE/2)},this.init_fft=function(a){for(var n=0;n<o.BLKSIZE;n++)e[n]=.42-.5*Math.cos(2*Math.PI*(n+.5)/o.BLKSIZE)+.08*Math.cos(4*Math.PI*(n+.5)/o.BLKSIZE);for(n=0;n<o.BLKSIZE_s/2;n++)t[n]=.5*(1-Math.cos(2*Math.PI*(n+.5)/o.BLKSIZE_s))}}},613:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float),i=(n.new_float_n,n.new_int),o=(n.new_int_n,n.assert),s=a(134),l=a(191),c=a(17),u=a(476);e.exports=function(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,a,n){var d,_=e.internal_flags,f=r(c.SFBMAX),h=r(576),m=i(2),p=0,g=_.l3_side,b=new s(p);this.quantize.rv.ResvFrameBegin(e,b),p=b.bits;for(var v=0;v<_.mode_gr;v++){d=this.quantize.qupvt.on_pe(e,t,m,p,v,v),_.mode_ext==l.MPG_MD_MS_LR&&(this.quantize.ms_convert(_.l3_side,v),this.quantize.qupvt.reduce_side(m,a[v],p,d));for(var S=0;S<_.channels_out;S++){var y,w,E=g.tt[v][S];E.block_type!=l.SHORT_TYPE?(y=0,w=_.PSY.mask_adjust-y):(y=0,w=_.PSY.mask_adjust_short-y),_.masking_lower=Math.pow(10,.1*w),this.quantize.init_outer_loop(_,E),this.quantize.init_xrpow(_,E,h)&&(this.quantize.qupvt.calc_xmin(e,n[v][S],E,f),this.quantize.outer_loop(e,E,f,h,S,m[S])),this.quantize.iteration_finish_one(_,v,S),o(E.part2_3_length<=u.MAX_BITS_PER_CHANNEL),o(E.part2_3_length<=m[S])}}this.quantize.rv.ResvFrameEnd(_,p)}}},640:(e,t,a)=>{var n=a(191),r=a(330),i=r.System,o=(r.VbrMode,r.Float,r.ShortBlock,r.Util,r.Arrays,r.new_array_n,r.new_byte,r.new_double,r.new_float),s=r.new_float_n;r.new_int,r.new_int_n,r.assert;e.exports=function(){this.l=o(n.SBMAX_l),this.s=s([n.SBMAX_s,3]);var e=this;this.assign=function(t){i.arraycopy(t.l,0,e.l,0,n.SBMAX_l);for(var a=0;a<n.SBMAX_s;a++)for(var r=0;r<3;r++)e.s[a][r]=t.s[a][r]}}},671:function(e,t,a){e.exports=function(){var e=e||function(e,t){var n;if("undefined"!==typeof window&&window.crypto&&(n=window.crypto),"undefined"!==typeof self&&self.crypto&&(n=self.crypto),"undefined"!==typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!==typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&"undefined"!==typeof a.g&&a.g.crypto&&(n=a.g.crypto),!n)try{n=a(228)}catch(p){}var r=function(){if(n){if("function"===typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(p){}if("function"===typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(p){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function e(){}return function(t){var a;return e.prototype=t,a=new e,e.prototype=null,a}}(),o={},s=o.lib={},l=s.Base={extend:function(e){var t=i(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=s.WordArray=l.extend({init:function(e,a){e=this.words=e||[],this.sigBytes=a!=t?a:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,a=e.words,n=this.sigBytes,r=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<r;i++){var o=a[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=o<<24-(n+i)%4*8}else for(var s=0;s<r;s+=4)t[n+s>>>2]=a[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,a=this.sigBytes;t[a>>>2]&=4294967295<<32-a%4*8,t.length=e.ceil(a/4)},clone:function(){var e=l.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],a=0;a<e;a+=4)t.push(r());return new c.init(t,e)}}),u=o.enc={},d=u.Hex={stringify:function(e){for(var t=e.words,a=e.sigBytes,n=[],r=0;r<a;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,a=[],n=0;n<t;n+=2)a[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new c.init(a,t/2)}},_=u.Latin1={stringify:function(e){for(var t=e.words,a=e.sigBytes,n=[],r=0;r<a;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,a=[],n=0;n<t;n++)a[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new c.init(a,t)}},f=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(_.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return _.parse(unescape(encodeURIComponent(e)))}},h=s.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var a,n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,s=i/(4*o),l=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,u=e.min(4*l,i);if(l){for(var d=0;d<l;d+=o)this._doProcessBlock(r,d);a=r.splice(0,l),n.sigBytes-=u}return new c.init(a,u)},clone:function(){var e=l.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),m=(s.Hasher=h.extend({cfg:l.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,a){return new e.init(a).finalize(t)}},_createHmacHelper:function(e){return function(t,a){return new m.HMAC.init(e,a).finalize(t)}}}),o.algo={});return o}(Math);return e}()},693:(e,t,a)=>{var n=a(736);e.exports=function(e,t,a){return(t=n(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e},e.exports.__esModule=!0,e.exports.default=e.exports},710:(e,t,a)=>{var n=a(330),r=n.System,i=(n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays);n.new_array_n,n.new_byte,n.new_double,n.new_float,n.new_float_n,n.new_int,n.new_int_n,n.assert;function o(){o.YULE_ORDER,o.MAX_SAMP_FREQ;var e=o.RMS_WINDOW_TIME_NUMERATOR,t=o.RMS_WINDOW_TIME_DENOMINATOR,a=(o.MAX_SAMPLES_PER_WINDOW,[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]]),n=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function s(e,t,a,n,r,i){for(;0!=r--;)a[n]=1e-10+e[t+0]*i[0]-a[n-1]*i[1]+e[t-1]*i[2]-a[n-2]*i[3]+e[t-2]*i[4]-a[n-3]*i[5]+e[t-3]*i[6]-a[n-4]*i[7]+e[t-4]*i[8]-a[n-5]*i[9]+e[t-5]*i[10]-a[n-6]*i[11]+e[t-6]*i[12]-a[n-7]*i[13]+e[t-7]*i[14]-a[n-8]*i[15]+e[t-8]*i[16]-a[n-9]*i[17]+e[t-9]*i[18]-a[n-10]*i[19]+e[t-10]*i[20],++n,++t}function l(e,t,a,n,r,i){for(;0!=r--;)a[n]=e[t+0]*i[0]-a[n-1]*i[1]+e[t-1]*i[2]-a[n-2]*i[3]+e[t-2]*i[4],++n,++t}function c(e){return e*e}this.InitGainAnalysis=function(a,n){return function(a,n){for(var r=0;r<MAX_ORDER;r++)a.linprebuf[r]=a.lstepbuf[r]=a.loutbuf[r]=a.rinprebuf[r]=a.rstepbuf[r]=a.routbuf[r]=0;switch(0|n){case 48e3:a.reqindex=0;break;case 44100:a.reqindex=1;break;case 32e3:a.reqindex=2;break;case 24e3:a.reqindex=3;break;case 22050:a.reqindex=4;break;case 16e3:a.reqindex=5;break;case 12e3:a.reqindex=6;break;case 11025:a.reqindex=7;break;case 8e3:a.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return a.sampleWindow=0|(n*e+t-1)/t,a.lsum=0,a.rsum=0,a.totsamp=0,i.ill(a.A,0),INIT_GAIN_ANALYSIS_OK}(a,n)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(a.linpre=MAX_ORDER,a.rinpre=MAX_ORDER,a.lstep=MAX_ORDER,a.rstep=MAX_ORDER,a.lout=MAX_ORDER,a.rout=MAX_ORDER,i.fill(a.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,i,u,d,_,f){var h,m,p,g,b,v,S;if(0==_)return GAIN_ANALYSIS_OK;switch(S=0,b=_,f){case 1:u=t,d=i;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(_<MAX_ORDER?(r.arraycopy(t,i,e.linprebuf,MAX_ORDER,_),r.arraycopy(u,d,e.rinprebuf,MAX_ORDER,_)):(r.arraycopy(t,i,e.linprebuf,MAX_ORDER,MAX_ORDER),r.arraycopy(u,d,e.rinprebuf,MAX_ORDER,MAX_ORDER));b>0;){v=b>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:b,S<MAX_ORDER?(h=e.linpre+S,m=e.linprebuf,p=e.rinpre+S,g=e.rinprebuf,v>MAX_ORDER-S&&(v=MAX_ORDER-S)):(h=i+S,m=t,p=d+S,g=u),s(m,h,e.lstepbuf,e.lstep+e.totsamp,v,a[e.reqindex]),s(g,p,e.rstepbuf,e.rstep+e.totsamp,v,a[e.reqindex]),l(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,v,n[e.reqindex]),l(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,v,n[e.reqindex]),h=e.lout+e.totsamp,m=e.loutbuf,p=e.rout+e.totsamp,g=e.routbuf;for(var y=v%8;0!=y--;)e.lsum+=c(m[h++]),e.rsum+=c(g[p++]);for(y=v/8;0!=y--;)e.lsum+=c(m[h+0])+c(m[h+1])+c(m[h+2])+c(m[h+3])+c(m[h+4])+c(m[h+5])+c(m[h+6])+c(m[h+7]),h+=8,e.rsum+=c(g[p+0])+c(g[p+1])+c(g[p+2])+c(g[p+3])+c(g[p+4])+c(g[p+5])+c(g[p+6])+c(g[p+7]),p+=8;if(b-=v,S+=v,e.totsamp+=v,e.totsamp==e.sampleWindow){var w=10*o.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),E=w<=0?0:0|w;E>=e.A.length&&(E=e.A.length-1),e.A[E]++,e.lsum=e.rsum=0,r.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),r.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),r.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),r.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return _<MAX_ORDER?(r.arraycopy(e.linprebuf,_,e.linprebuf,0,MAX_ORDER-_),r.arraycopy(e.rinprebuf,_,e.rinprebuf,0,MAX_ORDER-_),r.arraycopy(t,i,e.linprebuf,MAX_ORDER-_,_),r.arraycopy(u,d,e.rinprebuf,MAX_ORDER-_,_)):(r.arraycopy(t,i+_-MAX_ORDER,e.linprebuf,0,MAX_ORDER),r.arraycopy(u,d+_-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=function(e,t){var a,n=0;for(a=0;a<t;a++)n+=e[a];if(0==n)return GAIN_NOT_ENOUGH_SAMPLES;var r=0|Math.ceil(n*(1-.95));for(a=t;a-- >0&&!((r-=e[a])<=0););return 64.82-a/o.STEPS_per_dB}(e.A,e.A.length),a=0;a<e.A.length;a++)e.B[a]+=e.A[a],e.A[a]=0;for(a=0;a<MAX_ORDER;a++)e.linprebuf[a]=e.lstepbuf[a]=e.loutbuf[a]=e.rinprebuf[a]=e.rstepbuf[a]=e.routbuf[a]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}o.STEPS_per_dB=100,o.MAX_dB=120,o.GAIN_NOT_ENOUGH_SAMPLES=-24601,o.GAIN_ANALYSIS_ERROR=0,o.GAIN_ANALYSIS_OK=1,o.INIT_GAIN_ANALYSIS_ERROR=0,o.INIT_GAIN_ANALYSIS_OK=1,o.YULE_ORDER=10,o.MAX_ORDER=o.YULE_ORDER,o.MAX_SAMP_FREQ=48e3,o.RMS_WINDOW_TIME_NUMERATOR=1,o.RMS_WINDOW_TIME_DENOMINATOR=20,o.MAX_SAMPLES_PER_WINDOW=o.MAX_SAMP_FREQ*o.RMS_WINDOW_TIME_NUMERATOR/o.RMS_WINDOW_TIME_DENOMINATOR+1,e.exports=o},736:(e,t,a)=>{var n=a(738).default,r=a(45);e.exports=function(e){var t=r(e,"string");return"symbol"==n(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},738:e=>{function t(a){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},811:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode);n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float,n.new_float_n,n.new_int,n.new_int_n,n.assert;e.exports=function(){var e,t=a(466);function n(e,t,a,n,r,i,o,s,l,c,u,d,_,f,h){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=a,this.expY=n,this.st_lrm=r,this.st_s=i,this.masking_adj=o,this.masking_adj_short=s,this.ath_lower=l,this.ath_curve=c,this.ath_sensitivity=u,this.interch=d,this.safejoint=_,this.sfb21mod=f,this.msfix=h}function i(e,t,a,n,r,i,o,s,l,c,u,d,_,f){this.quant_comp=t,this.quant_comp_s=a,this.safejoint=n,this.nsmsfix=r,this.st_lrm=i,this.st_s=o,this.nsbass=s,this.scale=l,this.masking_adj=c,this.ath_lower=u,this.ath_curve=d,this.interch=_,this.sfscale=f}this.setModules=function(t){e=t};var o=[new n(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new n(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new n(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new n(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new n(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new n(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new n(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new n(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new n(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new n(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new n(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],s=[new n(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new n(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new n(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new n(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new n(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new n(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new n(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new n(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new n(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new n(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new n(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function l(e,t,a){var n=e.VBR==r.vbr_rh?o:s,i=e.VBR_q_frac,l=n[t],c=n[t+1],u=l;l.st_lrm=l.st_lrm+i*(c.st_lrm-l.st_lrm),l.st_s=l.st_s+i*(c.st_s-l.st_s),l.masking_adj=l.masking_adj+i*(c.masking_adj-l.masking_adj),l.masking_adj_short=l.masking_adj_short+i*(c.masking_adj_short-l.masking_adj_short),l.ath_lower=l.ath_lower+i*(c.ath_lower-l.ath_lower),l.ath_curve=l.ath_curve+i*(c.ath_curve-l.ath_curve),l.ath_sensitivity=l.ath_sensitivity+i*(c.ath_sensitivity-l.ath_sensitivity),l.interch=l.interch+i*(c.interch-l.interch),l.msfix=l.msfix+i*(c.msfix-l.msfix),function(e,t){var a=0;0>t&&(a=-1,t=0);9<t&&(a=-1,t=9);e.VBR_q=t,e.VBR_q_frac=0}(e,u.vbr_q),0!=a?e.quant_comp=u.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=u.quant_comp),0!=a?e.quant_comp_short=u.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=u.quant_comp_s),0!=u.expY&&(e.experimentalY=0!=u.expY),0!=a?e.internal_flags.nsPsy.attackthre=u.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=u.st_lrm),0!=a?e.internal_flags.nsPsy.attackthre_s=u.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=u.st_s),0!=a?e.maskingadjust=u.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=u.masking_adj),0!=a?e.maskingadjust_short=u.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=u.masking_adj_short),0!=a?e.ATHlower=-u.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-u.ath_lower/10),0!=a?e.ATHcurve=u.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=u.ath_curve),0!=a?e.athaa_sensitivity=u.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=u.ath_sensitivity),u.interch>0&&(0!=a?e.interChRatio=u.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=u.interch)),u.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|u.safejoint),u.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|u.sfb21mod<<20),0!=a?e.msfix=u.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=u.msfix),0==a&&(e.VBR_q=t,e.VBR_q_frac=i)}var c=[new i(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new i(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new i(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new i(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new i(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new i(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new i(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new i(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new i(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new i(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new i(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new i(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new i(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new i(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new i(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new i(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new i(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function u(t,a,n){var i=a,o=e.nearestBitrateFullIndex(a);if(t.VBR=r.vbr_abr,t.VBR_mean_bitrate_kbps=i,t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,320),t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.brate=t.VBR_mean_bitrate_kbps,t.VBR_mean_bitrate_kbps>320&&(t.disable_reservoir=!0),c[o].safejoint>0&&(t.exp_nspsytune=2|t.exp_nspsytune),c[o].sfscale>0&&(t.internal_flags.noise_shaping=2),Math.abs(c[o].nsbass)>0){var s=int(4*c[o].nsbass);s<0&&(s+=64),t.exp_nspsytune=t.exp_nspsytune|s<<2}return 0!=n?t.quant_comp=c[o].quant_comp:Math.abs(t.quant_comp- -1)>0||(t.quant_comp=c[o].quant_comp),0!=n?t.quant_comp_short=c[o].quant_comp_s:Math.abs(t.quant_comp_short- -1)>0||(t.quant_comp_short=c[o].quant_comp_s),0!=n?t.msfix=c[o].nsmsfix:Math.abs(t.msfix- -1)>0||(t.msfix=c[o].nsmsfix),0!=n?t.internal_flags.nsPsy.attackthre=c[o].st_lrm:Math.abs(t.internal_flags.nsPsy.attackthre- -1)>0||(t.internal_flags.nsPsy.attackthre=c[o].st_lrm),0!=n?t.internal_flags.nsPsy.attackthre_s=c[o].st_s:Math.abs(t.internal_flags.nsPsy.attackthre_s- -1)>0||(t.internal_flags.nsPsy.attackthre_s=c[o].st_s),0!=n?t.scale=c[o].scale:Math.abs(t.scale- -1)>0||(t.scale=c[o].scale),0!=n?t.maskingadjust=c[o].masking_adj:Math.abs(t.maskingadjust-0)>0||(t.maskingadjust=c[o].masking_adj),c[o].masking_adj>0?0!=n?t.maskingadjust_short=.9*c[o].masking_adj:Math.abs(t.maskingadjust_short-0)>0||(t.maskingadjust_short=.9*c[o].masking_adj):0!=n?t.maskingadjust_short=1.1*c[o].masking_adj:Math.abs(t.maskingadjust_short-0)>0||(t.maskingadjust_short=1.1*c[o].masking_adj),0!=n?t.ATHlower=-c[o].ath_lower/10:Math.abs(10*-t.ATHlower-0)>0||(t.ATHlower=-c[o].ath_lower/10),0!=n?t.ATHcurve=c[o].ath_curve:Math.abs(t.ATHcurve- -1)>0||(t.ATHcurve=c[o].ath_curve),0!=n?t.interChRatio=c[o].interch:Math.abs(t.interChRatio- -1)>0||(t.interChRatio=c[o].interch),a}this.apply_preset=function(e,a,n){switch(a){case t.R3MIX:a=t.V3,e.VBR=r.vbr_mtrh;break;case t.MEDIUM:a=t.V4,e.VBR=r.vbr_rh;break;case t.MEDIUM_FAST:a=t.V4,e.VBR=r.vbr_mtrh;break;case t.STANDARD:a=t.V2,e.VBR=r.vbr_rh;break;case t.STANDARD_FAST:a=t.V2,e.VBR=r.vbr_mtrh;break;case t.EXTREME:a=t.V0,e.VBR=r.vbr_rh;break;case t.EXTREME_FAST:a=t.V0,e.VBR=r.vbr_mtrh;break;case t.INSANE:return a=320,e.preset=a,u(e,a,n),e.VBR=r.vbr_off,a}switch(e.preset=a,a){case t.V9:return l(e,9,n),a;case t.V8:return l(e,8,n),a;case t.V7:return l(e,7,n),a;case t.V6:return l(e,6,n),a;case t.V5:return l(e,5,n),a;case t.V4:return l(e,4,n),a;case t.V3:return l(e,3,n),a;case t.V2:return l(e,2,n),a;case t.V1:return l(e,1,n),a;case t.V0:return l(e,0,n),a}return 8<=a&&a<=320?u(e,a,n):(e.preset=0,a)}}},938:(e,t,a)=>{const n=a(571),{ServerTts:r}=a(585);function i(e){return null==e||e.length<2?"":e.toLowerCase().split("-")[0].split("_")[0]}function o(e,t){return i(e)==i(t)}console.log(r),t.TtsEngine={DEFAULT_LANG:"en",voice:{},voices:[],rate:1,utteranceId:0,startedAndNotTerminatedCounter:0,listener:null,utterance:{},_googleBugTimeout:null,_speakTimeout:null,_canceledAtMs:0,_isServerTTS:!1,_defaultListener:{onInit:e=>{console.log("onInit ",e)},onStart:()=>{console.log("onStart")},onDone:()=>{console.log("onDone")},onError:e=>{console.log("onError ",e)},onVoicesChanged:e=>{console.log("onVoicesChanged ",e)}},init:function(e,t,a){a&&(this.isAppPlaying=a),e&&this.setListener(e,t),this._isServerTTS=t||!1,this._populateVoices(t),speechSynthesis.onvoiceschanged=()=>{this._populateVoices(t)}},setListener:function(e,t){this.listener=e||this._defaultListener},removeLocalGoogleVoices:function(){if(this.voicesIncludingGoogle=[...this.voices],this.voices=this.voices.filter(e=>!e.voiceURI.includes("Google ")),this.voice&&!this.voices.includes(this.voice)){let e=this.voice.lang;this.voice=null,this.setBestMatchingVoice(null,null,e)}this.listener.onVoicesChanged(this.voices)},bringBackGoogleVoices:function(){this.voices=[...this.voicesIncludingGoogle],this.voicesIncludingGoogle=null,this.listener.onVoicesChanged(this.voices)},runSilentTest:function(){let e,t=Date.now();const a=new SpeechSynthesisUtterance("hi");a.volume=0;let n=speechSynthesis.getVoices().find(e=>"Google UK English Male"===e.voiceURI);n&&(a.voice=n,a.voiceURI=n.voiceURI,a.lang=n.lang,e=setTimeout(()=>{this.removeLocalGoogleVoices(),window.gtag&&gtag("event","silent_test_failed",{value:"1"})},3e3),a.onstart=()=>{console.log("onstart in "+(Date.now()-t)),clearTimeout(e),window.gtag&&gtag("event","silent_test_success",{value:"1"}),this.voicesIncludingGoogle&&this.bringBackGoogleVoices(),speechSynthesis.cancel()},a.onend=()=>{console.log("onend in "+(Date.now()-t)),window.gtag&&gtag("event","silent_test_success",{value:"1"}),clearTimeout(e)},console.log("calling speak: "+(Date.now()-t)),speechSynthesis.speak(a))},setBestMatchingVoice:function(e,t,a){if(t&&t.startsWith("azure."))return this.voice={voiceURI:t,lang:"en-US",name:t.replace("azure.","az.")},t;if(null==this.voices||0==this.voices.length)return"";if(e&&e.voiceURI||t||a||(this.voice&&this.voice.voiceURI?t=this.voice.voiceURI:a=this.DEFAULT_LANG),e&&(t=e.voiceURI||t),t)for(const n of this.voices)if(n.voiceURI==t)return this.voice=n,n.voiceURI;if(a){if(this.voice&&o(this.voice.lang,a))return this.voice.voiceURI;let e=this.voices.filter(e=>o(e.lang,a));if(e&&e.length>0){if(1==e.length)return this.voice=e[0],this.voice.voiceURI;if(!a.startsWith("en")&&!a.startsWith("es"))return this.voice=e[0],this.voice.voiceURI;{let t,a=-1;for(const n of e){let e=0;n.localService&&(e+=1.5),2==n.lang.length?e+=3:-1!=["en-us","en-uk","en-gb","es-es"].indexOf(n.lang.toLowerCase().replace("_","-"))?e+=4:-1==["en-in"].indexOf(n.lang.toLowerCase().replace("_","-"))&&(e+=2),console.log("score: "+e+" for: ",n),e>a&&(a=e,t=n)}if(t)return this.voice=t,this.voice.voiceURI}}}for(const n of this.voices)if(this.voice=n,n.localService)return n.voiceURI;return this.voice.voiceURI},_populateVoices:function(e){let t=window.speechSynthesis.getVoices();if(t&&!(t.length<1)){if(console.log("populating voices ",e),e){let e=r.getVoices();console.log("additionalVoices: ",e);for(const a of e)t.push(a)}t&&t.length>0&&(this.voices=t.filter(e=>{if(!e.voiceURI.includes("com.apple.eloquence")&&!e.voiceURI.includes("com.apple.speech.synthesis"))return e}),this.setBestMatchingVoice(this.voice,null,null),this.listener&&this.listener.onInit&&this.listener.onInit(this.voices))}},setVoiceByUri:function(e){this.setBestMatchingVoice(null,e,null)},getVoiceURI:function(){return this.voice||this.setBestMatchingVoice(),this.voice?this.voice.voiceURI:""},setRate:function(e){"string"==typeof e&&(e=Number(e)),isNaN(e)||(e<.1&&(e=.1),e>4&&(e=4),this.rate=e)},isInitiated:function(){return null!=this.voices},_runOnWebspeechApiStart:function(e){this.startedAndNotTerminatedCounter++,this._solveChromeBug()},_runOnWebspeechApiEnd:function(e){this.startedAndNotTerminatedCounter>0&&this.startedAndNotTerminatedCounter--,this._clearUtteranceTimeouts()},_runOnWebspeechApiError:function(e){this.startedAndNotTerminatedCounter>0&&this.startedAndNotTerminatedCounter--,this._clearUtteranceTimeouts()},_clearUtteranceTimeouts:function(){null!=this._googleBugTimeout&&(window.clearTimeout(this._googleBugTimeout),this._googleBugTimeout=null)},_solveChromeBug:function(){if(!this.voice)return;if(-1===this.voice.voiceURI.toLowerCase().indexOf("google"))return;this._clearUtteranceTimeouts();let e=this;this._googleBugTimeout=window.setTimeout(function(){window.speechSynthesis.pause(),window.speechSynthesis.resume(),e._solveChromeBug()},1e4)},_prepareTextForSynthesis:function(e){let t=e;return t=t.replace("\xb7",", "),t=t.replace("- ",", "),t.trim(),t},generateAudioSync:function(e,t,a,i,o){let s=""+n(e.text+e.langBCP47+e.voiceURI+e.rate);r.generateAudioSync(e.text,e.voiceURI,e.langBCP47,e.rate,s,t,a,i,o)},speakAndBuffer:function(e,t,a){if(e.voiceURI.startsWith("ttsreaderServer")||e.voiceURI.startsWith("azure")){let i=this._prepareTextForSynthesis(e.text);if(!i)return this.listener.onStart(),void this.listener.onDone();let o=e.rate<.95?e.rate:1,s=""+n(i+e.langBCP47+e.voiceURI+o);const l=r.buffer.find(e=>e.id===s);l&&(l.rate=e.rate),l&&"done"===l.renderStatus?(console.log("Utterance ".concat(s," already in buffer and ready.")),l.wasPlayed=!1,l.onSuccess=()=>{},r.speakUtterance(l,{onStart:this.listener.onStart,onDone:this.listener.onDone,onError:this.listener.onError})):l&&"waiting"===l.renderStatus?(console.log("Utterance ".concat(s," already in buffer and NOT ready.")),l.wasPlayed=!1,l.onSuccess=()=>{console.log("existingUtt ".concat(s," is onSuccess from 'waiting'")),r.speakUtterance(l,{onStart:this.listener.onStart,onDone:this.listener.onDone,onError:this.listener.onError},a)},l.onError=()=>{console.error("Error buffering utterance: ",error),this.listener.onError(error)}):r.bufferNewUtterance(i,e.voiceURI,e.langBCP47,e.rate,s,a,e=>{r.speakUtterance(e,{onStart:this.listener.onStart,onDone:this.listener.onDone,onError:this.listener.onError},a)},e=>{console.error("Error buffering utterance: ",e),this.listener.onError(e)},e.isTest);let c=1,u=!1;for(const e of t)setTimeout(()=>{if(!this.isAppPlaying()||u)return console.log("buffering stopped since app was paused by master"),void(u=!0);console.log("buffering: ",e);let t=this._prepareTextForSynthesis(e.text),i=""+n(t+e.langBCP47+e.voiceURI+(e.rate<.95?e.rate:1)),o=r.buffer.find(e=>e.id===i);o&&"error"!==o.renderStatus||r.bufferNewUtterance(t,e.voiceURI,e.langBCP47,e.rate,i,a,()=>{},e=>{},e.isTest)},500*c),c++}else this.setVoiceByUri(e.voiceURI),e.rate=Math.min(e.rate,2),e.rate=Math.max(e.rate,.5),this.setRate(e.rate),this.speakOut(e.text)},speakOut:function(e){let t=this;if(this.startedAndNotTerminatedCounter>0||window.speechSynthesis.paused||window.speechSynthesis.pending||window.speechSynthesis.speaking)return console.log("tts - ronen1"),this.stop(),void(this._speakTimeout=window.setTimeout(function(){t.speakOut(e)},200));if(!e)return void(this.utterance&&this.utterance.onend());if(e=this._prepareTextForSynthesis(e),!this.isInitiated())return!1;this.utteranceId++;let a=new SpeechSynthesisUtterance;this.utterance=a,a.text=e,null==this.voice&&this.setBestMatchingVoice(null,null,null),this.voice&&(a.lang=this.voice.lang,a.voiceURI=this.voice.voiceURI,a.voice=this.voice),a.rate=this.rate;let n=this;a.onmark=function(e){console.log("onmark ",e)},a.onstart=function(e){var t;(a.voice.voiceURI.toLowerCase().includes("google")||null!==(t=a.voiceURI)&&void 0!==t&&null!==(t=t.toLowerCase())&&void 0!==t&&t.includes("google"))&&(console.log("voice URI includes google - do reset"),n.removeLocalGoogleVoices=function(){console.log("removeLocalGoogleVoices reset")}),console.log("onstart ",e),n._runOnWebspeechApiStart(e),n.listener&&n.listener.onStart&&n.listener.onStart()},a.onboundary=function(e){console.log("onboundary: "+e.name+" boundary reached after "+e.elapsedTime+" milliseconds.",e)},a.onend=function(e){n._runOnWebspeechApiEnd(e),n.listener&&n.listener.onDone&&n.listener.onDone(),a=null},a.onerror=function(e){n._runOnWebspeechApiError(e),a=null},console.log("tts - ronen right away"),this._speakUtterance(a)},stop(){r.stop(),null!=this._speakTimeout&&(window.clearTimeout(this._speakTimeout),this._speakTimeout=null),window.speechSynthesis.cancel(),this.startedAndNotTerminatedCounter=0,this._canceledAtMs=Date.now()},_speakUtterance(e){null!=this._speakTimeout&&(window.clearTimeout(this._speakTimeout),this._speakTimeout=null),window.speechSynthesis.paused&&window.speechSynthesis.resume(),Date.now()-this._canceledAtMs>100?window.speechSynthesis.speak(e):this._speakTimeout=window.setTimeout(function(){window.speechSynthesis.speak(e)},200)}}},952:(e,t,a)=>{var n=a(330),r=n.System,i=(n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float,n.new_float_n,n.new_int),o=(n.new_int_n,n.assert,a(191));e.exports=function(e,t,a,n){this.l=i(1+o.SBMAX_l),this.s=i(1+o.SBMAX_s),this.psfb21=i(1+o.PSFB21),this.psfb12=i(1+o.PSFB12);var s=this.l,l=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],r.arraycopy(this.arrL,0,s,0,Math.min(this.arrL.length,this.l.length)),r.arraycopy(this.arrS,0,l,0,Math.min(this.arrS.length,this.s.length)),r.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),r.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}},985:(e,t,a)=>{var n=a(330),r=(n.System,n.VbrMode,n.Float,n.ShortBlock,n.Util,n.Arrays,n.new_array_n,n.new_byte,n.new_double,n.new_float),i=(n.new_float_n,n.new_int),o=(n.new_int_n,n.assert,a(17));e.exports=function(){this.xr=r(576),this.l3_enc=i(576),this.scalefac=i(o.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=i(3),this.subblock_gain=i(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=i(o.SFBMAX),this.window=i(o.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=i(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}this.assign=function(a){var n;e.xr=(n=a.xr,new Float32Array(n)),e.l3_enc=t(a.l3_enc),e.scalefac=t(a.scalefac),e.xrpow_max=a.xrpow_max,e.part2_3_length=a.part2_3_length,e.big_values=a.big_values,e.count1=a.count1,e.global_gain=a.global_gain,e.scalefac_compress=a.scalefac_compress,e.block_type=a.block_type,e.mixed_block_flag=a.mixed_block_flag,e.table_select=t(a.table_select),e.subblock_gain=t(a.subblock_gain),e.region0_count=a.region0_count,e.region1_count=a.region1_count,e.preflag=a.preflag,e.scalefac_scale=a.scalefac_scale,e.count1table_select=a.count1table_select,e.part2_length=a.part2_length,e.sfb_lmax=a.sfb_lmax,e.sfb_smin=a.sfb_smin,e.psy_lmax=a.psy_lmax,e.sfbmax=a.sfbmax,e.psymax=a.psymax,e.sfbdivide=a.sfbdivide,e.width=t(a.width),e.window=t(a.window),e.count1bits=a.count1bits,e.sfb_partition_table=a.sfb_partition_table.slice(0),e.slen=t(a.slen),e.max_nonzero_coeff=a.max_nonzero_coeff}}}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,a),i.exports}a.m=e,a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce((t,n)=>(a.f[n](e,t),t),[])),a.u=e=>"static/js/"+e+".bf56afd1.chunk.js",a.miniCssF=e=>{},a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="ttsreader-player:";a.l=(n,r,i,o)=>{if(e[n])e[n].push(r);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+i){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[r];var _=(t,a)=>{s.onerror=s.onload=null,clearTimeout(f);var r=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach(e=>e(a)),t)return t(a)},f=setTimeout(_.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=_.bind(null,s.onerror),s.onload=_.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="./",(()=>{var e={792:0};a.f.j=(t,n)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise((a,n)=>r=e[t]=[a,n]);n.push(r[2]=i);var o=a.p+a.u(t),s=new Error;a.l(o,n=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,r[1](s)}},"chunk-"+t,t)}};var t=(t,n)=>{var r,i,o=n[0],s=n[1],l=n[2],c=0;if(o.some(t=>0!==e[t])){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);if(l)l(a)}for(t&&t(n);c<o.length;c++)i=o[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkttsreader_player=self.webpackChunkttsreader_player||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=a(555);const t={en:{nice_to_meet_you:"Nice to meet you. Did you know most birds can see more colors than humans?",empty_text_read:"Type some text in the text-box, and I will be happy to read it out loud for you. It's also possible to read files, e-books and web pages."},ar:{nice_to_meet_you:"\u0633\u0639\u062f\u062a \u0628\u0644\u0642\u0627\u0626\u0643\u0645. \u0647\u0644 \u0643\u0646\u062a\u0645 \u062a\u0639\u0644\u0645\u0648\u0646 \u0623\u0646 \u0645\u0639\u0638\u0645 \u0627\u0644\u0637\u064a\u0648\u0631 \u062a\u0633\u062a\u0637\u064a\u0639 \u0631\u0624\u064a\u0629 \u0623\u0644\u0648\u0627\u0646 \u0623\u0643\u062b\u0631 \u0645\u0646 \u0627\u0644\u0628\u0634\u0631\u061f",empty_text_read:"\u0627\u0643\u062a\u0628\u0648\u0627 \u0646\u0635\u064b\u0627 \u0641\u064a \u0627\u0644\u0645\u0631\u0628\u0639 \u0648\u0633\u0623\u0643\u0648\u0646 \u0633\u0639\u064a\u062f\u064b\u0627 \u0628\u0642\u0631\u0627\u0621\u062a\u0647 \u0644\u0643\u0645 \u0628\u0635\u0648\u062a \u0639\u0627\u0644\u064d. \u0645\u0646 \u0627\u0644\u0645\u0645\u0643\u0646 \u0623\u064a\u0636\u064b\u0627 \u0642\u0631\u0627\u0621\u0629 \u0627\u0644\u0645\u0644\u0641\u0627\u062a \u0648\u0627\u0644\u0643\u062a\u0628 \u0627\u0644\u0625\u0644\u0643\u062a\u0631\u0648\u0646\u064a\u0629 \u0648\u0635\u0641\u062d\u0627\u062a \u0627\u0644\u0648\u064a\u0628."},de:{nice_to_meet_you:"Sch\xf6n, euch kennenzulernen. Wusstet ihr, dass die meisten V\xf6gel mehr Farben sehen k\xf6nnen als Menschen?",empty_text_read:"Gebt einen Text in das Textfeld ein und ich lese ihn euch gerne laut vor. Es ist auch m\xf6glich, Dateien, E-Books und Webseiten vorzulesen."},es:{nice_to_meet_you:"Encantado de conocerles. \xbfSab\xedan que la mayor\xeda de las aves pueden ver m\xe1s colores que los humanos?",empty_text_read:"Escriban un texto en el cuadro y estar\xe9 encantado de le\xe9rselo en voz alta. Tambi\xe9n es posible leer archivos, libros electr\xf3nicos y p\xe1ginas web."},fr:{nice_to_meet_you:"Ravi de vous rencontrer. Saviez-vous que la plupart des oiseaux peuvent voir plus de couleurs que les humains ?",empty_text_read:"Tapez du texte dans la zone de saisie et je me ferai un plaisir de vous le lire \xe0 voix haute. Il est \xe9galement possible de lire des fichiers, des livres num\xe9riques et des pages web."},he:{nice_to_meet_you:"\u05e0\u05e2\u05d9\u05dd \u05dc\u05d4\u05db\u05d9\u05e8 \u05d0\u05ea\u05db\u05dd. \u05d9\u05d3\u05e2\u05ea\u05dd \u05e9\u05e8\u05d5\u05d1 \u05d4\u05e6\u05d9\u05e4\u05d5\u05e8\u05d9\u05dd \u05e8\u05d5\u05d0\u05d5\u05ea \u05d9\u05d5\u05ea\u05e8 \u05e6\u05d1\u05e2\u05d9\u05dd \u05de\u05d1\u05e0\u05d9 \u05d0\u05d3\u05dd?",empty_text_read:"\u05d4\u05e7\u05dc\u05d9\u05d3\u05d5 \u05d8\u05e7\u05e1\u05d8 \u05d1\u05ea\u05d9\u05d1\u05d4 \u05d5\u05d0\u05e9\u05de\u05d7 \u05dc\u05e7\u05e8\u05d5\u05d0 \u05d0\u05d5\u05ea\u05d5 \u05e2\u05d1\u05d5\u05e8\u05db\u05dd \u05d1\u05e7\u05d5\u05dc. \u05e0\u05d9\u05ea\u05df \u05d2\u05dd \u05dc\u05e7\u05e8\u05d5\u05d0 \u05e7\u05d1\u05e6\u05d9\u05dd, \u05e1\u05e4\u05e8\u05d9\u05dd \u05d3\u05d9\u05d2\u05d9\u05d8\u05dc\u05d9\u05d9\u05dd \u05d5\u05d3\u05e4\u05d9 \u05d0\u05d9\u05e0\u05d8\u05e8\u05e0\u05d8."},hi:{nice_to_meet_you:"\u0906\u092a \u0938\u092d\u0940 \u0938\u0947 \u092e\u093f\u0932\u0915\u0930 \u0916\u0941\u0936\u0940 \u0939\u0941\u0908\u0964 \u0915\u094d\u092f\u093e \u0906\u092a \u091c\u093e\u0928\u0924\u0947 \u0939\u0948\u0902 \u0915\u093f \u0905\u0927\u093f\u0915\u093e\u0902\u0936 \u092a\u0915\u094d\u0937\u0940 \u0907\u0902\u0938\u093e\u0928\u094b\u0902 \u0938\u0947 \u0905\u0927\u093f\u0915 \u0930\u0902\u0917 \u0926\u0947\u0916 \u0938\u0915\u0924\u0947 \u0939\u0948\u0902?",empty_text_read:"\u091f\u0947\u0915\u094d\u0938\u094d\u091f \u092c\u0949\u0915\u094d\u0938 \u092e\u0947\u0902 \u0915\u0941\u091b \u0932\u093f\u0916\u0947\u0902 \u0914\u0930 \u092e\u0948\u0902 \u0909\u0938\u0947 \u091c\u093c\u094b\u0930 \u0938\u0947 \u092a\u0922\u093c\u0915\u0930 \u0938\u0941\u0928\u093e\u090a\u0901\u0917\u093e\u0964 \u092b\u093c\u093e\u0907\u0932\u0947\u0902, \u0908-\u092c\u0941\u0915\u094d\u0938 \u0914\u0930 \u0935\u0947\u092c \u092a\u0947\u091c \u092a\u0922\u093c\u0928\u093e \u092d\u0940 \u0938\u0902\u092d\u0935 \u0939\u0948\u0964"},it:{nice_to_meet_you:"Piacere di conoscervi. Sapevate che la maggior parte degli uccelli pu\xf2 vedere pi\xf9 colori degli esseri umani?",empty_text_read:"Scrivete del testo nella casella e sar\xf2 felice di leggerlo ad alta voce per voi. \xc8 anche possibile leggere file, e-book e pagine web."},ja:{nice_to_meet_you:"\u306f\u3058\u3081\u307e\u3057\u3066\u3002\u307b\u3068\u3093\u3069\u306e\u9ce5\u304c\u4eba\u9593\u3088\u308a\u591a\u304f\u306e\u8272\u3092\u898b\u5206\u3051\u3089\u308c\u308b\u3053\u3068\u3092\u3054\u5b58\u77e5\u3067\u3057\u305f\u304b\uff1f",empty_text_read:"\u30c6\u30ad\u30b9\u30c8\u30dc\u30c3\u30af\u30b9\u306b\u6587\u5b57\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u559c\u3093\u3067\u8aad\u307f\u4e0a\u3052\u307e\u3059\u3002\u30d5\u30a1\u30a4\u30eb\u3084\u96fb\u5b50\u66f8\u7c4d\u3001\u30a6\u30a7\u30d6\u30da\u30fc\u30b8\u3092\u8aad\u307f\u4e0a\u3052\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002"},ko:{nice_to_meet_you:"\ub9cc\ub098\uc11c \ubc18\uac11\uc2b5\ub2c8\ub2e4. \ub300\ubd80\ubd84\uc758 \uc0c8\ub4e4\uc774 \uc778\uac04\ubcf4\ub2e4 \ub354 \ub9ce\uc740 \uc0c9\uc744 \ubcfc \uc218 \uc788\ub2e4\ub294 \uac83\uc744 \uc54c\uace0 \uacc4\uc168\ub098\uc694?",empty_text_read:"\ud14d\uc2a4\ud2b8 \uc0c1\uc790\uc5d0 \ub0b4\uc6a9\uc744 \uc785\ub825\ud574 \uc8fc\uc138\uc694. \uae30\uaebc\uc774 \uc18c\ub9ac \ub0b4\uc5b4 \uc77d\uc5b4\ub4dc\ub9b4\uac8c\uc694. \ud30c\uc77c, \uc804\uc790\ucc45, \uc6f9\ud398\uc774\uc9c0 \uc77d\uae30\ub3c4 \uac00\ub2a5\ud569\ub2c8\ub2e4."},nl:{nice_to_meet_you:"Leuk jullie te ontmoeten. Wisten jullie dat de meeste vogels meer kleuren kunnen zien dan mensen?",empty_text_read:"Typ wat tekst in het tekstvak en ik lees het graag hardop voor. Het is ook mogelijk om bestanden, e-books en webpagina's voor te lezen."},pt:{nice_to_meet_you:"Prazer em conhec\xea-los. Sabiam que a maioria dos p\xe1ssaros consegue ver mais cores do que os humanos?",empty_text_read:"Digite um texto na caixa e terei prazer em l\xea-lo em voz alta. Tamb\xe9m \xe9 poss\xedvel ler arquivos, e-books e p\xe1ginas da web."},ro:{nice_to_meet_you:"\xcenc\xe2ntat(\u0103) de cuno\u0219tin\u021b\u0103. \u0218tia\u021bi c\u0103 majoritatea p\u0103s\u0103rilor pot vedea mai multe culori dec\xe2t oamenii?",empty_text_read:"Scrie\u021bi un text \xeen c\u0103su\u021b\u0103 \u0219i voi fi bucuros(\u0103) s\u0103 vi-l citesc cu voce tare. Este de asemenea posibil s\u0103 citesc fi\u0219iere, c\u0103r\u021bi electronice \u0219i pagini web."},ru:{nice_to_meet_you:"\u0420\u0430\u0434\u044b \u0441 \u0432\u0430\u043c\u0438 \u043f\u043e\u0437\u043d\u0430\u043a\u043e\u043c\u0438\u0442\u044c\u0441\u044f. \u0417\u043d\u0430\u043b\u0438 \u043b\u0438 \u0432\u044b, \u0447\u0442\u043e \u0431\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u043e \u043f\u0442\u0438\u0446 \u0432\u0438\u0434\u044f\u0442 \u0431\u043e\u043b\u044c\u0448\u0435 \u0446\u0432\u0435\u0442\u043e\u0432, \u0447\u0435\u043c \u043b\u044e\u0434\u0438?",empty_text_read:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0432 \u043f\u043e\u043b\u0435, \u0438 \u044f \u0441 \u0440\u0430\u0434\u043e\u0441\u0442\u044c\u044e \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u044e \u0435\u0433\u043e \u0432\u0441\u043b\u0443\u0445. \u0422\u0430\u043a\u0436\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0447\u0442\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432, \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u044b\u0445 \u043a\u043d\u0438\u0433 \u0438 \u0432\u0435\u0431-\u0441\u0442\u0440\u0430\u043d\u0438\u0446."},zh:{nice_to_meet_you:"\u5f88\u9ad8\u5174\u8ba4\u8bc6\u5927\u5bb6\u3002\u4f60\u77e5\u9053\u5927\u591a\u6570\u9e1f\u7c7b\u6bd4\u4eba\u7c7b\u80fd\u770b\u5230\u66f4\u591a\u7684\u989c\u8272\u5417\uff1f",empty_text_read:"\u8bf7\u5728\u6587\u672c\u6846\u4e2d\u8f93\u5165\u5185\u5bb9\uff0c\u6211\u4f1a\u5f88\u4e50\u610f\u4e3a\u4f60\u6717\u8bfb\u3002\u4e5f\u53ef\u4ee5\u6717\u8bfb\u6587\u4ef6\u3001\u7535\u5b50\u4e66\u548c\u7f51\u9875\u3002"}};const n=function(e,a){return e?(a||(a="en"),t[a]||(a=a.toLowerCase().split("-")[0].split("_")[0]),t[a]||(a="en"),t[a][e]||t.en[e]||""):""};var r,i=a(495);class o{static getOs(){if(!window.navigator)return"unknown";let e=(navigator.userAgent+" "+navigator.platform+" "+navigator.userAgentData).toLowerCase();return/android/i.test(e)?"android":/mac/i.test(e)&&"ontouchend"in document||/ipad|iphone|ipod|ios/i.test(e)?"ios":/mac/i.test(e)?"mac":/win/i.test(e)?"win":"unknown"}static isChrome(){try{var e=window.chrome,t=window.navigator,a=t.vendor,n="undefined"!==typeof window.opr,r=t.userAgent.indexOf("Edg")>-1;if(t.userAgent.match("CriOS"));else if(null!==e&&"undefined"!==typeof e&&"Google Inc."===a&&!1===n&&!1===r)return!0}catch(i){}return!1}constructor(t){this.data={},this.listeners=[],this.effects=[],this.get=e=>this.data.hasOwnProperty(e)?this.data[e]:null,this.updateWithParams=t=>{t&&t instanceof Object&&(this.data=(0,e.A)((0,e.A)({},this.data),t));for(const a of this.effects)this.data=(0,e.A)((0,e.A)({},this.data),a(this.data));for(const e of this.listeners)e(this.data)},this.addChangeListener=e=>{e&&e instanceof Function&&(this.listeners.push(e),e(this.data))},this.addEffect=e=>{e&&e instanceof Function&&this.effects.push(e)},this.updateWithParams(t)}}class s{}r=s,s.init=(e,t,a)=>{if(t){let e=["data-ws-onClick","data-ws-onPaste","data-ws-onChange","data-ws-onInput"];for(const a of e){let e=document.querySelectorAll("["+a+"]");e&&e.forEach(e=>{let n=e.getAttribute(a);n&&t[n]instanceof Function&&e.addEventListener(a.substr(10).toLowerCase(),e=>{t[n](e);try{"data-ws-onClick"===a&&window.gtag&&window.gtag instanceof Function&&window.gtag("event","player_dws_"+n,{value:"1"})}catch(r){}})})}}e&&e.addChangeListener&&e.addChangeListener(e=>{console.log("received updated state on dom hooks: ",e),document.querySelectorAll("[data-ws-value-state]").forEach(t=>{let a=t.getAttribute("data-ws-value-state"),n=e[a];null!==n&&void 0!==n&&(t.value=n)}),document.querySelectorAll("[data-ws-label-state]").forEach(t=>{let a=t.getAttribute("data-ws-label-state"),n=e[a];null!==n&&void 0!==n&&(t.innerHTML=n)}),document.querySelectorAll("[data-ws-style-state]").forEach(t=>{let a=t.getAttribute("data-ws-style-state").split("="),n=a[0],r=a[1],i=e[r];null!==i&&void 0!==i&&(t.style[n]=i)}),document.querySelectorAll("[data-ws-show-if-state]").forEach(t=>{let a=t.getAttribute("data-ws-show-if-state");if(a){a=a.split("=");let n=a[0],r=a[1];"false"===r?e[n]?t.classList.add("hidden"):t.classList.remove("hidden"):"true"===r?e[n]?t.classList.remove("hidden"):t.classList.add("hidden"):r===""+e[n]?t.classList.remove("hidden"):t.classList.add("hidden")}}),document.querySelectorAll("[data-ws-select-if-state]").forEach(t=>{let a=t.getAttribute("data-ws-select-if-state");if(a){a=a.split("=");let n=a[0],r=a[1];"false"===r?e[n]?t.removeAttribute("selected"):t.setAttribute("selected",!0):"true"===r?e[n]?t.setAttribute("selected",!0):t.removeAttribute("selected"):r===""+e[n]?t.setAttribute("selected",!0):t.removeAttribute("selected")}})}),document.querySelectorAll("[data-ws-toggle]").forEach(e=>{e.addEventListener("click",t=>{let a=document.querySelector(e.getAttribute("data-ws-toggle"));a&&("none"===getComputedStyle(a).display?a.style.display="":a.style.display="none")})})},s.showModal=e=>{r.closeModals();let t=document.getElementById(e);t&&(t.style.display="")},s.closeModal=e=>{let t=document.getElementById(e);t&&(t.style.display="none")},s.closeModals=()=>{document.querySelectorAll(".Modal").forEach(e=>{e.style.display="none"})};let l={mapLanguageToDefaultLocale:{af:"af-ZA",am:"am-ET",hy:"hy-AM",az:"az-AZ",id:"id-ID",ms:"ms-MY",bn:"bn-BD",ca:"ca-ES",cs:"cs-CZ",da:"da-DK",de:"de-DE",en:"en-US",es:"es-MX",eu:"eu-ES",fil:"fil-PH",fr:"fr-FR",gl:"gl-ES",ka:"ka-GE",gu:"gu-IN",hr:"hr-HR",zu:"zu-ZA",is:"is-IS",it:"it-IT",jv:"jv-ID",kn:"kn-IN",km:"km-KH",lo:"lo-LA",lv:"lv-LV",lt:"lt-LT",hu:"hu-HU",ml:"ml-IN",mr:"mr-IN",nl:"nl-NL",ne:"ne-NP",nb:"nb-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",si:"si-LK",sk:"sk-SK",sl:"sl-SI",su:"su-ID",sw:"sw-TZ",fi:"fi-FI",sv:"sv-SE",ta:"ta-IN",te:"te-IN",vi:"vi-VN",tr:"tr-TR",ur:"ur-IN",el:"el-GR",bg:"bg-BG",ru:"ru-RU",sr:"sr-RS",uk:"uk-UA",he:"he-IL",ar:"ar-EG",fa:"fa-IR",hi:"hi-IN",th:"th-TH",ko:"ko-KR",zh:"zh-CN",ja:"ja-JP"},allLocales:[["Afrikaans (Suid-Afrika)","af-ZA","Afrikaans (South Africa)"],["\u12a0\u121b\u122d\u129b (\u12a2\u1275\u12ee\u1335\u12eb)","am-ET","Amharic (Ethiopia)"],["\u0540\u0561\u0575 (\u0540\u0561\u0575\u0561\u057d\u057f\u0561\u0576)","hy-AM","Armenian (Armenia)"],["Az\u0259rbaycan (Az\u0259rbaycan)","az-AZ","Azerbaijani (Azerbaijan)"],["Bahasa Indonesia (Indonesia)","id-ID","Indonesian (Indonesia)",1],["Bahasa Melayu (Malaysia)","ms-MY","Malay (Malaysia)"],["\u09ac\u09be\u0982\u09b2\u09be (\u09ac\u09be\u0982\u09b2\u09be\u09a6\u09c7\u09b6)","bn-BD","Bengali (Bangladesh)",1],["\u09ac\u09be\u0982\u09b2\u09be (\u09ad\u09be\u09b0\u09a4)","bn-IN","Bengali (India)"],["Catal\xe0 (Espanya)","ca-ES","Catalan (Spain)"],["\u010ce\u0161tina (\u010cesk\xe1 republika)","cs-CZ","Czech (Czech Republic)"],["Dansk (Danmark)","da-DK","Danish (Denmark)"],["Deutsch (Deutschland)","de-DE","German (Germany)"],["English (Australia)","en-AU","English (Australia)"],["English (Canada)","en-CA","English (Canada)"],["English (Ghana)","en-GH","English (Ghana)"],["English (Great Britain)","en-GB","English (United Kingdom)"],["English (India)","en-IN","English (India)"],["English (Ireland)","en-IE","English (Ireland)"],["English (Kenya)","en-KE","English (Kenya)"],["English (New Zealand)","en-NZ","English (New Zealand)"],["English (Nigeria)","en-NG","English (Nigeria)"],["English (Philippines)","en-PH","English (Philippines)"],["English (Singapore)","en-SG","English (Singapore)"],["English (South Africa)","en-ZA","English (South Africa)"],["English (Tanzania)","en-TZ","English (Tanzania)"],["English (United States)","en-US","English (United States)",1],["Espa\xf1ol (Argentina)","es-AR","Spanish (Argentina)"],["Espa\xf1ol (Bolivia)","es-BO","Spanish (Bolivia)"],["Espa\xf1ol (Chile)","es-CL","Spanish (Chile)"],["Espa\xf1ol (Colombia)","es-CO","Spanish (Colombia)"],["Espa\xf1ol (Costa Rica)","es-CR","Spanish (Costa Rica)"],["Espa\xf1ol (Ecuador)","es-EC","Spanish (Ecuador)"],["Espa\xf1ol (El Salvador)","es-SV","Spanish (El Salvador)"],["Espa\xf1ol (Espa\xf1a)","es-ES","Spanish (Spain)",1],["Espa\xf1ol (Estados Unidos)","es-US","Spanish (United States)"],["Espa\xf1ol (Guatemala)","es-GT","Spanish (Guatemala)"],["Espa\xf1ol (Honduras)","es-HN","Spanish (Honduras)"],["Espa\xf1ol (M\xe9xico)","es-MX","Spanish (Mexico)"],["Espa\xf1ol (Nicaragua)","es-NI","Spanish (Nicaragua)"],["Espa\xf1ol (Panam\xe1)","es-PA","Spanish (Panama)"],["Espa\xf1ol (Paraguay)","es-PY","Spanish (Paraguay)"],["Espa\xf1ol (Per\xfa)","es-PE","Spanish (Peru)"],["Espa\xf1ol (Puerto Rico)","es-PR","Spanish (Puerto Rico)"],["Espa\xf1ol (Rep\xfablica Dominicana)","es-DO","Spanish (Dominican Republic)"],["Espa\xf1ol (Uruguay)","es-UY","Spanish (Uruguay)"],["Espa\xf1ol (Venezuela)","es-VE","Spanish (Venezuela)"],["Euskara (Espainia)","eu-ES","Basque (Spain)"],["Filipino (Pilipinas)","fil-PH","Filipino (Philippines)"],["Fran\xe7ais (Canada)","fr-CA","French (Canada)"],["Fran\xe7ais (France)","fr-FR","French (France)",1],["Galego (Espa\xf1a)","gl-ES","Galician (Spain)"],["\u10e5\u10d0\u10e0\u10d7\u10e3\u10da\u10d8 (\u10e1\u10d0\u10e5\u10d0\u10e0\u10d7\u10d5\u10d4\u10da\u10dd)","ka-GE","Georgian (Georgia)"],["\u0a97\u0ac1\u0a9c\u0ab0\u0abe\u0aa4\u0ac0 (\u0aad\u0abe\u0ab0\u0aa4)","gu-IN","Gujarati (India)"],["Hrvatski (Hrvatska)","hr-HR","Croatian (Croatia)"],["IsiZulu (Ningizimu Afrika)","zu-ZA","Zulu (South Africa)"],["\xcdslenska (\xcdsland)","is-IS","Icelandic (Iceland)"],["Italiano (Italia)","it-IT","Italian (Italy)"],["Jawa (Indonesia)","jv-ID","Javanese (Indonesia)"],["\u0c95\u0ca8\u0ccd\u0ca8\u0ca1 (\u0cad\u0cbe\u0cb0\u0ca4)","kn-IN","Kannada (India)"],["\u1797\u17b6\u179f\u17b6\u1781\u17d2\u1798\u17c2\u179a (\u1780\u1798\u17d2\u1796\u17bb\u1787\u17b6)","km-KH","Khmer (Cambodia)"],["\u0ea5\u0eb2\u0ea7 (\u0ea5\u0eb2\u0ea7)","lo-LA","Lao (Laos)"],["Latvie\u0161u (latvie\u0161u)","lv-LV","Latvian (Latvia)"],["Lietuvi\u0173 (Lietuva)","lt-LT","Lithuanian (Lithuania)"],["Magyar (Magyarorsz\xe1g)","hu-HU","Hungarian (Hungary)"],["\u0d2e\u0d32\u0d2f\u0d3e\u0d33\u0d02 (\u0d07\u0d28\u0d4d\u0d24\u0d4d\u0d2f)","ml-IN","Malayalam (India)"],["\u092e\u0930\u093e\u0920\u0940 (\u092d\u093e\u0930\u0924)","mr-IN","Marathi (India)"],["Nederlands (Nederland)","nl-NL","Dutch (Netherlands)"],["\u0928\u0947\u092a\u093e\u0932\u0940 (\u0928\u0947\u092a\u093e\u0932)","ne-NP","Nepali (Nepal)"],["Norsk bokm\xe5l (Norge)","nb-NO","Norwegian Bokm\xe5l (Norway)"],["Polski (Polska)","pl-PL","Polish (Poland)"],["Portugu\xeas (Brasil)","pt-BR","Portuguese (Brazil)",1],["Portugu\xeas (Portugal)","pt-PT","Portuguese (Portugal)"],["Rom\xe2n\u0103 (Rom\xe2nia)","ro-RO","Romanian (Romania)"],["\u0dc3\u0dd2\u0d82\u0dc4\u0dbd (\u0dc1\u0dca\u0dbb\u0dd3 \u0dbd\u0d82\u0d9a\u0dcf\u0dc0)","si-LK","Sinhala (Sri Lanka)"],["Sloven\u010dina (Slovensko)","sk-SK","Slovak (Slovakia)"],["Sloven\u0161\u010dina (Slovenija)","sl-SI","Slovenian (Slovenia)"],["Urang (Indonesia)","su-ID","Sundanese (Indonesia)"],["Swahili (Tanzania)","sw-TZ","Swahili (Tanzania)"],["Swahili (Kenya)","sw-KE","Swahili (Kenya)"],["Suomi (Suomi)","fi-FI","Finnish (Finland)"],["Svenska (Sverige)","sv-SE","Swedish (Sweden)"],["\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe)","ta-IN","Tamil (India)"],["\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd)","ta-SG","Tamil (Singapore)"],["\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8)","ta-LK","Tamil (Sri Lanka)"],["\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0bae\u0bb2\u0bc7\u0b9a\u0bbf\u0baf\u0bbe)","ta-MY","Tamil (Malaysia)"],["\u0c24\u0c46\u0c32\u0c41\u0c17\u0c41 (\u0c2d\u0c3e\u0c30\u0c24\u0c26\u0c47\u0c36\u0c02)","te-IN","Telugu (India)"],["Ti\u1ebfng Vi\u1ec7t (Vi\u1ec7t Nam)","vi-VN","Vietnamese (Vietnam)"],["T\xfcrk\xe7e (T\xfcrkiye)","tr-TR","Turkish (Turkey)"],["\u0627\u0631\u062f\u0648 (\u067e\u0627\u06a9\u0633\u062a\u0627\u0646)","ur-PK","Urdu (Pakistan)"],["\u0627\u0631\u062f\u0648 (\u0628\u06be\u0627\u0631\u062a)","ur-IN","Urdu (India)",1],["\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac (\u0395\u03bb\u03bb\u03ac\u03b4\u03b1)","el-GR","Greek (Greece)"],["\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438 (\u0411\u044a\u043b\u0433\u0430\u0440\u0438\u044f)","bg-BG","Bulgarian (Bulgaria)"],["\u0420\u0443\u0441\u0441\u043a\u0438\u0439 (\u0420\u043e\u0441\u0441\u0438\u044f)","ru-RU","Russian (Russia)"],["\u0421\u0440\u043f\u0441\u043a\u0438 (\u0421\u0440\u0431\u0438\u0458\u0430)","sr-RS","Serbian (Serbia)"],["\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430 (\u0423\u043a\u0440\u0430\u0457\u043d\u0430)","uk-UA","Ukrainian (Ukraine)"],["\u05e2\u05d1\u05e8\u05d9\u05ea (\u05d9\u05e9\u05e8\u05d0\u05dc)","he-IL","Hebrew (Israel)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0625\u0633\u0631\u0627\u0626\u064a\u0644)","ar-IL","Arabic (Israel)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0623\u0631\u062f\u0646)","ar-JO","Arabic (Jordan)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0625\u0645\u0627\u0631\u0627\u062a)","ar-AE","Arabic (United Arab Emirates)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0628\u062d\u0631\u064a\u0646)","ar-BH","Arabic (Bahrain)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u062c\u0632\u0627\u0626\u0631)","ar-DZ","Arabic (Algeria)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629)","ar-SA","Arabic (Saudi Arabia)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0639\u0631\u0627\u0642)","ar-IQ","Arabic (Iraq)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0643\u0648\u064a\u062a)","ar-KW","Arabic (Kuwait)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0645\u063a\u0631\u0628)","ar-MA","Arabic (Morocco)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u062a\u0648\u0646\u0633)","ar-TN","Arabic (Tunisia)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0639\u064f\u0645\u0627\u0646)","ar-OM","Arabic (Oman)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0641\u0644\u0633\u0637\u064a\u0646)","ar-PS","Arabic (State of Palestine)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0642\u0637\u0631)","ar-QA","Arabic (Qatar)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0644\u0628\u0646\u0627\u0646)","ar-LB","Arabic (Lebanon)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0645\u0635\u0631)","ar-EG","Arabic (Egypt)",1],["\u0641\u0627\u0631\u0633\u06cc (\u0627\u06cc\u0631\u0627\u0646)","fa-IR","Persian (Iran)"],["\u0939\u093f\u0928\u094d\u0926\u0940 (\u092d\u093e\u0930\u0924)","hi-IN","Hindi (India)"],["\u0e44\u0e17\u0e22 (\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28\u0e44\u0e17\u0e22)","th-TH","Thai (Thailand)"],["\ud55c\uad6d\uc5b4 (\ub300\ud55c\ubbfc\uad6d)","ko-KR","Korean (South Korea)"],["\u570b\u8a9e (\u53f0\u7063)","zh-TW","Chinese, Mandarin (Traditional, Taiwan)"],["\u5ee3\u6771\u8a71 (\u9999\u6e2f)","yue-Hant-HK","Chinese, Cantonese (Traditional, Hong Kong)"],["\u65e5\u672c\u8a9e\uff08\u65e5\u672c\uff09","ja-JP","Japanese (Japan)"],["\u666e\u901a\u8a71 (\u9999\u6e2f)","zh-HK","Chinese, Mandarin (Simplified, Hong Kong)"],["\u666e\u901a\u8bdd (\u4e2d\u56fd\u5927\u9646)","zh","Chinese, Mandarin (Simplified, China)"]],normalizeCode:function(e){return e?e.toUpperCase().replace(/_/g,"-"):""},areCodesEqual:function(e,t){return e===t||!(!e||!t)&&this.normalizeCode(e)===this.normalizeCode(t)},isLanguageCodeSupported:function(e){return!!this.getLocaleByCode(e)},supportedLanguagesString:function(){let e="";for(let t of this.allLocales)e+=this.codeToLabel(t[1])+"\n";return e},codeToName:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"native";if(!e)return"";let a=e.includes("-")||e.includes("_")?this.allLocales:this.getSupportedLanguagesOnlyList();for(const n of a)if(this.areCodesEqual(n[1],e))switch(t){case"english":return n[2];case"both":return n[0]+" - "+n[2];default:return n[0]}return e.toUpperCase()},getFlagForCountryCode:function(e){if("i18n"==e)return"\ud83c\udf0e";if(null===e||2!==e.length)return e?e.substring(0,3):"";if("IL"===(e=e.toUpperCase()))return"\ud83c\uddee\ud83c\uddf1";if("PS"===e)return"\ud83c\uddf5\ud83c\uddf8";return String.fromCodePoint(e.codePointAt(0)-65+127462)+String.fromCodePoint(e.codePointAt(1)-65+127462)},getBCP47codeFromVoiceUri:function(e){if(!e)return"";let t=e.split("."),a=t[t.length-1],n=a.split("-");return n.length>1?n[0].toLowerCase()+"-"+n[1].toUpperCase():a.toLowerCase()},getBCP47code:function(e,t){if(e=e||"",(t=t||"")&&-1!==t.indexOf("-"))return t;if(l.doCodesShareLanguage(l.getBCP47codeFromVoiceUri(e),t))return l.getBCP47codeFromVoiceUri(e);if("en"===t){if(e.indexOf("en-US")>-1)return"en-US";if(e.indexOf("es-GB")>-1)return"en-GB"}if("es"===t){if(e.indexOf("es-ES")>-1)return"es-ES";if(e.indexOf("es-MX")>-1)return"es-MX";if(e.indexOf("es-US")>-1)return"es-US"}return l.mapLanguageToDefaultLocale[t]||t||""},codeToCountryCode:function(e){if("i18n"===e)return e;if(!e||e.length<2)return"";if((e=e.replace("-","_")).indexOf("_")>-1){let t=e.split("_");e=t[t.length-1]}else if("zh"==(e=e.substring(e.length-2,e.length))||"ZH"==e)return"CN";return e},codeToLanguageCodeOnly:function(e){return null==e||e.length<2?"":e.toLowerCase().replace("_","-").split("-")[0]},doCodesShareLanguage:function(e,t){return this.codeToLanguageCodeOnly(e)==this.codeToLanguageCodeOnly(t)},getLocaleByCode:function(e){if(!e)return"";if(!(e=this.normalizeCode(e)).includes("-"))return this.getDefaultLocaleForLanguage(e);for(let t of this.allLocales)if(this.areCodesEqual(t[1],e))return t;return""},getSupportedLanguagesOnlyList:function(){let e={};for(const a of this.allLocales)e[this.codeToLanguageCodeOnly(a[1])]=[a[0].split(" (")[0],this.codeToLanguageCodeOnly(a[1]),a[2].split(" (")[0]];let t=[];for(const a of Object.getOwnPropertyNames(e))t.push(e[a]);return t=t.sort((e,t)=>e[0].localeCompare(t[0])),t},getAllLocalesForLanguage:function(e){if(!e)return[];return e=this.codeToLanguageOnly(e),this.allLocales.filter(t=>this.codeToLanguageCodeOnly(t[1])==e)},getDefaultLocaleForLanguage:function(e){if(!e)return"";e=this.codeToLanguageOnly(e).toLowerCase();let t=this.allLocales.filter(t=>this.codeToLanguageCodeOnly(t[1])==e);if(!t||0==t.length)return"";if(1==t.length)return t[0];let a=t.filter(e=>e.length>3);return a&&a.length>0?a[0]:t[0]},codeToLanguageOnly:function(e){return e?e.toLowerCase().replace("_","-").split("-")[0]:""},codeToFlag:function(e){return this.getFlagForCountryCode(this.codeToCountryCode(e))},codeToLabel:function(e){return this.codeToFlag(e)+" "+this.codeToName(e)}};const c=l;class u{static getVoiceGender(e,t){let a;if((t.startsWith("en")||t.startsWith("es"))&&(t=t.split("-")[0].split("_")[0]),a=u.malesDescending[t],a&&a.length>0)for(const n of a)if(n.uri===e)return"m";if(a=u.femalesDescending[t],a&&a.length>0)for(const n of a)if(n.uri===e)return"f";return""}static getBestVoices(e,t){if(!e)return[];if(!u.malesDescending[e]||!u.femalesDescending[e])return[];console.log(e,": ",t);let a=u.malesDescending[e].filter(e=>t.includes(e.uri)),n=u.femalesDescending[e].filter(e=>t.includes(e.uri)),r=[],i=0;for(;i<a.length||i<n.length;){if(i<a.length){let e=a[i];e.gender="m",r.push(e)}if(i<n.length){let e=n[i];e.gender="f",r.push(e)}i++}return r}}function d(e,t){if(!e||!t||0==t.length)return[];let a;return"en"===e?a=t.filter(e=>{if(c.areCodesEqual("en-US",e.lang)||c.areCodesEqual("en-GB",e.lang))return e}):"es"===e?a=t.filter(t=>{if(c.doCodesShareLanguage(t.lang,e))return t}):"i18n"===e?a=t.filter(e=>{if(e.voiceURI.toLowerCase().includes("multilingual")||e.voiceURI.toLowerCase().includes("chirp"))return e}):(a=t.filter(t=>{if(2===e.length){if(c.doCodesShareLanguage(t.lang,e))return t}else if(c.areCodesEqual(t.lang,e))return t}),0===a.length&&(a=t.filter(t=>{c.doCodesShareLanguage(t.lang,e)})),0===a.length&&(a=t.filter(e=>{c.doCodesShareLanguage(e.lang,"en")}))),a=a.sort((e,t)=>e.name>t.name?1:-1),a}function _(e){if(!e||!e.voiceURI)return"";if(e.lang&&u.getBestVoices(e.lang,e.voiceURI)&&u.getBestVoices(e.lang,e.voiceURI).length>0)for(const t of u.getBestVoices(e.lang,e.voiceURI))if(t.uri===e.voiceURI)return t.name;if(e.lang&&u.getBestVoices(e.lang.split("-")[0].split("_")[0],e.voiceURI)&&u.getBestVoices(e.lang.split("-")[0].split("_")[0],e.voiceURI).length>0)for(const t of u.getBestVoices(e.lang.split("-")[0].split("_")[0],e.voiceURI))if(t.uri===e.voiceURI)return t.name;return f(e.name,e.lang)}function f(e,t){(e=e||"Voice").toLowerCase().includes("(enhanced)")&&(e=e.replace("(Enhanced)","2")),e.includes("(")&&e.includes(")")&&(e=e.substring(0,e.indexOf("("))),"Google US English"===e&&(e="Female, US *");let a=e.toLowerCase();return(a.includes("google")||a.includes("microsoft"))&&(e=(e=(e=(e=e.replace("Google ","")).replace("Microsoft ","")).replace("Wavenet ","")).replace("Online ","")),(e=(e=(e=(e=e.replace("-","")).replace("English","")).trim())||t)+""}function h(e,t,a){!a||a.includes("-")||e.lang.startsWith(a)||(a=c.mapLanguageToDefaultLocale[a]);let n=a?a.split("-")[1]:null,r=c.codeToFlag(n||e.lang),i=_(e);return i.endsWith(" *")&&i.length>15?i=i.substring(0,10)+"... *":i.length>15&&(i=i.substring(0,10)+"..."),r+" "+i}u.malesDescending={"it-IT":[{uri:"ttsreaderServer.azure.it-IT-MarcelloMultilingualNeural",name:"Marcello Premium"},{uri:"ttsreaderServer.azure.it-IT-AlessioMultilingualNeural",name:"Alessio Premium"}],"hi-IN":[{uri:"ttsreaderServer.azure.hi-IN-ArjunNeural",name:"Arjun Premium"}],"ar-EG":[{uri:"ttsreaderServer.azure.ar-EG-ShakirNeural",name:"Shakir Premium"}],"fr-FR":[{uri:"ttsreaderServer.azure.fr-FR-HenriNeural",name:"Henri Premium"}],"de-DE":[{uri:"ttsreaderServer.azure.de-DE-ConradNeural",name:"Conrad Premium"}],"he-IL":[{uri:"ttsreaderServer.azure.he-IL-AvriNeural",name:"\u05d0\u05d1\u05e8\u05d9"}],es:[{uri:"ttsreaderServer.azure.es-ES-SaulNeural",name:"Saul"},{uri:"ttsreaderServer.azure.es-ES-AlvaroNeural",name:"Alvaro"},{uri:"ttsreaderServer.azure.es-MX-JorgeNeural",name:"Jorge Premium"},{uri:"Google espa\xf1ol",name:"Juan"}],en:[{uri:"ttsreaderServer.gcp.en-US-Chirp-HD-D",name:"John Premium"},{uri:"ttsreaderServer.azure.en-US-DavisMultilingualNeural",name:"Davis Premium"},{uri:"ttsreaderServer.azure.en-US-DerekMultilingualNeural",name:"Derek Premium"},{uri:"ttsreaderServer.azure.en-US-AdamMultilingualNeural",name:"Adam Premium"},{uri:"ttsreaderServer.azure.en-US-ChristopherMultilingualNeural",name:"Christopher Premium"},{uri:"ttsreaderServer.azure.en-GB-OllieMultilingualNeural",name:"Ollie"},{uri:"Microsoft Christopher Online (Natural) - English (United States)",name:"Christopher"},{uri:"Google UK English Male",name:"Noah"},{uri:"Daniel (English (United Kingdom))",name:"Daniel"},{uri:"Microsoft Eric Online (Natural) - English (United States)",name:"Eric"},{uri:"Microsoft Mark - English (United States)",name:"Mark"},{uri:"Microsoft Ryan Online (Natural) - English (United Kingdom)",name:"Ryan"},{uri:"com.apple.voice.compact.en-GB.Daniel",name:"Daniel"},{uri:"ttsreaderServer.gcp.en-GB-Standard-D",name:"Noah Premium"}]},u.femalesDescending={"it-IT":[{uri:"ttsreaderServer.azure.it-IT-IsabellaNeural",name:"Isabella Premium"}],"hi-IN":[{uri:"ttsreaderServer.azure.hi-IN-AartiNeural",name:"Aarti Premium"}],"ar-EG":[{uri:"ttsreaderServer.azure.ar-EG-SalmaNeural",name:"Salma Premium"}],"fr-FR":[{uri:"Google fran\xe7ais",name:"Charlotte"},{uri:"ttsreaderServer.azure.fr-FR-VivienneMultilingualNeural",name:"Vivienne Premium"}],"de-DE":[{uri:"Google Deutsch",name:"Anne"},{uri:"ttsreaderServer.azure.de-DE-SeraphinaMultilingualNeural",name:"Seraphina Premium"}],"he-IL":[{uri:"ttsreaderServer.azure.he-IL-HilaNeural",name:"\u05d4\u05d9\u05dc\u05d4"}],es:[{uri:"ttsreaderServer.azure.es-ES-VeraNeural",name:"Vera"},{uri:"ttsreaderServer.azure.es-ES-ElviraNeural",name:"Elvira"},{uri:"ttsreaderServer.azure.es-MX-DaliaNeural",name:"Dalia Premium"},{uri:"Google espa\xf1ol de Estados Unidos",name:"Isabella"}],en:[{uri:"Microsoft Aria Online (Natural) - English (United States)",name:"Aria"},{uri:"Microsoft Michelle Online (Natural) - English (United States)",name:"Michelle"},{uri:"ttsreaderServer.azure.en-US-NovaTurboMultilingualNeural",name:"Nova Premium"},{uri:"ttsreaderServer.azure.en-US-SerenaMultilingualNeural",name:"Serena Premium"},{uri:"ttsreaderServer.azure.en-US-PhoebeMultilingualNeural",name:"Phoebe Premium"},{uri:"ttsreaderServer.azure.en-US-AvaMultilingualNeural",name:"Ava Premium"},{uri:"ttsreaderServer.azure.en-US-NancyMultilingualNeural",name:"Nancy Premium"},{uri:"ttsreaderServer.azure.en-GB-SoniaNeural",name:"Sonia"},{uri:"ttsreaderServer.azure.en-US-AriaNeural",name:"Aria Premium"},{uri:"ttsreaderServer.azure.en-GB-LibbyNeural",name:"Libby Premium"},{uri:"ttsreaderServer.azure.en-US-ShimmerTurboMultilingualNeural",name:"Shimmer Premium"},{uri:"Microsoft Jenny Online (Natural) - English (United States)",name:"Jenny"},{uri:"ttsreaderServer.azure.en-GB-AdaMultilingualNeural",name:"Ada Premium"},{uri:"ttsreaderServer.azure.en-GB-AbbiNeural",name:"Abbi"},{uri:"Microsoft Libby Online (Natural) - English (United Kingdom)",name:"Libby"},{uri:"Google US English",name:"Olivia"},{uri:"Google UK English Female",name:"Lily"},{uri:"ttsreaderServer.gcp.en-GB-Standard-N",name:"Lilly Premium"},{uri:"ttsreaderServer.gcp.en-GB-Standard-A",name:"Olivia Premium"},{uri:"ttsreaderServer.gcp.en-GB-Wavenet-N",name:"Rebecca Premium"},{uri:"ttsreaderServer.gcp.en-US-Chirp-HD-F",name:"Sarah Premium"},{uri:"ttsreaderServer.gcp.en-US-Chirp-HD-O",name:"Rachel Premium"}]};class m{constructor(e){this.persist=(e,t)=>{null===t||void 0===t?window.localStorage.removeItem(this.preKey+e):(t instanceof Object&&(t=JSON.stringify(t)),window.localStorage.setItem(this.preKey+e,t))},this.get=(e,t)=>{let a=window.localStorage.getItem(this.preKey+e);return null===a||void 0===a?null:(t&&("Object"===t?a=JSON.parse(a):"number"===t?a=parseFloat(a):"bool"===t&&(a="true"===a||!0===a||"1"===a||1===a||"false"!==a&&!1!==a&&"0"!==a&&0!==a&&!!a)),a)},this.remove=e=>{window.localStorage.removeItem(this.preKey+e)},this.preKey=e+"_"}}const p=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],g=[.5,.6,.7,.75,.8,.85,.9,.95,1,1.1,1.2,1.3,1.4,1.5,1.7,2];function b(e){let t=0;if(g[0]==e)return p[0];for(;t<g.length&&g[t+1]<=e;)t++;return p[t]}var v;class S{static endsWithSingleLetterDot(e){const t=e.trim();return/(?:\s|\.)([A-Z])\.$/i.test(t)}static endsWithWholeWord(e,t){const a=e.trim(),n=a.toLowerCase(),r=t.toLowerCase();if(!n.endsWith(r))return!1;const i=a.length-r.length;if(0===i)return!0;const o=a.charAt(i-1);return/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|(?:[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B60\u1B7D-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDEAD\uDED0\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F])/.test(o)}static endsWithAbbreviation(e){for(const t of S.englishAbbreviations)if(S.endsWithWholeWord(e,t))return!0;return!1}static indexOfFirstSentenceEnd(e,t){if(null==e||0==e.length)return 0;if(t=(t||"en").toLowerCase().split("-")[0].split("_")[0],"Segmenter"in Intl){let a=0,n=[...new Intl.Segmenter(t||"en",{granularity:"sentence"}).segment(e)].map(e=>e.segment),r=[],i="";for(let e of n)i+=e,S.endsWithSingleLetterDot(e)||S.endsWithAbbreviation(e)||(r.push(i),i="");i.length>0&&r.push(i);for(let e=0;e<r.length;e++){if(a+=r[e].length,!(a<140&&e<r.length-1&&r[e+1].length+a<this.MAX_SEGMENT_LENGTH))break}if(a>0&&a<this.MAX_SEGMENT_LENGTH)return a}let a=1/0,n="";for(const r of S.SENTENCE_STRONG_ENDS)if(e.includes(r)){let t=e.indexOf(r);t<a&&(a=t,n=r)}if(n)return a+n.length;if(e.length>S.MAX_SEGMENT_LENGTH){e=e.substr(0,S.MAX_SEGMENT_LENGTH);for(const r of S.SENTENCE_SOFT_BREAKS)if(e.includes(r)){let t=e.indexOf(r);t<a&&(a=t,n=r)}if(n)return a+n.length;let t=e.lastIndexOf(" ");if(t>-1)return t+1}return e.length}static findFirstRealPeriod(e){for(var t=0;t<e.length;t++)if("."===e.charAt(t)){if(t<e.length-1&&-1!="0123456789".indexOf(e.charAt(t+1)))continue;if(t>1&&"."==e.charAt(t-2))continue;if(t>2){let a=e.substring(t-2,t).toLowerCase();if("mr"==a||"ms"==a||"dr"==a)continue}if(t<e.length-1&&-1!="   [({])}".indexOf(e.charAt(t+1))||"\n"==e.charAt(t+1))return t}return-1}static getClosestValue(e,t){for(var a=document.getElementById(e),n=null,r=a.options[0].value,i=0;i<a.options.length;i++){var o=a.options[i].value;if(o==t)return t;var s=Math.abs(a.options[i].value-t);(null==n||s<n)&&(n=s,r=o)}return r}static sortList(e){return void 0==e||null==e?e:"[object Array]"===Object.prototype.toString.call(e)?e.sort(function(e,t){var a=e[1].toUpperCase(),n=t[1].toUpperCase();return a<n?-1:a>n?1:0}):void 0}}v=S,S.MAX_SEGMENT_LENGTH=500,S.SENTENCE_STRONG_ENDS=[". ",".[","\n","!","?","   ","\uff1f","\u3002","\u2191","\u2193"],S.SENTENCE_SOFT_BREAKS=[", ",": ","; ","(",")","  ","[","]","{","}"],S.englishAbbreviations=["Mr.","Mrs.","Ms.","Dr.","Prof.","Sr.","Jr.","St.","Mt.","Ave.","Rd.","Blvd.","Ln.","e.g.","i.e.","etc.","vs.","a.m.","p.m.","Jan.","Feb.","Mar.","Apr.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec.","U.S.","U.K.","U.N.","EU.","Inc.","Ltd.","Co.","Corp.","No.","Vol.","Ed.","pp.","Ch."],S.cleanTextPreExport=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(null==e)return"";let t=e.replace(/\{\{skip:[\s\S]*?}}/g," "),a=["*","-","_","[","'",'"',"~",".","}",",",", ",": ","; ","(",")","  ","[","]","}"];a=a.concat(v.SENTENCE_STRONG_ENDS||[]).map(e=>e.trim());return t=t.split("\n").map(e=>{let t=e;for(;t&&a.includes(t.charAt(0));)t=t.substring(1);return t.trim()}).join("\n"),t};class y{static loadFile(e,t){let a=new FileReader;a.onloadend=function(e){t(this.result.trim())},a.readAsText(e)}}const w=[{id:"1-0",boundingBox:{x_min:1,y_max:500,width:480,height:20}},{id:"1-1",boundingBox:{x_min:1,y_max:470,width:480,height:50}},{id:"1-2",boundingBox:{x_min:1,y_max:270,width:230,height:120}},{id:"1-3-1",boundingBox:{x_min:1,y_max:130,width:60,height:100}},{id:"1-3-2",boundingBox:{x_min:70,y_max:130,width:60,height:80}},{id:"1-4",boundingBox:{x_min:250,y_max:270,width:100,height:260}},{id:"1-5",boundingBox:{x_min:1,y_max:3,width:60,height:20}}];function E(e){const{x_min:t,y_max:a,width:n,height:r}=e.boundingBox;return{id:e.id,xmin:t,xmax:t+n,ymin:a-r,ymax:a}}function A(e){e.sort((e,t)=>e[0]-t[0]);const t=[];for(const a of e)!t.length||t[t.length-1][1]<a[0]?t.push([...a]):t[t.length-1][1]=Math.max(t[t.length-1][1],a[1]);return t}function x(e,t){const a=e.map(E).filter(e=>!(e.xmax<t.xmin||e.xmin>t.xmax||e.ymax<t.ymin||e.ymin>t.ymax));if(!a.length)return null;const n=A(a.map(e=>[e.ymin,e.ymax]));if(n.length<=1)return{rows:[{range:n[0]||[t.ymin,t.ymax],cols:[{bounds:t,blocks:a,children:[]}]}]};const r=[];return n.sort((e,t)=>t[1]-e[1]),n.forEach(t=>{let[n,i]=t;const o=a.filter(e=>!(e.ymax<n||e.ymin>i)),s=A(o.map(e=>[e.xmin,e.xmax])).map(t=>{let[a,r]=t;const s={xmin:a,xmax:r,ymin:n,ymax:i},l=o.filter(e=>e.xmin>=a&&e.xmax<=r&&e.ymin>=n&&e.ymax<=i);let c=null;if(l.length>1){const t=A(l.map(e=>[e.ymin,e.ymax])),a=A(l.map(e=>[e.xmin,e.xmax]));(t.length>1||a.length>1)&&(c=x(e,s))}return{bounds:s,blocks:l,children:c?c.rows:[]}});r.push({range:[n,i],cols:s})}),{rows:r}}function T(e){const t=[];return e&&function e(a){a.forEach(a=>{a.cols.sort((e,t)=>e.bounds.xmin-t.bounds.xmin),a.cols.forEach(a=>{a.children.length?e(a.children):a.blocks.sort((e,t)=>e.xmin-t.xmin).forEach(e=>{t.push({id:e.id,boundingBox:{x_min:e.xmin,y_max:e.ymax,width:e.xmax-e.xmin,height:e.ymax-e.ymin}})})})})}(e.rows),t}function B(t,a){let{reassignIds:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!Array.isArray(t)||0===t.length)return t;const r={xmin:Math.min(...t.map(e=>e.boundingBox.x)),xmax:Math.max(...t.map(e=>e.boundingBox.x+e.boundingBox.width)),ymin:Math.min(...t.map(e=>e.boundingBox.y)),ymax:Math.max(...t.map(e=>e.boundingBox.y+e.boundingBox.height))};let i=T(x(t.map((e,t)=>({id:String(t),boundingBox:{x_min:e.boundingBox.x,y_max:e.boundingBox.y+e.boundingBox.height,width:e.boundingBox.width,height:e.boundingBox.height}})),r)).map(e=>t[parseInt(e.id,10)]).filter(Boolean);return n&&(i=i.map((t,n)=>(0,e.A)((0,e.A)({},t),{},{clusterId:"".concat(a,"-").concat(n)}))),console.log("==== FINAL ORDER (page ".concat(a,") ====")),console.log(JSON.stringify(i,null,2)),i}function R(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pdf-visualizer";const a=document.getElementById(t),n=a.clientHeight,r=new Map;let i=0;e.forEach(e=>{const t=function(e){if(!r.has(e)){const t="hsla(".concat(53*i%360,", 70%, 70%, 0.3)");r.set(e,t),i++}return r.get(e)}("".concat(e.fontName,"-").concat(e.height.toFixed(2))),o=document.createElement("div");o.style.position="absolute",o.style.left=e.transform[4]+"px",o.style.top=n-e.transform[5]-e.height+"px",o.style.width=e.width+"px",o.style.height=e.height+"px",o.style.backgroundColor=t,o.style.border="1px solid rgba(0, 0, 0, 0.2)",o.style.pointerEvents="none",o.style.overflow="hidden",o.title='Text: "'.concat(e.str,'"\nFont: ').concat(e.fontName,"\nSize: ").concat(e.height);const s=document.createElement("span");s.style.fontSize=Math.max(6,Math.min(e.height,12))+"px",s.style.whiteSpace="nowrap",s.style.display="block",s.style.color="black",s.style.padding="1px",s.style.lineHeight="1",s.textContent="".concat(e.str),o.appendChild(s),a.appendChild(o)})}function M(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pdf-visualizer",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=document.getElementById(t),r=n.clientHeight;n.querySelectorAll(".cluster-box").forEach(e=>e.remove());let i=null;e.forEach(o=>{const s=o.boundingBox,l=o.clusterId.split("-"),c=parseInt(l[l.length-1],10),u=document.createElement("div");u.className="cluster-box",u.style.position="absolute",u.style.left=s.x+"px",u.style.top=r-s.y-s.height+"px",u.style.width=s.width+"px",u.style.height=s.height+"px",u.style.border="2px solid hsl(".concat(47*c%360,", 80%, 50%)"),u.style.backgroundColor="rgba(255, 255, 255, 0.01)",u.style.pointerEvents="auto",u.style.cursor="grab",u.draggable=!0,u.title="Cluster ".concat(o.clusterId),u.dataset.clusterId=o.clusterId;const d=document.createElement("div");d.textContent="#".concat(o.clusterId),d.style.position="absolute",d.style.top="0",d.style.left="0",d.style.fontSize="10px",d.style.fontWeight="bold",d.style.backgroundColor="rgba(255,255,255,0.7)",d.style.padding="1px 3px",d.style.borderBottom="1px solid #ccc",d.style.borderRight="1px solid #ccc",d.style.color="#333",u.appendChild(d),u.addEventListener("dragstart",e=>{i=o,u.style.opacity="0.5"}),u.addEventListener("dragend",()=>{i=null,u.style.opacity="1"}),u.addEventListener("dragover",e=>{e.preventDefault()}),u.addEventListener("drop",n=>{if(n.preventDefault(),!i||i===o)return;const r=o.clusterId;o.clusterId=i.clusterId,i.clusterId=r,e.sort((e,t)=>parseInt(e.clusterId.split("-")[1],10)-parseInt(t.clusterId.split("-")[1],10)),console.log("clusters we have after sort",e,"page number",t),q(e,t),M(e,t,a),"function"===typeof a&&(a(Z()),console.log("FINISHED PROCESSING"))}),n.appendChild(u)})}!function(){const e=B(T(x(w,{xmin:0,xmax:500,ymin:0,ymax:600})),"demo",{reassignIds:!1});console.log("==== DEMO RESULT (with finalizeReadingOrderForPage) ===="),console.log(JSON.stringify(e,null,2))}();let P=null;function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pdf-visualizer";const a=document.getElementById(t),n=a.clientHeight;let r=0,i=null;function o(t){i&&i.remove();const r=e[t];r&&(i=document.createElement("div"),i.style.position="absolute",i.style.left=r.transform[4]+"px",i.style.top=n-r.transform[5]-r.height+"px",i.style.width=r.width+"px",i.style.height=r.height+"px",i.style.border="2px solid red",i.style.pointerEvents="none",i.style.zIndex="999",a.appendChild(i))}o(r);const s=t=>{"INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName&&("ArrowRight"===t.key?r<e.length-1&&(r++,o(r)):"ArrowLeft"===t.key&&r>0&&(r--,o(r)))};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s),i&&i.remove()}}function I(e){if(!e||0===e.length)return{x:0,y:0,width:0,height:0};let t=1/0,a=-1/0,n=1/0,r=-1/0;return e.forEach(e=>{const i=e.transform[4],o=e.transform[5],s=o+e.height;t=Math.min(t,i),a=Math.max(a,i+e.width),n=Math.min(n,o),r=Math.max(r,s)}),{x:t,y:n,width:a-t,height:r-n}}function L(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;const n=new Map;for(let r=0;r<e.length;r++){n.set(r,[]);const i=e[r],o=i.transform[4],s=i.transform[5]-i.height,l=o+i.width,c=i.transform[5];for(let u=0;u<e.length;u++){if(r===u)continue;const i=e[u],d=i.transform[4],_=i.transform[5]-i.height,f=d+i.width,h=i.transform[5],m=Math.max(0,Math.max(d-l,o-f)),p=Math.max(0,Math.max(_-c,s-h));Math.hypot(m*a,p)<=t&&n.get(r).push(u)}}return n}function C(e){const t=new Set,a=[];for(const n of e.keys()){if(t.has(n))continue;const r=[n],i=[];for(;r.length;){const a=r.pop();if(t.has(a))continue;t.add(a),i.push(a);const n=e.get(a)||[];for(const e of n)t.has(e)||r.push(e)}i.length>0&&a.push(i)}return a}function D(e,t){const a=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x))*Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y)),n=e.width*e.height,r=t.width*t.height;return a/Math.min(n,r)}function N(e){const t=e.textBlocks.map(e=>e.height);return t.length?t[0]:0}function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7;const n=e.textBlocks,r=new Map,i=[];for(const c of n){const e=c.transform[4],a=Math.round(e/t)*t;r.has(a)||r.set(a,[]),r.get(a).push(c),i.push(e)}const o=Array.from(r.entries()).filter(e=>{let[t,n]=e;return n.length>=a}).sort((e,t)=>e[0]-t[0]);if(o.length<2)return[n];const s=o.map(e=>{let[t,a]=e;const n=a.map(e=>e.transform[4]),r=a.map(e=>e.transform[4]+e.width);return[Math.min(...n),Math.max(...r)]});let l=Array.from({length:s.length},()=>[]);for(const c of n){const e=c.transform[4];let t=s.findIndex(t=>{let[a,n]=t;return e>=a&&e<=n});-1===t&&(t=s.length-1),l[t].push(c)}return l=l.filter(e=>e.length>0),l}function F(e,t){return!(e.x+e.width<=t.x||t.x+t.width<=e.x||e.y+e.height<=t.y||t.y+t.height<=e.y)}function U(e){if(!Array.isArray(e)||0===e.length)return{width:0,span:[0,0]};let t=1/0,a=-1/0;for(const n of e){const e=n.transform[4],r=e+n.width;e<t&&(t=e),r>a&&(a=r)}return{midpoint:t+(a-t)/2,span:[t,a]}}function V(e,t){const a=e.boundingBox.y,n=e.boundingBox.y+e.boundingBox.height,r=t.boundingBox.y;return a<t.boundingBox.y+t.boundingBox.height&&n>r}function H(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=e.boundingBox.x+e.boundingBox.width,r=t.boundingBox.x;return r>=n&&r-n<=a}function q(e,t,a){let n=parseInt(t.split("-")[2],10);const r=e.flatMap(e=>e.textBlocks);console.log("All blocks are: ",r),P&&P(),P=k(r,t),function(e,t,a){const n=X.tagMap||z(e);let r="";for(const o of e){var i;const e=Math.round((null===(i=o.textBlocks[0])||void 0===i?void 0:i.height)||0),t=n.get(e)||"p",a=o.textBlocks.map(e=>e.str.trim()).join(" ").replace(/\s+/g," ").trim();r+="<".concat(t,">").concat(a,"</").concat(t,">\n")}X[t].clusters=e,X[t].paragraphs=r,X[t].plainText=function(e){return e.map(e=>e.textBlocks.map(e=>e.str.trim()).join(" ").replace(/\s+/g," ").trim()).join("\n\n").normalize("NFKC")}(e),X[t].textBlocks=a,console.log("latest PDF DATA",X)}(e,n,r),M(e,t,a)}function z(e){const t=new Map;for(const c of e){var a;const e=Math.round((null===(a=c.textBlocks[0])||void 0===a?void 0:a.height)||0);if(e>0){const a=c.textBlocks.reduce((e,t)=>{var a;return e+((null===(a=t.str)||void 0===a?void 0:a.length)||0)},0);t.set(e,(t.get(e)||0)+a)}}if(0===t.size)return new Map;const n=[...t.entries()].sort((e,t)=>t[1]-e[1])[0][0],r=[...t.keys()].sort((e,t)=>t-e),i=new Map;i.set(n,"p");const o=r.filter(e=>e>n);let s=null,l=null;o[0]&&(s=o[0],i.set(s,"h1")),o[1]&&(l=o[1],i.set(l,"h2"));for(const c of r)i.has(c)||(l&&c<l&&c>n?i.set(c,"h3"):i.set(c,"p"));return i}async function G(t,a){return new Promise(n=>{console.log("our page is: ",t);let r=function(e){if(!Array.isArray(e)||0===e.length)return 0;let t=0;for(const a of e)t+=a.height||0;return t/e.length}(t.textBlocks),i=U(t.textBlocks);const o="pdf-page-".concat(t.pageIndex);!function(e){let t=document.getElementById("pdf-visualizer");if(t||(t=document.createElement("div"),t.id="pdf-visualizer",t.style.display="none",document.body.appendChild(t)),!document.getElementById(e)){const a=document.createElement("div");a.id=e,a.style.position="relative",a.style.width="100%",a.style.height="1000px",a.style.borderBottom="1px solid #ccc",t.appendChild(a)}}(o);let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40;const a=new Map;e.forEach(e=>{if(0===e.height)return;const t="".concat(e.fontName,"-").concat(e.height.toFixed(2));a.has(t)||a.set(t,[]),a.get(t).push(e)});let n=0;const r=[];for(const[i,o]of a.entries()){const e=C(L(o,t));for(const t of e){const e=t.map(e=>o[e]);r.push({clusterId:n++,fontKey:i,textBlocks:e,boundingBox:I(e)})}}return console.log("clustering textblocks by font and proximity",r.map(e=>e.clusterId)),r}(t.textBlocks,5*r);s=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{fontSizeTolerance:n=.3,overlapThreshold:r=.9}=a,i=new Array(t.length).fill(!1);for(let e=0;e<t.length;e++){if(i[e])continue;const a=t[e],o=N(a);for(let s=0;s<t.length;s++){if(e===s||i[s])continue;const l=t[s],c=N(l),u=Math.abs(c-o)<=n,d=D(l.boundingBox,a.boundingBox);u&&d>=r&&(a.textBlocks.push(...l.textBlocks),a.boundingBox=I(a.textBlocks),i[s]=!0)}}return t.filter((e,t)=>!i[t]).map((t,a)=>(0,e.A)((0,e.A)({},t),{},{clusterId:a}))}(s,{fontSizeTolerance:.3,overlapThreshold:.8}),s=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{maxBlocks:n=3,maxAvgChars:r=4,maxDistance:i=25,minDominantBlocks:o=4}=a,s=[],l=new Array(t.length).fill(!1);function c(e){let t=e.textBlocks;return t.reduce((e,t)=>e+t.str.length,0)/t.length}function u(e,t){const a=Math.max(0,Math.max(e.x-(t.x+t.width),t.x-(e.x+e.width))),n=Math.max(0,Math.max(e.y-(t.y+t.height),t.y-(e.y+e.height)));return Math.hypot(a,n)}for(let e=0;e<t.length;e++){if(l[e])continue;const a=t[e];if(!(a.textBlocks.length<=n&&c(a)<=r)){s.push(a);continue}let d=!1;for(let n=0;n<t.length;n++){if(e===n||l[n])continue;const r=t[n],s=r.textBlocks.length>=o,c=u(a.boundingBox,r.boundingBox);if(s&&c<=i){r.textBlocks.push(...a.textBlocks),r.boundingBox=I(r.textBlocks),l[e]=!0,d=!0;break}}d||s.push(a)}return s.map((t,a)=>(0,e.A)((0,e.A)({},t),{},{clusterId:a}))}(s,{maxBlocks:9,maxAvgChars:8,maxDistance:20,minDominantBlocks:4});const{refinedClusters:l,singleColumnFlag:c}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;const n=[];let r=!0;for(const i of e){const e=O(i,U(i.textBlocks).midpoint,a,i.clusterId);if(e.length>1&&e.length<=t){r=!1;for(const t of e)n.push({clusterId:n.length,fontKey:i.fontKey,textBlocks:t,boundingBox:I(t)})}else n.push(i)}return{refinedClusters:n,singleColumnFlag:r}}(s);s=l,s=function(e){const t=[];let a=0;for(let n=0;n<e.length;n++){let r=e[n],i=!1;for(let o=0;o<e.length;o++){if(n===o)continue;const s=e[o];if(F(r.boundingBox,s.boundingBox)){const e=r.boundingBox.height>s.boundingBox.height?r:s,n=e===r?s:r,o=n.boundingBox.y+n.boundingBox.height,l=n.boundingBox.y,c=e.textBlocks.filter(e=>e.transform[5]>o),u=e.textBlocks.filter(e=>e.transform[5]+e.height<l),d=e.textBlocks.filter(e=>e.transform[5]<=o&&e.transform[5]+e.height>=l);if(e===r){c.length&&t.push({clusterId:a++,textBlocks:c,boundingBox:I(c)}),u.length&&t.push({clusterId:a++,textBlocks:u,boundingBox:I(u)}),d.length&&t.push({clusterId:a++,textBlocks:d,boundingBox:I(d)}),i=!0;break}}}i||t.push({clusterId:a++,textBlocks:r.textBlocks,boundingBox:r.boundingBox})}return t}(s),s=function(t,a){return[...t].sort((e,t)=>{const a=e.boundingBox.y,n=t.boundingBox.y;return a!==n?n-a:e.boundingBox.x-t.boundingBox.x}).map((t,n)=>(0,e.A)((0,e.A)({},t),{},{clusterId:"".concat(a,"-").concat(n)}))}(s,t.pageIndex),console.log("Cluster Id",s.map(e=>e.clusterId)),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;for(const a of e)a.textBlocks.sort((e,a)=>{const n=e.transform[5],r=a.transform[5];return Math.abs(n-r)<=t?e.transform[4]-a.transform[4]:r-n});return e}(s,r/2);let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;const a=new Set,n=[];for(let r=0;r<e.length;r++){if(a.has(r))continue;const i=[],o=[r];for(a.add(r);o.length>0;){const n=e[o.shift()];i.push(n);for(let r=0;r<e.length;r++){if(a.has(r))continue;const i=e[r];V(n,i)&&(H(n,i,t)||H(i,n,t))&&(a.add(r),o.push(r))}}n.push(i)}return n}(s,i.midpoint);u=function(e,t){for(const a of e){const e=a.filter(e=>e.boundingBox.x<t).sort((e,t)=>t.boundingBox.y-e.boundingBox.y);console.log("left column clusters supercluster",e);const n=a.filter(e=>e.boundingBox.x>=t).sort((e,t)=>t.boundingBox.y-e.boundingBox.y);console.log("right column clusters supercluster",n),a.splice(0,a.length,...e,...n)}return e}(u,i.midpoint),s=function(e,t){const a=[];for(let n=0;n<e.length;n++){const r=e[n];for(let e=0;e<r.length;e++){const n=r[e],i="".concat(t,"-").concat(a.length);n.clusterId=i,a.push(n)}}return console.log("flattened check",a),a}(u,t.pageIndex),s=B(s,t.pageIndex),function(){let e=document.getElementById("pdf-visualizer");e||(e=document.createElement("div"),e.id="pdf-visualizer",e.style.position="relative",e.style.width="100%",e.style.height="100vh",e.style.border="1px solid #ccc",e.style.overflow="hidden",document.body.appendChild(e));let t=document.getElementById("mouse-coords");t||(t=document.createElement("div"),t.id="mouse-coords",t.style.position="fixed",t.style.bottom="10px",t.style.right="10px",t.style.backgroundColor="rgba(0,0,0,0.7)",t.style.color="white",t.style.padding="4px 8px",t.style.borderRadius="4px",t.style.fontFamily="monospace",t.style.zIndex=1e3,t.textContent="X: ---, Y: ---",t.style.display="none",document.body.appendChild(t)),e.addEventListener("mousemove",a=>{const n=e.getBoundingClientRect(),r=a.clientX-n.left,i=n.bottom-a.clientY;t.textContent="X: ".concat(r.toFixed(1),", Y: ").concat(i.toFixed(1))}),e.addEventListener("mouseleave",()=>{t.textContent="X: ---, Y: ---"})}(),R(t.textBlocks,o),P=k(t.textBlocks,o),"undefined"!==typeof X&&X[t.pageIndex]&&q(s,o,a),n()})}let X={},j=null;class W{static async loadPdfFile(e,t,n){j||(j=await a.e(857).then(a.bind(a,857)),j.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/5.3.93/pdf.worker.min.mjs");let r=new FileReader;X={},r.onload=function(){!function(e,t,a){!function(e,t){let a,n={pages:{},lines:[],ps:[],currentPage:1};console.log("ArrayBufferURL"),console.log(e),j.getDocument(e).promise.then(function(e){console.log("ArrayBufferpdf"),console.log(e),a=e.numPages,console.log("PDF loaded with "+a+" pages"),Y(e,n,t)},function(e){console.error(e)})}(e,a)}(this.result,0,function(e){t(e)})},r.readAsArrayBuffer(e)}}function Y(e,t,a){e.getPage(t.currentPage).then(function(n){t.pages[t.currentPage]={lines:[]},n.getTextContent().then(function(n){let r=n.items;if(r.length>0&&(K(r[0],t,!0),r.length>1))for(let e=1;e<r.length;e++)K(r[e],t,!1);var i,o;if(console.log("TextItems ",r),i=r,o=t.currentPage,X[o]={pageIndex:o,textBlocks:i,clusters:null,paragraphs:null,plainText:null},function(e,t){const a=X[e];if(!a)return null;(async()=>{G(a,t)})()}(t.currentPage,a),t.currentPage<e.numPages)t.currentPage++,Y(e,t,a);else{const e=Object.values(X).flatMap(e=>e.clusters||[]);X.tagMap=z(e),a&&(a(Z()),console.log("FINISHED PROCESSING"))}})})}function K(e,t,a){if(null!=e&&void 0!=e){if(0==t.pages[t.currentPage].lines.length||a||!function(e,t){let a=t.transform[5]-t.height,n=t.transform[5];if(a>=e.yBottom&&a<=e.yTop)return!0;if(e.yBottom>=a&&e.yBottom<=n)return!0;return!1}(t.pages[t.currentPage].lines[t.pages[t.currentPage].lines.length-1],e)){let a=function(e,t){return{page:t,str:e.str,height:e.height,yTop:e.transform[5],yBottom:e.transform[5]-e.height,xStart:e.transform[4],xEnd:e.transform[4]+e.width}}(e,t.currentPage);return void t.pages[t.currentPage].lines.push(a)}t.pages[t.currentPage].lines[t.pages[t.currentPage].lines.length-1]=function(e,t){let a="",n=Math.max(t.height,e.height),r=0,i=0;return t.transform[4]>e.xStart?(i=e.xStart,r=t.transform[4]+t.width,a=e.str,e.xEnd+n<t.transform[4]&&(a+=" "),a+=t.str):(i=t.transform[4],r=e.xEnd,a=t.str,t.transform[4]+t.width+n<e.xStart&&(a+=" "),a+=e.str),{page:e.page,str:a,height:n,yTop:Math.max(t.transform[5],e.yTop),yBottom:Math.min(t.transform[5]-t.height,e.yBottom),xStart:i,xEnd:r}}(t.pages[t.currentPage].lines[t.pages[t.currentPage].lines.length-1],e)}}function Z(){if(!X.tagMap)return console.warn("\u26a0\ufe0f No global tagMap found \u2013 falling back to plain text."),function(){let e="";for(const t in X)X.hasOwnProperty(t)&&X[t].plainText&&(e+=X[t].plainText+"\n\n");return e.trim()}();let e="";for(const a in X){if(!X.hasOwnProperty(a))continue;const n=X[a];if(n.clusters)for(const a of n.clusters){var t;const n=Math.round((null===(t=a.textBlocks[0])||void 0===t?void 0:t.height)||0),r=X.tagMap.get(n)||"p",i=a.textBlocks.map(e=>e.str.trim()).join(" ").replace(/\s+/g," ").trim();e+="<".concat(r,">").concat(i,"</").concat(r,">\n")}}return e.trim()}class Q{static fetchJsFile(e,t){let a=document.createElement("script");a.src=e,a.onload=function(){t&&t()},document.getElementsByTagName("head")[0].appendChild(a)}static fetchStyleSheet(e){let t=document.createElement("link");t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}}class J{static loadEpubFile(e,t,a,n){if(!window.ePub)return void Q.fetchJsFile("static/js/zip.min.js",function(){Q.fetchJsFile("https://cdn.jsdelivr.net/epub.js/0.2.15/epub.min.js",function(){J.loadEpubFile(e,t,a,n)})});let r=new FileReader;r.onload=function(a){!function(e,t,a,n){let r=window.ePub({bookPath:e});window.book=r,r.getMetadata().then(function(e){console.log("meta = ",e);let a=e.bookTitle||t;n.persist("bookTitle",a)}),document.querySelector("#area").innerHTML="";let i=0,o="";r.on("book:atEnd",function(){console.log("book:atEnd"),a(n.get($(0)),{node:0,charStart:0,charEnd:0},"html")}),r.on("renderer:locationChanged",function(e){if(console.log("ronen hi"),o!=e){o=e,console.log(e);let t=document.getElementById("area").getElementsByTagName("IFRAME")[0].contentWindow.document.body,a=t.innerText,r=t.outerHTML;console.log(t),a.length>0&&(console.log("chapter text length = "+a.length),n.persist($(i),r),i++,1===i&&n.persist("currentChapterIndex",0),n.persist("totalChapters",i))}let t=r.nextChapter();console.log("nextResponse = ",t)}),r.renderTo("area")}(a.target.result,e.name,t,n)}.bind(this),r.readAsArrayBuffer(e)}}function $(e){return"chapter"+e}var ee,te=a(11);class ae{static audioBufferToWav(e){let t,a,n=e.numberOfChannels,r=e.length*n*2+44,i=new ArrayBuffer(r),o=new DataView(i),s=[],l=0,c=0;for(g(1179011410),g(r-8),g(1163280727),g(544501094),g(16),p(1),p(n),g(e.sampleRate),g(2*e.sampleRate*n),p(2*n),p(16),g(1635017060),g(r-c-4),t=0;t<e.numberOfChannels;t++)s.push(e.getChannelData(t));for(;c<r;){for(t=0;t<n;t++)a=Math.max(-1,Math.min(1,s[t][l])),a=0|(.5+a<0?32768*a:32767*a),o.setInt16(c,a,!0),c+=2;l++}let u=te.E.readHeader(new DataView(i)),d=new Int16Array(i,u.dataOffset,u.dataLen/2),_=[],f=[];for(let b=0;b<d.length;b+=2)_.push(d[b]),f.push(d[b+1]);var h=new Int16Array(_),m=new Int16Array(f);if(2===u.channels)return ae.wavToMp3Stereo(u.channels,u.sampleRate,h,m);if(1===u.channels)return ae.wavToMp3(u.channels,u.sampleRate,d);function p(e){o.setUint16(c,e,!0),c+=2}function g(e){o.setUint32(c,e,!0),c+=4}}static wavToMp3Stereo(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(var r=[],i=new te.x(e,t,128),o=a.length,s=1152,l=0;o>=s;l+=s){if(n){var c=a.subarray(l,l+s),u=n.subarray(l,l+s);_=i.encodeBuffer(c,u)}else var d=a.subarray(l,l+s),_=i.encodeBuffer(d);_.length>0&&r.push(_),o-=s}var f=i.flush();return f.length>0&&r.push(new Int8Array(f)),new Blob(r,{type:"audio/mp3"})}static wavToMp3(e,t,a){for(var n=[],r=new te.x(e,t,128),i=a.length,o=1152,s=0;i>=o;s+=o){var l=a.subarray(s,s+o),c=r.encodeBuffer(l);c.length>0&&n.push(new Int8Array(c)),i-=o}var u=r.flush();u.length>0&&n.push(new Int8Array(u));var d=new Blob(n,{type:"audio/mp3"}),_=window.URL.createObjectURL(d);console.log("mp3 download:",_)}constructor(t){this.MEDIA_CONSTRAINTS={video:{width:3,height:2},audio:{echoCancellation:!1,noiseSuppression:!1,sampleRate:44100}},this.TIME_OUT_LIMIT_IN_MINUTES=60,this.MinutesToMs=e=>60*e*1e3,this.downloadUrl=function(e){const t=document.createElement("A");t.href=e,t.download="ttsreader.mp3",t.click(),t.remove()},this.inputParams={optionalOutputAudioElement:null,optionalDownloadButton:null,optionalOnStart:null,optionalOnDone:null,optionalOnError:null},this.isRecording=!1,this.recordedChunks=[],this.setUrlToDomElements=e=>{this.inputParams.optionalDownloadButton&&(this.inputParams.optionalDownloadButton.download="ttsreader.mp3",this.inputParams.href=e),this.inputParams.optionalOutputAudioElement&&(this.inputParams.optionalOutputAudioElement.src=e)},this.saveBlobMp3=e=>{const t=new AudioContext,a=new FileReader;a.onloadend=()=>{const e=a.result;t.decodeAudioData(e,e=>{console.log(e),this.saveBlob(ae.audioBufferToWav(e))})},a.readAsArrayBuffer(e)},this.saveBlob=e=>{this.audioBlobUrl=URL.createObjectURL(e),this.setUrlToDomElements(this.audioBlobUrl),this.inputParams.optionalOnDone&&this.inputParams.optionalOnDone(this.audioBlobUrl)},this.downloadBlob=()=>{this.downloadUrl(this.audioBlobUrl)},this.toggleCapture=()=>{this.isRecording?this.stopCapture():this.startCapture()},this.stopCapture=()=>{console.log("stopCapture"),this.mediaRecorder&&this.mediaRecorder.stop(),this.sourceMediaStream&&this.sourceMediaStream.getTracks()&&this.sourceMediaStream.getTracks().forEach(function(e){e.stop()}),this.isRecording=!1,clearTimeout(this.globalTimeout)},this.startCapture=()=>{console.log("startCapture");let e=this;navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&navigator.mediaDevices.getDisplayMedia(e.MEDIA_CONSTRAINTS).catch(e=>{console.error("Error:"+e)}).then(t=>{e.sourceMediaStream=t,e.handleStream(new MediaStream(t.getAudioTracks())),e.isRecording=!0,e.inputParams.optionalOnStart&&e.inputParams.optionalOnStart(),this.globalTimeout=setTimeout(this.stopCapture,e.MinutesToMs(e.TIME_OUT_LIMIT_IN_MINUTES)),t.addEventListener("inactive",t=>{e.stopCapture()})})},this.handleStream=e=>{if(!e)return;let t={mimeType:"audio/webm;codecs=opus"};MediaRecorder.isTypeSupported(t.mimeType)||(console.log(t.mimeType+" is not Supported"),t={mimeType:"audio/webm;codecs=vorbis"},MediaRecorder.isTypeSupported(t.mimeType)||(console.log(t.mimeType+" is not Supported"),t={mimeType:"audio/webm"},MediaRecorder.isTypeSupported(t.mimeType)||(console.log(t.mimeType+" is not Supported"),t={mimeType:""}))),this.mediaRecorder=new MediaRecorder(e,t),this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.recordedChunks.push(e.data)},this.mediaRecorder.onstop=e=>{let t=new Blob(this.recordedChunks,{type:"audio/webm;codecs=opus"});this.recordedChunks=[],this.saveBlobMp3(t)},this.mediaRecorder.start()},t&&(this.inputParams=(0,e.A)((0,e.A)({},this.inputParams),t))}}class ne{static getExpEpochInSecsFromPurchasesList(e){if(!e||!(e instanceof Object)||0===Object.getOwnPropertyNames(e).length)return 0;let t=1e3,a=Object.getOwnPropertyNames(e),n=[];for(const i of a){let t=e[i];"SKU_TTSREADER_PREMIUM_1_YEAR__"===t.sku&&n.push(t.epochDateInSecs)}n.length>0&&n.sort();let r=31536e3;for(const i of n)i<t?t+=r:t=i+r;return t}static getHowManyDaysLeftToExpiration(e){if(!e||!(e instanceof Object)||0===Object.getOwnPropertyNames(e).length)return-999;let t=ne.getExpEpochInSecsFromPurchasesList(e),a=Date.now()/1e3,n=Math.floor((t-a)/86400);return n<-999?-999:n}}ee=ne,ne.mockData={"47107547JJ965064G":{epochDateInSecs:1671713190,misc:"",sku:"SKU_TTSREADER_PREMIUM_1_YEAR__"},fake_purchase_id_fU6Un:{epochDateInSecs:1671636497,misc:"some misc data",sku:"SKU_TTSREADER_PREMIUM_1_YEAR__"}},ne.getMockPurchasesData=()=>ee.mockData;function re(e){var t;let a=null===(t=document.getElementById("JS_STRINGS"))||void 0===t?void 0:t.querySelector('[data-ws-string-key="'.concat(e,'"]'));return(null===a||void 0===a?void 0:a.getAttribute("data-ws-string-value"))||e}class ie{static async convertMp3BlobUrlToWav(e){const t=await fetch(e),a=await t.blob(),n=await a.arrayBuffer(),r=new(window.AudioContext||window.webkitAudioContext),i=await r.decodeAudioData(n);return ie.encodeWav(i)}static encodeWav(e){const t=e.numberOfChannels,a=e.sampleRate,n=e.getChannelData(0),r=e.length*t*2,i=new ArrayBuffer(44+r),o=new DataView(i);function s(e,t,a){for(let n=0;n<a.length;n++)e.setUint8(t+n,a.charCodeAt(n))}return s(o,0,"RIFF"),o.setUint32(4,36+r,!0),s(o,8,"WAVE"),s(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,t,!0),o.setUint32(24,a,!0),o.setUint32(28,a*t*2,!0),o.setUint16(32,2*t,!0),o.setUint16(34,16,!0),s(o,36,"data"),o.setUint32(40,r,!0),function(e,t,a){for(let n=0;n<a.length;n++,t+=2){let r=Math.max(-1,Math.min(1,a[n]));e.setInt16(t,r<0?32768*r:32767*r,!0)}}(o,44,n),new Blob([o],{type:"audio/wav"})}}class oe{static loadFile(e,t){if(window.mammoth){const a=new FileReader;a.onload=function(e){const a=e.target.result;window.mammoth.convertToHtml({arrayBuffer:a}).then(e=>{t(e.value)}).catch(e=>alert("Error loading .docx: "+e.message))},a.readAsArrayBuffer(e)}else{const a=document.createElement("script");a.src="https://unpkg.com/mammoth/mammoth.browser.min.js",a.onload=()=>{oe.loadFile(e,t)}}}}class se{static loadFile(e,t){let a=new FileReader;a.onloadend=function(e){t(this.result.trim())},a.readAsText(e)}}const le=(e,t,a,n)=>{if(!e)return 0;e=e.trim();let r=0;const i=(e=e.replace(/\{\{pause(?::(.*?))?\}\}/g,(e,t)=>{if(void 0===t)return r+=1," ";const a=parseInt(t,10);return isNaN(a)||String(a)!==t.trim()||(r+=a/1e3)," "})).length,o=Math.ceil(60*i/850/n);return console.log({pausesDurationSeconds:r,textDurationSeconds:o,total:o+r}),o+r};const ce=class{static async generateApiSecret(){try{const e=await window.getIdToken(),t=await fetch("https://us-central1-ttsreader.cloudfunctions.net/functionGenerateApiSecret",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({})});if(!t.ok)throw new Error("HTTP error! status: ".concat(t.status))}catch(error){return console.error("Error generating API secret:",error),null}}static async testTtsApi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Nova Premium",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;try{const i=t||"Hello dear, How are you? If you can hear me, you've successfully generated your first MP3 via TTSReader's API call.",o=await fetch("https://ttsreader.com/api/ttsSync",{method:"POST",headers:{Authorization:"Bearer UAPI-".concat(e),"Content-Type":"application/json"},body:JSON.stringify({text:i,lang:a,voice:n,rate:r})});if(!o.ok)throw new Error("HTTP error! status: ".concat(o.status));const s=await o.blob();return this.downloadAudioFile(s,"ttsreader_api_test.mp3"),!0}catch(error){return console.error("Error testing TTS API:",error),!1}}static downloadAudioFile(e,t){const a=URL.createObjectURL(e),n=document.createElement("a");n.href=a,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}static getCurlExample(e){return'curl -X POST "https://ttsreader.com/api/ttsSync" \\\n-H "Authorization: Bearer UAPI-'.concat(e||"YOUR_SECRET_KEY",'" \\\n-H "Content-Type: application/json" \\\n--data \'{"text": "Hello world, this is a test from TTSReader API.","lang": "en-US", "voice": "Nova Premium", "rate":1 }\' \\\n--output "hello.mp3"')}static getJavaScriptExample(e){return"async function generateTTS() {\n    const response = await fetch('https://ttsreader.com/api/ttsSync', {\n        method: 'POST',\n        headers: {\n            'Authorization': 'Bearer UAPI-".concat(e||"YOUR_SECRET_KEY","',\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n            text: \"Hello world, this is a test from TTSReader API.\",\n            lang: \"en-US\",\n            voice: \"Nova Premium\",\n            rate: 1\n        })\n    });\n    \n    if (response.ok) {\n        const audioBlob = await response.blob();\n        const url = URL.createObjectURL(audioBlob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = 'hello.mp3';\n        a.click();\n    }\n}")}static async copyToClipboard(e){try{return await navigator.clipboard.writeText(e),!0}catch(error){console.error("Error copying to clipboard:",error);const n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.focus(),n.select();try{return document.execCommand("copy"),document.body.removeChild(n),!0}catch(t){return console.error("Fallback copy failed:",t),document.body.removeChild(n),!1}}}},ue={node:0,charStart:0,charEnd:0};document.documentElement.getAttribute("lang");function de(){if(window.TextUtils=S,console.log("loaded alright"),window.Purchases=ne,"win"===o.getOs()){const e=new FontFace("BabelStoneFlags","url(static/fonts/BabelStoneFlags.ttf)",{unicodeRange:"U+1F1E6-1F1FF",style:"normal",fontSize:"20px"});document.fonts.add(e),e.load().then(()=>{Q.fetchStyleSheet("static/css/fonts.css")})}}"complete"===document.readyState?(console.log("loaded already"),de()):(console.log("waiting for load"),window.addEventListener("load",e=>{de()}));const _e=function(){let t={togglePlay:0,charsRead:0},a=null;const r=window.Quill||null,l=Boolean(r)&&Boolean(document.querySelector(".Text-box-quill")),v=window.quill;console.log("shouldUseQuill: ",l),l&&window.quill.on("text-change",()=>{clearTimeout(a),a=setTimeout(()=>{j()},1e3)});const w=document.querySelector(".Text-box"),E=Boolean(document.documentElement.getAttribute("data-ws-prefixed-content")),A=document.documentElement.getAttribute("data-ws-doc-id");if(A){const t=(0,e.A)({},localStorage);for(const e of Object.getOwnPropertyNames(t))e.startsWith("TTSReaderPlayer_caretPosition_")&&!e==="TTSReaderPlayer_caretPosition_"+A&&localStorage.removeItem(e)}console.log({isContentFixed:E,docId:A});let x=new m("TTSReaderPlayer");const T=[["charsUsedToday","number"],["countingDay","number"],["isPremium","bool"],["isRepeatMode","bool"],["caretPosition","Object"],["selectedFontSize",""],["selectedVoiceUri",""],["selectedLanguageCode",""],["selectedRate","number"],["selectedRateSliderValue","number"]];let B={},R=function(){let e={};for(const a of T)try{let t=a[0],n=a[1],r=A&&"caretPosition"===t?x.get(t+"_"+A,n):x.get(t,n);null!==r&&(e[t]=r)}catch(t){console.error(t)}return e}();console.log({storedState:R});let M=!0;localStorage.getItem("ttsreader.wasOnboarding3")||(delete R.selectedLanguageCode,delete R.selectedVoiceUri),Object.getOwnPropertyNames(R).length>0&&(M=!1);let P=!1;window.innerWidth>1e3&&(P=!0);let k=(0,e.A)((0,e.A)({},{charsUsedToday:0,countingDay:0,isFirstVisit:M,isToWelcome:!1,ttsReady:!1,isPlayingOn:!1,isRecordingOn:!1,caretPosition:{node:0,charStart:0,charEnd:0},selectedVoiceUri:"",selectedLanguageCode:document.documentElement.getAttribute("lang"),selectedRate:1,selectedRateSliderValue:10,selectedFontSize:"20px",os:o.getOs(),isChrome:o.isChrome(),isRecordingSupported:"win"===o.getOs()||window.location.href.includes("localhost"),isRepeatMode:!1,isShareSupported:Boolean(window.navigator.share),shouldPodcast:!1,isSettingsSidebarOpen:P,selectedLanguageDisplay:"\ud83c\uddfa\ud83c\uddf8 English"}),R),I=Math.floor(Date.now()/1e3/60/60/24);k.countingDay!==I&&(k.countingDay=I,k.charsUsedToday=0),k.caretPosition&&void 0!==k.caretPosition.node&&void 0!==k.caretPosition.charStart&&void 0!==k.caretPosition.charEnd||(k.caretPosition=ue);let L=new o(k);L.addEffect(e=>{var t,a,n;e.isPlayingOn;let r={isVoicePremium:O(e.selectedVoiceUri)};var i,o,s,l,c,u,d,_,f,h,m,p,g,v;(e.selectedRate&&!isNaN(e.selectedRate)||(r.selectedRate=1,r.selectedRateSliderValue=b(1)),e&&e.uid&&e.serverData&&(e.serverData.currentPremiumPlan&&null!==(t=e.serverData.currentPremiumPlan)&&void 0!==t&&t.expiresOnDate&&e.serverData.currentPremiumPlan.expiresOnDate>=Date.now()||e.serverData.remainingExtraCredits&&e.serverData.remainingExtraCredits>0))?(r.isPremium=!0,r.isPremiumPlan=e.serverData.currentPremiumPlan&&e.serverData.currentPremiumPlan.expiresOnDate>=Date.now(),r.subscriptionId=(null===e||void 0===e||null===(i=e.serverData)||void 0===i||null===(o=i.currentPremiumPlan)||void 0===o?void 0:o.subId)||"",window.subscriptionId=r.subscriptionId,r.usedMonthly=(null===e||void 0===e||null===(s=e.serverData)||void 0===s||null===(l=s.usage)||void 0===l?void 0:l.m)||0,r.monthlyQuota=(null===e||void 0===e||null===(c=e.serverData)||void 0===c||null===(u=c.currentPremiumPlan)||void 0===u?void 0:u.quotaCharsM)||0,r.monthlyQuotaHuman=function(e){if(null===e||void 0===e)return"";const t=Math.abs(e),a=e<0?"-":"";return t>=1e9?a+(t/1e9).toFixed(1).replace(/\.0$/,"")+"B":t>=1e6?a+(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?a+(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":a+t.toString()}(r.monthlyQuota),r.isPayAsYouGo=(null===e||void 0===e||null===(d=e.serverData)||void 0===d?void 0:d.remainingExtraCredits)>1,r.remainingCreditsChars=Math.round((null===e||void 0===e||null===(_=e.serverData)||void 0===_?void 0:_.remainingExtraCredits)||0),r.uapi=(null===e||void 0===e||null===(f=e.serverData)||void 0===f?void 0:f.uapi)||"",r.daysLeftForPremium=r.isPremiumPlan?Math.ceil(-(Date.now()-((null===e||void 0===e||null===(h=e.serverData)||void 0===h||null===(m=h.currentPremiumPlan)||void 0===m?void 0:m.expiresOnDate)||0))/864e5):-1,r.premiumPlanExpirationDateReadable=r.isPremiumPlan?!(v=null===e||void 0===e||null===(p=e.serverData)||void 0===p||null===(g=p.currentPremiumPlan)||void 0===g?void 0:g.expiresOnDate)||isNaN(v)?"N/A":new Date(v).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric"}):"No premium plan"):(r.isPremium=!1,r.isPremiumPlan=!1,r.remainingCreditsChars=0,r.subscriptionId="",window.subscriptionId=r.subscriptionId);r.usageLife=(null===e||void 0===e||null===(a=e.serverData)||void 0===a||null===(n=a.usage)||void 0===n?void 0:n.life)||0;let S=r.remainingCreditsChars,y=(null===e||void 0===e?void 0:e.serverData)||null;var w;y&&(console.log("Server data: ",y,{calcRemainingChars:S}),null!==y&&void 0!==y&&null!==(w=y.podcasts)&&void 0!==w&&w.main_channel_id?r.podcast_main_channel_url="https://ttsreaderstorage.blob.core.windows.net/tts-outputs/podcasts/pod_"+y.podcasts.main_channel_id+".xml":r.podcast_main_channel_url="");return r});const C=e=>!e||(e-=500,L.data.isPremium?!!(L.data.isPremiumPlan&&L.data.usedMonthly+e<=L.data.monthlyQuota)||!!(L.data.remainingCreditsChars&&L.data.remainingCreditsChars>=e):(L.data.usageLife||0)+e<=5e3);let D=x.get("content")||"";if(D&&!E){let e=x.get("content_type")||"text/plain";Q(D,L.data.caretPosition,e,!0)}function N(){console.log("runSilentTest"),o.isChrome()&&(console.log("runSilentTest is Chrome true"),i.TtsEngine.runSilentTest())}function O(e){return!(!e||""===e)&&((e=e.trim()).startsWith("ttsreaderServer")||e.startsWith("azure."))}o.isChrome()&&document.addEventListener("click",function e(t){L.updateWithParams({wasEverClicked:!0}),L.get("ttsReady")&&N(),document.removeEventListener("click",e)}),window.updateStateWithParentData=function(t){if(L&&t&&Object.getOwnPropertyNames(t).length>0){let n=(0,e.A)({},t);if(n.parentData=t,t.hasOwnProperty("uid")&&""===t.uid&&(n.isPremium=!1,n.daysLeftForPremium=-999,n.isSignedIn=!1,window.subscriptionId=""),t.hasOwnProperty("uid")&&t.uid&&(n.isSignedIn=!0,window.resetPayPalButtons))try{window.resetPayPalButtons(t.uid)}catch(a){}t.serverData&&t.serverData.currentPremiumPlan&&t.serverData.currentPremiumPlan.subId&&(window.subscriptionId=t.serverData.currentPremiumPlan.subId);let r=function(e,t){if(!t||!t.payments||0===Object.keys(t.payments).length)return null;let a,n=Object.keys(t.payments),r=0;for(const i of n)t.payments[i].date&&t.payments[i].date>r&&(r=t.payments[i].date,a=i);if(r&&Date.now()-r>3e5)return null;if(e&&e.payments&&e.payments[a])return null;return t.payments[a]}(L.data.serverData,t.serverData);return r&&(n.newPaymentAmount=r.amount),L.updateWithParams(n),!0}return!1},window.getAppState=function(){return L};let F=null;const U=(window.location.href.includes("localhost"),10);let V,H=new ae({optionalOnDone:function(e){F&&(clearTimeout(F),F=null);try{const t=document.createElement("A");t.href=e,t.download="ttsreader.mp3",t.click(),t.remove()}catch(t){console.log("some error: ",t)}L.updateWithParams({isRecordingOn:!1}),L.data.isPlayingOn&&te()},optionalOnStart:function(){s.closeModals(),L.updateWithParams({isRecordingOn:!0}),L.data.isPlayingOn||te(),L.data.isPremium||(console.log("setting recording timeout"),F=setTimeout(()=>{F&&(console.log("recording timeout fired"),H.stopCapture(),F=null)},1e3*U))}});function q(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null===t)e=l?window.quill.getText()||"":w instanceof HTMLTextAreaElement?w.value||"":w.innerText||"";else{t<0&&(t=0);let n="";if(l){let e=window.quill.getLines();if(t>=e.length)return"";n=e[t].domNode.innerText}else if(w instanceof HTMLTextAreaElement)n=w.value||"";else{let e=w.childNodes;t>=e.length&&(t=e.length-1);let a=e[t];a.nodeType===Node.TEXT_NODE?n=a.textContent:a.nodeType===Node.ELEMENT_NODE&&(n=a.innerText)}a>=0&&a<n.length&&(e=n.slice(a))}return n&&e.length>n&&(e=e.slice(0,n)),e}function z(e){let t=60*e/850;if(t<=0)return"00:00:00";t+=.3;const a=Math.floor(t/3600),n=Math.floor(t%3600/60),r=Math.ceil(t%60),i=e=>String(e).padStart(2,"0");return"".concat(i(a),":").concat(i(n),":").concat(i(r))}function G(){clearInterval(V),document.getElementById("processingModal").style.display="none"}function X(e,t,a){let{voiceURI:n,fullLang:r}=function(e,t){let a;return t.toLowerCase().includes("noah")?(a="ttsreaderServer.azure.en-GB-OllieMultilingualNeural",{voiceURI:a,fullLang:"en-GB"}):t.toLowerCase().includes("lilly")?(a="ttsreaderServer.azure.en-US-ShimmerTurboMultilingualNeural",{voiceURI:a,fullLang:"en-GB"}):t.toLowerCase().includes("olivia")?(a="ttsreaderServer.azure.en-GB-LibbyNeural",{voiceURI:a,fullLang:"en-GB"}):((t.startsWith("azure.")||t.startsWith("ttsreaderServer."))&&(a=t),a=a||B[e][t]||B.i18n[t]||B[e][t+" Premium"]||B.i18n[t+" Premium"]||B.i18n["John Premium"],e.includes("-")||(e=c.getBCP47code(a,e)),{voiceURI:a,fullLang:e})}(e,t);return n=n.replace("ttsreaderServer.azure.",""),"{{set:".concat(r,",").concat(n,",").concat(a,"}}")}function j(){if(E)return;let e="",t="";var a;if(l)e=null===(a=window.quill)||void 0===a?void 0:a.getContents(),t="quill";else if(w instanceof HTMLTextAreaElement){var n;e=(null===(n=w.value)||void 0===n?void 0:n.trim())||"",t="text/plain"}else{var r;e=(null===(r=w.innerText)||void 0===r?void 0:r.trim())||"",t="text/plain"}x.persist("content",e),x.persist("content_type",t)}function Y(){if(!l)return null;const e=v.root.querySelectorAll(".Highlight"),t=e.length>0?e[e.length-1]:null;if(!t)return null;const a=r.find(t);if(!a)return null;const n=a.offset(v.scroll)+a.length(),i=v.getLines();let o=0;for(let r=0;r<i.length;r++){const e=i[r].length();if(n<=o+e){return{lineIndex:r,localOffset:n-o}}o+=e}return null}function K(){v.focus();const e=v.getSelection();if(console.log("getCaretLineOffsetFromQuill selection: ",e),!e)return null;const t=e.index,a=v.getLines();let n=0;for(let r=0;r<a.length;r++){const e=a[r].length();if(t>=n&&t<=n+e){return{lineIndex:r,localOffset:t-n}}n+=e}return null}function Z(e,t){const a=v.getLines();if(e<0||e>=a.length)return;const n=a[e],r=v.getIndex(n),i=n.length(),o=r+Math.min(t,i);v.setSelection(o,0)}function Q(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/plain",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e||(e="",t={node:0,charStart:0,charEnd:0},a="text/plain"),l){if(window.quill.setContents([{insert:"\n"}]),"text/plain"===a)window.quill.setText(e);else if("quill"===a)try{const t=JSON.parse(e);window.quill.setContents(t)}catch(r){console.error("Failed to parse quill content - so parsing as txt"),Q(e,t,"text/plain",n)}else"html"===a&&window.quill.clipboard.dangerouslyPasteHTML(e);Z(t.node,t.charStart)}else if(w instanceof HTMLTextAreaElement){if(a&&"text/plain"!==a){let t=document.createElement("div");t.innerHTML=e,e=t.innerText}w.value=e,w.setSelectionRange(0,0),w.blur(),w.focus()}else{if(a&&"text/plain"!==a){let t=document.createElement("div");t.innerHTML=e,e=t.innerText}w.innerHTML="";let t=e.split("\n");for(let e of t){let t=document.createElement("p");0!==e.trim().length&&(t.innerText=e,w.appendChild(t))}}if(n||j(),L){let e={caretPosition:t||ue};null!==x.get("totalChapters")&&(e.isBook=!0,e.currentChapterIndex=Number.parseInt(x.get("currentChapterIndex")||0),e.currentChapterLabel=e.currentChapterIndex+1,e.totalChapters=Number.parseInt(x.get("totalChapters")||1),e.bookTitle=x.get("bookTitle")||""),L.updateWithParams(e)}}function $(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.2;try{if(L&&!L.data.isPremium){Math.random()<e&&s.showModal("upgradeModal")}}catch(t){}}function ee(){if(Q("",{node:0,charStart:0,charEnd:0},"text/plain"),L){let e={isBook:!1,currentChapterIndex:0};e.currentChapterLabel=e.currentChapterIndex+1,e.totalChapters=0,e.bookTitle="",L.updateWithParams(e)}if(null!==x.get("totalChapters")){x.remove("totalChapters"),x.remove("currentChapterIndex"),x.remove("bookTitle");let e=0;for(;null!==x.get("chapter"+e);)x.remove("chapter"+e),e++}}L.addChangeListener(e=>{for(const t of T){let a=t[0];A&&"caretPosition"===a?x.persist(a+"_"+A,e[a]):x.persist(a,e[a])}e.isPremium}),window.getHighlightLineIndexAndLocalOffset=Y,window.getCaretLineOffsetFromQuill=K;const te=()=>{var e,a;L.data.isPlayingOn?(Me(),null!==L&&void 0!==L&&null!==(e=L.data)&&void 0!==e&&e.isPremium||t.togglePlay%5!==4||(console.log("invoking go premium modal from togglePlay"),window.AppAnalytics.sendEvent("invoke_premium_on_toggle_play"),$(1))):null!==L&&void 0!==L&&null!==(a=L.data)&&void 0!==a&&a.isPremium||t.togglePlay%5!==4?me():(console.log("invoking go premium modal from togglePlay"),window.AppAnalytics.sendEvent("invoke_premium_on_toggle_play"),$(1));t.togglePlay++},ne=(t,a,n)=>{if(t.length<=a.node)return ne(t,ue);let r=t[a.node];if(r instanceof Element&&r.hasAttribute("data-ws-do-not-read"))return ne(t,{node:a.node+1,charStart:0,charEnd:0},n);let i=q(a.node,0,1/0);if(i.length<=a.charStart)return ne(t,{node:a.node+1,charStart:0,charEnd:0},n);let o=i.substring(a.charStart);const s="{{pause}}";let l=-1,c=o.indexOf(s),u=o.indexOf("{{pause:"),d=o.indexOf("{{set:"),_=o.indexOf("{{skip:");if(c=-1===c?Number.MAX_SAFE_INTEGER:c,u=-1===u?Number.MAX_SAFE_INTEGER:u,d=-1===d?Number.MAX_SAFE_INTEGER:d,_=-1===_?Number.MAX_SAFE_INTEGER:_,l=Math.min(c,u,d,_),0===l){if(l===c)return{text:s,node:a.node,charStart:a.charStart,charEnd:a.charStart+9};{let e=o.indexOf("}}");if(l>-1){let t=o.substring(0,e+2);return{text:t,node:a.node,charStart:a.charStart,charEnd:a.charStart+t.length}}}}let f=!1;l>-1&&(o=o.substring(0,l),f=!0);let h=o.trimLeft(),m=o.length-h.length,p=["*"," ","\n","-","_","[","'",'"',"~",".","{","}",","];for(p.concat(S.SENTENCE_STRONG_ENDS),p.concat(S.SENTENCE_SOFT_BREAKS),p=p.map(e=>e.trim());p.indexOf(h.charAt(0))>-1&&h;)h=h.substr(1),m++;let g=(0,e.A)((0,e.A)({},a),{},{charStart:a.charStart+m,charEnd:a.charStart+m});if(h){let t=S.indexOfFirstSentenceEnd(h.substr(0,S.MAX_SEGMENT_LENGTH+1),n);g=(0,e.A)((0,e.A)({},a),{},{charEnd:g.charStart+t});let r=h.substr(0,t);return(0,e.A)({text:r},g)}return f?ne(t,g,n):a.node<t.length-1?ne(t,{node:a.node+1,charStart:0,charEnd:0},n):{text:"",node:0,charStart:0,charEnd:0}},de=()=>l?window.quill.getLines():w instanceof HTMLTextAreaElement?[w]:w.childNodes,_e=(t,a,n,r,o,u)=>{let d=o?u:L,_=de(),{text:f,charEnd:h,charStart:m,node:p}=ne(_,a,d.data.selectedLanguageCode);if(null==f)return void Me();if(f=f.trim(),!o&&!d.data.isRepeatMode&&!r&&(p<a.node||p==a.node&&m<a.charStart))return Me(),d.updateWithParams({caretPosition:{node:0,charStart:0,charEnd:0}}),void(d.data.isRecordingOn&&H.toggleCapture());a={node:p,charStart:m,charEnd:h};const g="{{pause}}";if(f===g||f.startsWith("{{pause:")&&f.endsWith("}}")&&!f.includes(" ")){if(n||o){let t=(0,e.A)((0,e.A)({},a),{},{charStart:a.charStart+f.length,charEnd:a.charStart+f.length});return void d.updateWithParams({caretPosition:t})}let r=1e3;f!==g&&(r=parseInt(f.substring(8,f.length-2)));let i=(0,e.A)((0,e.A)({},a),{},{charEnd:a.charStart+f.length});return d.updateWithParams({caretPosition:i}),be(t,i),void setTimeout(function(){Ye.onDone()},r)}if(f.trim().startsWith("{{skip:")&&f.trim().endsWith("}}")){if(n||o){let t=(0,e.A)((0,e.A)({},a),{},{charStart:a.charStart+f.length,charEnd:a.charStart+f.length});return void d.updateWithParams({caretPosition:t})}let r=(0,e.A)((0,e.A)({},a),{},{charEnd:a.charStart+f.length});d.updateWithParams({caretPosition:r}),be(t,r),setTimeout(function(){Ye.onDone()},0)}if(f.trim().startsWith("{{set:")&&f.trim().endsWith("}}")){if(n){let t=(0,e.A)((0,e.A)({},a),{},{charStart:a.charStart+f.length,charEnd:a.charStart+f.length});return void d.updateWithParams({caretPosition:t})}try{let e=f.match(/(?<==\s*)[^]*?(?=\s*;)/g),t=e[0],a=e[1],n=parseFloat(e[2]),r=b(n),i=a;console.log({voiceUri:i,lang:t,rate:n}),i&&i.trim()&&(i.startsWith("azure.")||i.startsWith("ttsreaderServer."))||(i=B[t][a]||B.i18n[a]||B[t][a+" Premium"]||B.i18n[a+" Premium"]||B.i18n["John Premium"]),o?d.updateWithParams({selectedRateSliderValue:r,selectedRate:n,selectedVoiceUri:i,selectedLanguageCode:t}):(console.log("Setting: ",{voiceUri:i,lang:t,rate:n}),t!==L.data.selectedLanguageCode&&xe({currentTarget:{value:t}}),i!==L.data.selectedVoiceUri&&Re({currentTarget:{value:i}}),n!==L.data.selectedRate&&L.updateWithParams({selectedRateSliderValue:r,selectedRate:n}))}catch(v){console.error("error in setting voice on the fly:",v)}l&&ve(a);let t=(0,e.A)((0,e.A)({},a),{},{charStart:a.charStart+f.length,charEnd:a.charStart+f.length});return d.updateWithParams({caretPosition:t}),void(o||Ye.onDone())}if(!f&&0==a.charStart&&0==a.charEnd)return o||Me(),d.updateWithParams({caretPosition:{node:0,charStart:0,charEnd:0}}),-1;if(!f)return _e(t,(0,e.A)((0,e.A)({},a),{},{charStart:a.charEnd}),n,r,o,u);{d.updateWithParams({caretPosition:a});let e=!1;if("!"!==f&&"?"!==f&&"."!==f&&","!==f||(e=!0),!e||n)if(n)d.updateWithParams({caretPosition:a});else if(o||!O(L.get("selectedVoiceUri"))||C(f.length))if(O(L.get("selectedVoiceUri"))&&!L.get("isSignedIn"))s.showModal("premiumVoiceSignInModal"),Me();else{let e={text:f,voiceURI:d.data.selectedVoiceUri,langBCP47:c.getBCP47code(d.data.selectedVoiceUri,d.data.selectedLanguageCode),rate:d.data.selectedRate};if(o)return e;d.updateWithParams({charsUsedToday:d.data.charsUsedToday+f.length}),i.TtsEngine.setVoiceByUri(d.data.selectedVoiceUri),i.TtsEngine.setRate(d.data.selectedRate),fe(e,d.data)}else alert(re("alert_quota_reached")),window.openNewUpgradeModal(),Me();else o||Ye.onDone()}},fe=async function(t,a){let n=[];if(a){let t=2,r=new o(a);for(;n.length<t;){let t=(0,e.A)((0,e.A)({},r.data.caretPosition),{},{charStart:r.data.caretPosition.charEnd});r.updateWithParams({caretPosition:t});let a=_e(w,r.data.caretPosition,!1,!1,!0,r);if(null!==a&&void 0!==a&&-1!==a)n.push(a);else if(-1===a)break}n.filter(e=>O(e.voiceURI))}i.TtsEngine.speakAndBuffer(t,n,await window.getIdToken())};function he(e){(e=e||"https://en.wikipedia.org/wiki/The_Beatles").toLowerCase().startsWith("https://")||e.toLowerCase().startsWith("http://")||(e="https://"+e);"localhost"===window.location.hostname||window.location.hostname;const t="html",a={url:"https://audactive.com/web?url="+e,type:t},n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};L.updateWithParams({isLoading:!0}),fetch("https://ttsreader.com/api/fetchHtml",n).then(e=>e.text()).then(e=>{e=e.replace("hero {display: none}",""),Q(e=e.replace(/\n{3,}/g,"\n\n").replace(/ {3,}/g,"  "),{node:0,charStart:0,charEnd:0},t),L.updateWithParams({isLoading:!1}),me()}).catch(e=>{console.error("Error:",e),L.updateWithParams({isLoading:!1})})}const me=()=>{var e;let t=(null===(e=q())||void 0===e?void 0:e.trim())||"";if(!t)return Ge("emptyTextModal"),void fe({text:"empty_text_read",voiceURI:L.data.selectedVoiceUri,langBCP47:c.getBCP47code(L.data.selectedVoiceUri,L.data.selectedLanguageCode),rate:L.data.selectedRate,isTest:!0});if(t.includes(" ")||t.includes("\n")||!t.toLowerCase().startsWith("https://")&&!t.toLowerCase().startsWith("http://")){if(O(L.get("selectedVoiceUri"))&&!L.get("isSignedIn"))return s.showModal("premiumVoiceSignInModal"),void fe({text:"sign_in_to_use_premium_voices",voiceURI:L.data.selectedVoiceUri,langBCP47:c.getBCP47code(L.data.selectedVoiceUri,L.data.selectedLanguageCode),rate:L.data.selectedRate,isTest:!0});let e=L.data.caretPosition||ue;if(l){let{lineIndex:t,localOffset:a}=K()||{line:0,localOffset:0};t=t||0,a=a||0,e={node:t,charStart:a,charEnd:a}}L.updateWithParams({isPlayingOn:!0,caretPosition:e}),_e(w,e,!1,!0)}else he(t)};let pe=[];const ge=(e,t,a)=>{pe=[];let n=d(e,t),r=n.map(e=>e.voiceURI).join("::"),i=function(e,t){if(c.areCodesEqual(e,"en-US")){let e=["Samantha","Google","Reed"];for(const a of e)for(const e of t)if(e.name.toLowerCase().includes(a.toLowerCase()))return e}else if(c.areCodesEqual(e,"en-GB")){let e=["Daniel","Google UK English Male","Samantha","Google","Reed"];for(const a of e)for(const e of t)if(e.name.toLowerCase().includes(a.toLowerCase()))return e}for(const n of t)if(n.name.toLowerCase().includes("google"))return n;for(const n of t)if(n.name.toLowerCase().includes("enhanced"))return n;let a=["grandpa","grandma"];for(const n of t){for(const e of a)n.name.toLowerCase().includes(e);return n}return t[0]}(e,n),o=[],s=u.getBestVoices(e,r);for(const c of s)for(const e of n)e.voiceURI===c.uri&&(e.gender=c.gender,o.push(e),n.splice(n.indexOf(e),1));n=n.filter(e=>!O(e.voiceURI)||(o.push(e),!1));for(const d of t)if(d&&d.voiceURI&&We(d.voiceURI)){let t=!1;for(const e of o)if(e.voiceURI===d.voiceURI){t=!0;break}if(!t){let t=JSON.parse(JSON.stringify(d));t.gender=u.getVoiceGender(d.voiceURI,d.lang),t.lang=e.indexOf("-")>-1?e:c.mapLanguageToDefaultLocale[e],o.push(t)}}i=o[0];const l=document.querySelector(".Best-voices"),f=document.querySelector(".Voices-list"),h=document.getElementById("voiceOptionTemplate"),m=document.querySelector(".Voices-Gallery-Container-Premium"),p=document.querySelector(".Voices-Gallery-Container-Free"),g=document.getElementById("voiceTileTemplate");let b=!0;function v(e,t,n){if(!n||!n.voiceURI)return;const r=t.content.cloneNode(!0);let i=r.querySelector(".voice-tile")||r.querySelector(".Voice-list-element"),o=_(n);i.setAttribute("data-ws-voiceURI",n.voiceURI),i.setAttribute("data-ws-voiceName",o),i.setAttribute("data-ws-audio-src",n.demo||""),i.setAttribute("data-ws-select-if-state","selectedVoiceUri="+n.voiceURI),a&&n.voiceURI===a&&i.setAttribute("selected",!0),b&&i.classList.add("selected"),r.querySelector(".voice-name").innerHTML=o,r.querySelector(".voice-lang").innerHTML=c.codeToFlag(n.lang),O(n.voiceURI)||(r.querySelector(".voice-premium").style.display="none"),function(e){if(!e||!e.voiceURI)return!1;if(e){let t=e.voiceURI.toLowerCase();if(t.includes("google")||t.includes("microsoft")||t.startsWith("ttsreader"))return!0}return!1}(n)||(r.querySelector(".voice-publishing").style.display="none"),n.gender?"m"===n.gender?r.querySelector(".voice-gender-female").style.display="none":("f"===n.gender||(r.querySelector(".voice-gender-female").style.display="none"),r.querySelector(".voice-gender-male").style.display="none"):(r.querySelector(".voice-gender-female").style.display="none",r.querySelector(".voice-gender-male").style.display="none"),e.appendChild(r),b=!1}f.innerHTML="",l.innerHTML="",m.innerHTML="",p.innerHTML="";let S=[];return o&&o.length>0&&o.forEach(e=>{e&&e.voiceURI&&(O(e.voiceURI)?(e.isPremium=!0,pe.push(e),v(m,g,e),v(l,h,e)):S.push(e))}),S.length>0&&(S.forEach(e=>{e.isPremium=!1,pe.push(e),v(p,g,e),v(f,h,e)}),p.appendChild(document.createElement("hr")),f.appendChild(document.createElement("hr"))),n.forEach(e=>{e.isPremium=!1,pe.push(e),v(f,h,e),v(p,g,e)}),Le(),i};function be(e,t,a){if(l)ve(t,a);else if(e instanceof HTMLTextAreaElement)return void function(e,t){let a=e;a.blur(),a.setSelectionRange(t.charEnd,t.charEnd),a.focus(),a.setSelectionRange(t.charStart,t.charEnd)}(e,t)}function ve(e,t){if(!window.quill)return;const a=window.quill;if(a.formatText(0,a.getLength(),"highlight",!1),a.formatText(0,a.getLength(),"blink",!1),!e)return;const n=e.charEnd-e.charStart;if(n<=0)return;const r=a.getLines();if(r.length<=e.node)return void console.warn("highlightInQuill: caretPosition.node is out of bounds ",e.node,r.length);const i=r[e.node];let o=a.getIndex(i)+e.charStart,s=t?"blink":"highlight",l=t?"Blink":"Highlight";a.formatText(o,n,s,!0);const c=a.root.querySelector("span."+l);c&&c.scrollIntoView({behavior:"smooth",block:"center"}),t&&setTimeout(()=>{a.formatText(o,n,s,!1)},1e3)}window.highlight=be;const Se=(e,t)=>{be(e,t,!0)},ye=(e,t)=>{if(L.data.isPlayingOn&&Me(),l){let a=window.quill.getLines(),n=e+t;if(n<0?n=a.length-1:n>=a.length&&(n=0),!a[n].domNode.innerText.trim())return void ye(n,t>0?1:-1);let r={node:n,charStart:0,charEnd:0};return L.updateWithParams({caretPosition:r}),l&&Z(n,0),r.charEnd=a[n].domNode.innerText.length,void ve(r,!0)}let a=w;if(a instanceof HTMLTextAreaElement){let n=a.value;if(!n)return;e=L.data.caretPosition.charStart;let r=L.data.caretPosition;if(isNaN(a.selectionStart)||(r={node:0,charStart:e=a.selectionStart>=a.value.length?0:a.selectionStart,charEnd:e}),!(t>0)){if(r.charStart<=0)return r={node:0,charStart:0,charEnd:0},L.updateWithParams({caretPosition:r}),void be(a,r,!0);{let t=n.substr(0,e).trimEnd();const i=["*","-","_","["];for(;i.indexOf(t.charAt(t.length-1))>-1&&t;)t=t.substr(0,t.length-1);let o=1,s=9,l=e=t.length;for(;e-l<3&&l>0;){let t=e-s*o;if(t<=0){l=0;break}let{charEnd:a}=ne(de(),{node:0,charStart:t,charEnd:t});l=Math.max(0,a),o++}return r={node:0,charStart:l,charEnd:l},L.updateWithParams({caretPosition:r}),void be(a,r,!0)}}{let{charEnd:e}=ne(de(),r);r={node:0,charStart:e,charEnd:e},L.updateWithParams({caretPosition:r}),be(a,r,!0)}Se(a,L.data.caretPosition)}else{if(!a.innerText)return;let n=a.childNodes;if(n.length<=1)return;let r=(e+t)%n.length;if(r<0&&(r=n.length-1),n[r].textContent.trim()){let e={node:r,charStart:0,charEnd:0};L.updateWithParams({caretPosition:e}),Se(a,e)}else ye(r,t)}};function we(e){let t=L.data.currentChapterIndex+e;t<0?t=L.data.totalChapters-1:t>=L.data.totalChapters&&(t=0);let a=x.get("chapter"+t);x.persist("currentChapterIndex",t),Q(a,ue,"html")}const Ee=e=>{let t=function(e,t){let a=0;if(g[0]===e)a=0;else for(;a<g.length&&g[a+1]<=e;)a++;return t?a--:a++,a>=g.length&&(a=g.length-1),a<0&&(a=0),[g[a],p[a]]}(L.get("selectedRate"),e),a=t[1],n=t[0];L.updateWithParams({selectedRateSliderValue:a,selectedRate:n})},Ae=e=>{let t=Number.parseFloat(L.get("selectedFontSize").split("px")[0])*e+"px";L.updateWithParams({selectedFontSize:t})},xe=e=>{let t=e.currentTarget.value;(t.startsWith("en-US")||t.startsWith("en-GB")||t.startsWith("es-"))&&(t=t.split("-")[0]);let a=ge(t,i.TtsEngine.voices),n=a.voiceURI,r=h(a,0,t);t.startsWith("he")||t.startsWith("ar")?document.querySelector(".Text-box").style.direction="rtl":document.querySelector(".Text-box").style.direction="ltr",L.updateWithParams({selectedLanguageCode:t,selectedVoiceUri:n,voiceLabel:r,selectedLanguageFlag:c.codeToFlag(t)}),Ie()};let Te=new Audio;Te.onpause=()=>{Be()},Te.onended=()=>{Be()};const Be=()=>{document.querySelectorAll(["[data-ws-voiceURI].isPlaying"]).forEach(e=>{e.classList.remove("isPlaying")})},Re=e=>{let t=e.currentTarget.value;i.TtsEngine.setBestMatchingVoice(null,t,"");let a=h(i.TtsEngine.voice,0,L.data.selectedLanguageCode);L.updateWithParams({selectedVoiceUri:t,voiceLabel:a,isToWelcome:!1})},Me=()=>{let t=(0,e.A)((0,e.A)({},L.data.caretPosition),{},{charEnd:L.data.caretPosition.charStart});L.updateWithParams({isPlayingOn:!1,caretPosition:t}),l&&Z(t.node,t.charStart),be(document.querySelector(".Text-box"),t),i.TtsEngine.stop()},Pe=e=>{L.data.isSettingsSidebarOpen||ke();const t=document.querySelector(".sidebar-voice-item[selected=true]");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},ke=()=>{const e=!L.data.isSettingsSidebarOpen;L.updateWithParams({isSettingsSidebarOpen:e}),e?(L.data.ttsReady&&(Ie(),Le()),setTimeout(()=>{He()},100)):qe()},Ie=()=>{try{Ve(L.data.selectedLanguageCode)}catch(error){console.warn("Error populating sidebar languages:",error)}},Le=()=>{try{var e;console.log("Populating sidebar voices...");const t=document.getElementById("sidebarVoicesList");if(!t)return void console.warn("Sidebar voices container not found");const a=document.getElementById("sidebarVoiceOptionTemplate");if(!a)return void console.warn("Sidebar voice template not found");t.innerHTML="";const n=[],r=[];pe.forEach(e=>{e.isPremium?n.push(e):r.push(e)}),console.log("Premium voices:",n.length),console.log("Basic voices:",r.length);const i=(null===(e=document.querySelector(".voice-filter-btn.active"))||void 0===e?void 0:e.getAttribute("data-filter"))||"all";let o=[];o="premium"===i?n:"basic"===i?r:[...n,...r],console.log("Voices to show (filter="+i+"):",o.length),o.forEach(e=>{const n=a.content.cloneNode(!0),r=n.querySelector(".sidebar-voice-item"),i=O(e.voiceURI);r.setAttribute("data-ws-voiceURI",e.voiceURI),r.setAttribute("data-ws-voiceName",e.name),r.setAttribute("data-ws-select-if-state","selectedVoiceUri=".concat(e.voiceURI)),r.setAttribute("data-voice-type",i?"premium":"basic"),e.voiceURI===L.data.selectedVoiceUri&&r.setAttribute("selected",!0),n.querySelector(".sidebar-voice-name").textContent=f(e.name);const o=n.querySelector(".sidebar-voice-avatar"),s=((e,t)=>{const a=document.createElement("canvas");a.width=40,a.height=40;const n=a.getContext("2d"),r=t.split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e,0),i=Math.abs(r)%360,o=60+Math.abs(r>>8)%40,s=40+Math.abs(r>>16)%30,l=n.createLinearGradient(0,0,40,40);l.addColorStop(0,"hsl(".concat(i,", ").concat(o,"%, ").concat(s,"%)")),l.addColorStop(1,"hsl(".concat(i+30,", ").concat(o-10,"%, ").concat(s-10,"%)")),n.fillStyle=l,n.fillRect(0,0,40,40),n.fillStyle="white",n.font="bold 16px -apple-system, BlinkMacSystemFont, sans-serif",n.textAlign="center",n.textBaseline="middle";const c=t.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase();return n.fillText(c,20,20),a})(e.voiceURI,e.name,e.gender);o.innerHTML="",o.appendChild(s);n.querySelector(".sidebar-voice-meta");n.querySelector(".voice-lang").textContent=c.codeToFlag(e.lang);const l=n.querySelector(".voice-gender-male"),u=n.querySelector(".voice-gender-female");"m"===e.gender?u.style.display="none":"f"===e.gender?l.style.display="none":(l.style.display="none",u.style.display="none");const d=n.querySelector(".voice-type-badge");i?(d.className="voice-premium-badge",d.title="Premium Voice - High Quality AI Voice",d.textContent="P"):(d.className="voice-basic-badge",d.title="Basic Voice - System Voice",d.textContent="B"),t.appendChild(n)});t.querySelector('.sidebar-voice-item[selected="true"]');setTimeout(()=>{He()},100)}catch(error){console.warn("Error populating sidebar voices:",error)}},Ce=()=>{const e=document.getElementById("unifiedLanguageSelector");if(!e)return;const t=e.querySelector(".language-selector-closed"),a=e.querySelector(".language-selector-open"),n=e.querySelector(".language-search-input");t.classList.remove("hidden"),a.classList.add("hidden"),n.value="",document.removeEventListener("click",De)},De=e=>{const t=document.getElementById("unifiedLanguageSelector");t&&!t.contains(e.target)&&Ce()},Ne=()=>{const e=document.getElementById("languageDropdown");if(!e)return;const t=document.querySelector(".Language-selector");if(!t)return;const a=Array.from(t.options).map(e=>{const t=e.value,a=e.textContent;return{value:t,displayText:a,searchTerms:Oe(t,a).toLowerCase()}});e.dataset.languageData=JSON.stringify(a),Fe(a)},Oe=(e,t)=>[e,t,{en:"English",es:"Spanish Espa\xf1a",fr:"French Fran\xe7ais",de:"German Deutsch",it:"Italian Italiano",pt:"Portuguese Portugu\xeas",ru:"Russian \u0420\u0443\u0441\u0441\u043a\u0438\u0439 \u0420\u043e\u0441\u0441\u0438\u044f",zh:"Chinese China Mandarin \u4e2d\u6587 \u4e2d\u56fd",ja:"Japanese Japan \u65e5\u672c\u8a9e \u65e5\u672c",ko:"Korean Korea \ud55c\uad6d\uc5b4 \ud55c\uad6d",ar:"Arabic \u0627\u0644\u0639\u0631\u0628\u064a\u0629",hi:"Hindi India \u0939\u093f\u0928\u094d\u0926\u0940 \u092d\u093e\u0930\u0924",he:"Hebrew Israel \u05e2\u05d1\u05e8\u05d9\u05ea \u05d9\u05e9\u05e8\u05d0\u05dc",nl:"Dutch Netherlands Holland Nederland",ro:"Romanian Romania Rom\xe2n\u0103 Rom\xe2nia"}[e.split("-")[0].split("_")[0]]||""].join(" "),Fe=e=>{const t=document.getElementById("languageDropdown");t&&(t.innerHTML="",e.forEach(e=>{const a=document.createElement("div");a.className="language-option",a.setAttribute("data-value",e.value),e.value===L.data.selectedLanguageCode&&a.classList.add("selected");const n=e.displayText.match(/^((?:\uD83C[\uDDE6-\uDDFF])+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)$/),r=n?n[1]:"",i=n?n[2]:e.displayText;a.innerHTML='\n        <span class="language-option-flag">'.concat(r,'</span>\n        <span class="language-option-name">').concat(i,"</span>\n      "),a.onclick=()=>Ue(e.value),t.appendChild(a)}))},Ue=e=>{xe({currentTarget:{value:e}}),Ve(e),Ce()},Ve=e=>{const t=document.querySelector(".selected-language-display"),a=document.querySelector(".Language-selector");if(!a)return;const n=a.querySelector('option[value="'.concat(e,'"]'));if(n){const e=n.textContent;t&&(t.textContent=e),L.updateWithParams({selectedLanguageDisplay:e})}},He=e=>{e||console.log("Retry initStickyHeaders");const t=document.querySelector(".settings-sidebar");if(!t||t.classList.contains("hidden"))return console.log("Sidebar not visible yet, retrying? ...",!e),void(e||setTimeout(()=>He(!0),1e3));const a=t.querySelector(".settings-sidebar-scrollable"),n=t.querySelector(".settings-headers-top-overlay"),r=t.querySelector(".settings-headers-bottom-overlay");if(!a||!n||!r)return void console.warn("Sidebar overlay elements not found:",{scrollContent:!!a,topOverlay:!!n,bottomOverlay:!!r});const i=[...a.querySelectorAll(".settings-section[data-title]")];if(0===i.length)return void console.warn("No sections with data-title found");let o=-1,s=-1;function l(){const e=a.getBoundingClientRect(),t=e.top,l=e.bottom;let c=0;const u=[];for(const a of i){if(!(a.getBoundingClientRect().top<=t+c+6))break;u.push(a),c+=44}u.length!==o&&(o=u.length,function(e){n.innerHTML="";let t=0;e.forEach(e=>{const r=document.createElement("div");r.className="overlay-header";let i=e.querySelector(".settings-section-header");i?r.innerHTML=i.innerHTML:r.textContent=e.dataset.title,r.onclick=()=>a.scrollTo({top:e.offsetTop-t-6,behavior:"smooth"}),n.appendChild(r),t+=44})}(u));let d=0;const _=[];for(let a=i.length-1;a>=u.length;a--){const e=i[a];if(!(e.getBoundingClientRect().top>=l-d-6))break;_.unshift(e),d+=44}var f;_.length!==s&&(s=_.length,f=_,r.innerHTML="",f.forEach(e=>{const t=document.createElement("div");t.className="overlay-header",t.textContent=e.dataset.title,t.onclick=()=>a.scrollTo({top:e.offsetTop-6,behavior:"smooth"}),r.appendChild(t)}))}a.updateOverlays=l,a.addEventListener("scroll",l,{passive:!0}),l()},qe=()=>{const e=document.querySelector(".settings-sidebar");if(!e)return;const t=e.querySelector(".settings-sidebar-scrollable");t&&t.updateOverlays&&(t.removeEventListener("scroll",t.updateOverlays),delete t.updateOverlays);const a=e.querySelector(".settings-headers-top-overlay"),n=e.querySelector(".settings-headers-bottom-overlay");a&&(a.innerHTML=""),n&&(n.innerHTML="")};function ze(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";const a=document.getElementById("apiTestResult");a&&(a.style.display="block",a.innerHTML=e,a.className="","success"===t?(a.style.backgroundColor="#d4edda",a.style.borderColor="#c3e6cb",a.style.color="#155724"):"error"===t?(a.style.backgroundColor="#f8d7da",a.style.borderColor="#f5c6cb",a.style.color="#721c24"):(a.style.backgroundColor="#d1ecf1",a.style.borderColor="#bee5eb",a.style.color="#0c5460"),setTimeout(()=>{a&&(a.style.display="none")},5e3))}window.generateApiSecret=async function(){document.getElementById("generateSecretBtn"),await ce.generateApiSecret()},window.testApiEndpoint=async function(){const e=L.data.uapi;if(!e)return void ze(re("d20251225_api_secret_error"),"error");const t=document.querySelector('[onclick="testApiEndpoint()"]');t&&(t.disabled=!0,t.textContent="Testing...");try{await ce.testTtsApi(e,"")?ze(re("d20251225_api_test_success"),"success"):ze(re("d20251225_api_test_error"),"error")}catch(error){console.error("Error testing API:",error),ze(re("d20251225_api_test_error"),"error")}finally{t&&(t.disabled=!1,t.textContent=re("d20251225_api_test_button"))}},window.toggleApiSecretVisibility=function(){const e=document.getElementById("apiSecretDisplay");e&&(e.type="password"===e.type?"text":"password")},window.copyToClipboard=function(e){const t=document.getElementById(e);if(!t)return;let a=t.textContent||t.innerText;const n=L.data.uapi;n&&(a=a.replace(/YOUR_SECRET_KEY/g,n));const r=document.querySelectorAll('button[onclick*="copyToClipboard"]');let i=null;for(const o of r)if(o.onclick&&o.onclick.toString().includes(e)){i=o;break}ce.copyToClipboard(a).then(e=>{if(e&&i){const e=i.textContent;i.textContent=re("d20251225_api_copied"),setTimeout(()=>{i.textContent=e},2e3)}}).catch(e=>{console.error("Error copying to clipboard:",e)})};let Ge=s.showModal,Xe=s.closeModal,je={removeGoogleVoices:()=>{i.TtsEngine.removeLocalGoogleVoices()},onUrlSubmitClick:function(){let e=document.getElementById("urlInput").value;if(e){e=e.trim(),e.toLowerCase().startsWith("https://")||e.toLowerCase().startsWith("http://")||(e="https://"+e);try{new URL(e)}catch(error){return void alert(re("app_js__invalid_url"))}}else e="https://en.wikipedia.org/wiki/The_Beatles";he(e),s.closeModals()},handleFileSelect:function(e){let t=e.target.files[0];console.log("got file ",t.name),function(e){switch(L.data.isPlayingOn&&te(),ee(),e.name.split(".")[e.name.split(".").length-1]){case"txt":case"json":case"rtf":case"csv":y.loadFile(e,e=>{Q(e,ue,"text/plain")});break;case"pdf":L.updateWithParams({isLoading:!0}),W.loadPdfFile(e,e=>{Q(e,ue,"html"),L.updateWithParams({isLoading:!1})},e=>{});break;case"epub":J.loadEpubFile(e,Q,e=>{},x);break;case"docx":oe.loadFile(e,e=>{Q(e,ue,"html")});break;case"html":se.loadFile(e,e=>{Q(e,ue,"html")});break;default:alert(re("alert_file_not_supported"))}}(t),e.target.value=""},toggleRepeatMode:function(){L.data.isRepeatMode?L.updateWithParams({isRepeatMode:!1}):L.updateWithParams({isRepeatMode:!0})},clearContent:ee,startRecording:function(){H.toggleCapture()},toggleRecord:function(){if(L.data.isRecordingOn)H.toggleCapture();else{var e;if(L.data.isPlayingOn&&Me(),!((null===(e=q())||void 0===e?void 0:e.trim())||""))return void Ge("emptyTextModal");s.showModal("recordOrExportModal")}},calculateStats:function(){let e=q()||"",t={isLongerThan200000Chars:e.length>2e5,isLongerThan2000Chars:e.length>2e3,charsCount:e.length,wordsCount:e.split(/\s+/).filter(e=>e.length>0).length,paragraphsCount:e.split(/\n+/).filter(e=>e.length>0).length,expectedDuration:z(e.length)};L.updateWithParams(t)},exportToMp3:async function(e){var t;let a=e.currentTarget.getAttribute("data-ws-params");console.log("exportToMp3 ",a);let n=(null===(t=q())||void 0===t?void 0:t.trim())||"";if(!n)return void Ge("emptyTextModal");n=S.cleanTextPreExport(n);const r=n.length;if(!L.data.isSignedIn)return alert(re("alert_requires_signin")),void window.signIn();if(!L.data.selectedVoiceUri||!L.data.selectedVoiceUri.trim())return alert("Please select a voice first."),void Pe();if(!O(L.data.selectedVoiceUri))return alert(re("alert_export_premium_voice")),void Pe();if(n.indexOf("{{set:")>-1){let e=!1;if(e)return alert("Export setters only supports premium voices. Please replace the following voices in setters with their Premium equivallents (Azure voices are premium as well): "+e),void Pe()}if(!C(r))return alert(re("alert_missing_credits")),void(L.data.isPremium?s.showModal("upgradeModal"):window.openNewUpgradeModal());if(r>2e5)return void alert(re("alert_export_too_long"));function o(e){const t=document.createElement("a");t.href=e,t.download="ttsreader_".concat(function(e){let t=e.slice(0,20);return t=t.replace(/[^a-zA-Z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").toLowerCase(),t||(t="file"),t=t.slice(0,10),"".concat(t)}(n.slice(0,20)),".").concat(a),document.body.appendChild(t),t.click(),document.body.removeChild(t),G()}let l=await window.getIdToken();if(n=function(e){return e.replace(/\{\{set:\s*lang\s*=\s*([^;]+);\s*name\s*=\s*([^;]+);\s*rate\s*=\s*([^;}]+);?\s*\}\}/g,(e,t,a,n)=>X(t.trim(),a.trim(),n.trim()))}(n),function(e,t){return!!(e.length>2e3||e.includes("{{set:"))||!(!t.includes(".gcp")||!e.includes("{{pause"))||!!function(e){if(e.toLowerCase().includes("azure.")||e.toLowerCase().includes("chirp.")||e.toLowerCase().includes("gcp."))return!0}(t)&&le(e,L.data.selectedLanguageCode,L.data.selectedVoiceUri,L.data.selectedRate)>300}(n,L.data.selectedVoiceUri)){let e="https://us-central1-ttsreader.cloudfunctions.net/functionTtsLong",t="http://127.0.0.1:5001/ttsreader/us-central1/functionTtsLong",a=!0&&window.location.href.includes("localhost")?t:e;Ge("uploadModal"),window.isWaitingForUploadConfirmation=!0;try{const e=JSON.stringify({text:n,lang:c.getBCP47code(L.data.selectedVoiceUri,L.data.selectedLanguageCode),voice:n.includes("{{set:")?(u=L.data.selectedVoiceUri,"ttsreaderServer.gcp.en-GB-Standard-D"===u?"ttsreaderServer.azure.en-GB-OllieMultilingualNeural":"ttsreaderServer.gcp.en-GB-Standard-N"===u?"ttsreaderServer.azure.en-US-ShimmerTurboMultilingualNeural":"ttsreaderServer.gcp.en-GB-Standard-A"===u?"ttsreaderServer.azure.en-GB-LibbyNeural":u):L.data.selectedVoiceUri,rate:L.data.selectedRate,shouldPodcast:Boolean(L.data.shouldPodcast)&&n.length>2e3}),t=await fetch(a,{method:"POST",headers:{Authorization:"Bearer ".concat(l),"Content-Type":"application/json"},body:e});if(Xe("uploadModal"),window.isWaitingForUploadConfirmation){if(!t.ok){window.isWaitingForUploadConfirmation=!1;const e=await t.text();return void alert("TTS upload job failed. ".concat(t.status," ").concat(t.statusText," - ").concat(e))}window.isWaitingForUploadConfirmation=!1,window.openOrCloseExportsListModal();Math.floor(7*r/1500);const e=(await t.text()||"").trim();e?o(e):alert(re("app_js__processing_finished"))}}catch(error){Xe("uploadModal"),window.isWaitingForUploadConfirmation=!1,L.updateWithParams({isUploading:!1}),alert("TTS upload job failed. ".concat(error.message))}}else{if(n.length>6e3)return void alert(re("alert_export_limited"));!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;const t=document.getElementById("processingModal"),a=document.getElementById("processingTimer");t.style.display="flex",clearInterval(V);let n=e;function r(){const e=String(Math.floor(n/60)).padStart(2,"0"),t=String(n%60).padStart(2,"0");a.textContent="".concat(e,":").concat(t),n<=0&&(clearInterval(V),a.textContent="Still working..."),n--}r(),V=setInterval(r,1e3)}(10+Math.floor(30*r/5e3)),i.TtsEngine.generateAudioSync({text:n,voiceURI:L.data.selectedVoiceUri,rate:L.data.selectedRate,langBCP47:c.getBCP47code(L.data.selectedVoiceUri,L.data.selectedLanguageCode)},l,async e=>{if("wav"===a){const t=await ie.convertMp3BlobUrlToWav(e);e=URL.createObjectURL(t)}o(e)},e=>{!function(e){console.error("Export error:",e),alert(re("alert_export_error")+" "+e.message),G()}(e)},{quality:"48khz_192kbps"})}var u},togglePlay:te,goToStart:e=>{Me(),l&&Z(0,0),L.updateWithParams({caretPosition:ue}),be(w,L.data.caretPosition,!0)},goToCaret:e=>{console.log("TODO...")},rewind:e=>{ye(L.data.caretPosition.node,-1)},forward:e=>{ye(L.data.caretPosition.node,1)},loadNextChapter:function(){we(1)},loadPrevChapter:function(){we(-1)},onPasteToEditor:function(e){E||j()},onRateChange:e=>{let t=e.currentTarget.value,a=function(e){let t=0;if(p[0]==e)return g[0];for(;t<p.length&&p[t+1]<=e;)t++;return g[t]}(t);L.updateWithParams({selectedRateSliderValue:t,selectedRate:a})},slower:e=>{Ee(!0)},faster:e=>{Ee(!1)},fontIncrease:e=>{Ae(1.1)},fontDecrease:e=>{Ae(1/1.1)},setVoiceUriDirectly:e=>{let t={voiceURI:e,name:e,lang:L.get("selectedLanguageCode")},a=i.TtsEngine.setBestMatchingVoice(t);console.log("Setting voice URI directly to: ",a);let n=h(t,0,L.data.selectedLanguageCode);L.updateWithParams({selectedVoiceUri:e,voiceLabel:n})},selectVoice:e=>{let t=e.closest("[data-ws-voiceURI]").getAttribute("data-ws-voiceURI")||e.getAttribute("value");i.TtsEngine.setBestMatchingVoice(null,t,"");let a=h(i.TtsEngine.voice,0,L.data.selectedLanguageCode);L.updateWithParams({selectedVoiceUri:t,voiceLabel:a,isToWelcome:!1}),document.querySelector(".Modal").style.display="none"},testVoice:(e,t)=>{let a;L.get("isPlayingOn")&&te(),Be();let r=e.closest("[data-ws-voiceURI]");if(t)a=t;else{if(!e)return;r=e.closest("[data-ws-voiceURI]"),a=r.getAttribute("data-ws-voiceURI")||e.getAttribute("value")}if(a.startsWith("ttsreader")&&(!We(a)||c.doCodesShareLanguage(L.data.selectedLanguageCode,(e=>{let t=e.split(".");return t[t.length-1].split("-")[0]})(a)))){if(Te.src.includes(a)&&!Te.paused&&!Te.ended)return void Te.pause();try{return Te.pause(),Te.src="/audio/"+a+".mp3",Te.currentTime=0,void Te.play().then(()=>{console.log("Audio test playback started..."),r.classList.add("isPlaying")}).catch(e=>{console.log("Audio play error: ",e),Te.pause();let t=i.TtsEngine.setBestMatchingVoice(null,a,"");i.TtsEngine.setRate(L.data.selectedRate);let r=n("nice_to_meet_you",L.data.selectedLanguageCode);fe({text:r,voiceURI:t,langBCP47:c.getBCP47code(t,L.data.selectedLanguageCode),rate:L.data.selectedRate,isTest:!0})})}catch(l){console.log("Audio not found... playing via TTS engine",l)}}Te.pause();let o=i.TtsEngine.setBestMatchingVoice(null,a,"");i.TtsEngine.setRate(L.data.selectedRate);let s=n("nice_to_meet_you",L.data.selectedLanguageCode);fe({text:s,voiceURI:o,langBCP47:c.getBCP47code(o,L.data.selectedLanguageCode),rate:L.data.selectedRate,isTest:!0})},stopAnyTestOrOtherPlay:()=>{Te.pause(),Me(),Be()},copyVoice:e=>{let t=e.closest("[data-ws-voiceName]"),a=t.getAttribute("data-ws-voiceName")||e.getAttribute("value");t.getAttribute("data-ws-voiceURI")&&t.getAttribute("data-ws-voiceURI").startsWith("azure.")&&!a.startsWith("azure.")&&!a.startsWith("ttsreader.")&&(a="azure."+a);let n="\n{{set: lang="+L.data.selectedLanguageCode+"; name="+a+"; rate="+L.data.selectedRate+";}}\n";navigator.clipboard.writeText(n).then(e=>{s.closeModals(),alert(re("alert_copied")+"\n"+n+"\n\n"+re("alert_paste_to_editor"))})},handleVoiceChange:Re,handleLanguageChange:xe,onInputToEditor:function(e){E||j()},showModal:Ge,closeModal:Xe,isVoicePremium:O,handleVoiceLabelClick:Pe,toggleSettingsSidebar:ke,closeSettingsSidebar:()=>{L.updateWithParams({isSettingsSidebarOpen:!1}),qe()},populateSidebarLanguages:Ie,populateSidebarVoices:Le,filterVoices:e=>{document.querySelectorAll(".voice-filter-btn").forEach(e=>{e.classList.remove("active")}),e.currentTarget.classList.add("active"),Le()},openLanguageSelector:()=>{const e=document.getElementById("unifiedLanguageSelector");if(!e)return;const t=e.querySelector(".language-selector-closed"),a=e.querySelector(".language-selector-open"),n=e.querySelector(".language-search-input");t.classList.add("hidden"),a.classList.remove("hidden"),Ne(),setTimeout(()=>n.focus(),100),setTimeout(()=>{document.addEventListener("click",De)},100)},closeLanguageSelector:Ce,selectUnifiedLanguage:Ue,filterUnifiedLanguages:e=>{const t=e.currentTarget.value.toLowerCase().trim(),a=document.getElementById("languageDropdown");if(!a)return;const n=JSON.parse(a.dataset.languageData||"[]");if(!t)return void Fe(n);const r=n.filter(e=>e.searchTerms.includes(t));Fe(r)},scrollToSection:e=>{const t=e.currentTarget.getAttribute("data-section"),a=document.getElementById(t),n=document.querySelector(".settings-sidebar"),r=null===n||void 0===n?void 0:n.querySelector(".settings-sidebar-scrollable");if(!a||!r)return;r.scrollTo({top:a.offsetTop-6,behavior:"smooth"});const i=e.currentTarget;i.style.transform="scale(0.98)",setTimeout(()=>{i.style.transform=""},150)},initStickyHeaders:He,handleStickyHeaders:()=>{},cleanupStickyHeaders:qe,testOverlayHeaders:()=>{console.log("\ud83e\uddea Testing overlay headers...");const e=document.querySelector(".settings-sidebar"),t=null===e||void 0===e?void 0:e.querySelector(".settings-sidebar-scrollable"),a=null===e||void 0===e?void 0:e.querySelector(".settings-headers-top-overlay"),n=null===e||void 0===e?void 0:e.querySelector(".settings-headers-bottom-overlay"),r=e?[...e.querySelectorAll(".settings-section[data-title]")]:[];console.log("Elements found:",{sidebar:!!e,sidebarHidden:null===e||void 0===e?void 0:e.classList.contains("hidden"),scrollContent:!!t,topOverlay:!!a,bottomOverlay:!!n,sectionsCount:r.length}),r.length>0&&console.log("Sections:",r.map(e=>({title:e.dataset.title,offsetTop:e.offsetTop,rect:e.getBoundingClientRect()}))),a&&r.length>0&&(a.innerHTML='<div class="overlay-section-header">\ud83e\uddea Test Header</div>',console.log("\u2705 Test header added to top overlay")),He()}};window.appMethods=je,s.init(L,je);const We=e=>e.toLowerCase().indexOf("multilingual")>=0||e.toLowerCase().indexOf("chirp")>=0,Ye={onInit:e=>{if(L.data.ttsReady)return;console.log("tts initiated"),L.get("wasEverClicked")&&N();let t,a=function(e){e=e||[];let t=["af-ZA","am-ET","ar-EG","ar-SA","az-AZ","bg-BG","bn-BD","bn-IN","bs-BA","ca-ES","cs-CZ","cy-GB","da-DK","de-AT","de-CH","de-DE","el-GR","en-AU","en-CA","en-GB","en-IE","en-IN","en-US","es-ES","es-MX","et-EE","eu-ES","fa-IR","fi-FI","fil-PH","fr-BE","fr-CA","fr-CH","fr-FR","ga-IE","gl-ES","he-IL","hi-IN","hr-HR","hu-HU","hy-AM","id-ID","is-IS","it-IT","ja-JP","jv-ID","ka-GE","kk-KZ","km-KH","kn-IN","ko-KR","lo-LA","lt-LT","lv-LV","mk-MK","ml-IN","mn-MN","ms-MY","mt-MT","my-MM","nb-NO","ne-NP","nl-BE","nl-NL","pl-PL","ps-AF","pt-BR","pt-PT","ro-RO","ru-RU","si-LK","sk-SK","sl-SI","so-SO","sq-AL","sr-RS","su-ID","sv-SE","sw-KE","ta-IN","te-IN","th-TH","tr-TR","uk-UA","ur-PK","uz-UZ","vi-VN","zh-CN","zh-HK","zh-TW","zu-ZA"];const a={"af-ZA":"Afrikaans (Suid-Afrika)","am-ET":"\u12a0\u121b\u122d\u129b (\u12a2\u1275\u12ee\u1335\u12eb)","ar-EG":"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0645\u0635\u0631)","ar-SA":"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0645\u0645\u0644\u0643\u0629 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629)","az-AZ":"Az\u0259rbaycan (lat\u0131n, Az\u0259rbaycan)","bg-BG":"\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438 (\u0411\u044a\u043b\u0433\u0430\u0440\u0438\u044f)","bn-BD":"\u09ac\u09be\u0982\u09b2\u09be (\u09ac\u09be\u0982\u09b2\u09be\u09a6\u09c7\u09b6)","bn-IN":"\u09ac\u09be\u0982\u09b2\u09be (\u09ad\u09be\u09b0\u09a4)","bs-BA":"Bosanski (Bosna i Hercegovina)","ca-ES":"Catal\xe0 (Espanya)","cs-CZ":"\u010ce\u0161tina (\u010cesko)","cy-GB":"Cymraeg (Y Deyrnas Unedig)","da-DK":"Dansk (Danmark)","de-AT":"Deutsch (\xd6sterreich)","de-CH":"Deutsch (Schweiz)","de-DE":"Deutsch (Deutschland)","el-GR":"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac (\u0395\u03bb\u03bb\u03ac\u03b4\u03b1)","en-AU":"English (Australia)","en-CA":"English (Canada)","en-GB":"English (United Kingdom)","en-IE":"English (Ireland)","en-IN":"English (India)","en-US":"English (United States)","es-ES":"Espa\xf1ol (Espa\xf1a)","es-MX":"Espa\xf1ol (M\xe9xico)","et-EE":"Eesti (Eesti)","eu-ES":"Euskara (Espainia)","fa-IR":"\u0641\u0627\u0631\u0633\u06cc (\u0627\u06cc\u0631\u0627\u0646)","fi-FI":"Suomi (Suomi)","fil-PH":"Filipino (Pilipinas)","fr-BE":"Fran\xe7ais (Belgique)","fr-CA":"Fran\xe7ais (Canada)","fr-CH":"Fran\xe7ais (Suisse)","fr-FR":"Fran\xe7ais (France)","ga-IE":"Gaeilge (\xc9ire)","gl-ES":"Galego (Espa\xf1a)","he-IL":"\u05e2\u05d1\u05e8\u05d9\u05ea (\u05d9\u05e9\u05e8\u05d0\u05dc)","hi-IN":"\u0939\u093f\u0928\u094d\u0926\u0940 (\u092d\u093e\u0930\u0924)","hr-HR":"Hrvatski (Hrvatska)","hu-HU":"Magyar (Magyarorsz\xe1g)","hy-AM":"\u0540\u0561\u0575\u0565\u0580\u0565\u0576 (\u0540\u0561\u0575\u0561\u057d\u057f\u0561\u0576)","id-ID":"Indonesia (Indonesia)","is-IS":"\xcdslenska (\xcdsland)","it-IT":"Italiano (Italia)","ja-JP":"\u65e5\u672c\u8a9e (\u65e5\u672c)","jv-ID":"Basa jawa (Indonesia)","ka-GE":"\u10e5\u10d0\u10e0\u10d7\u10e3\u10da\u10d8 (\u10e1\u10d0\u10e5\u10d0\u10e0\u10d7\u10d5\u10d4\u10da\u10dd)","kk-KZ":"\u049a\u0430\u0437\u0430\u049b \u0442\u0456\u043b\u0456 (\u049a\u0430\u0437\u0430\u049b\u0441\u0442\u0430\u043d)","km-KH":"\u1781\u17d2\u1798\u17c2\u179a (\u1780\u1798\u17d2\u1796\u17bb\u1787\u17b6)","kn-IN":"\u0c95\u0ca8\u0ccd\u0ca8\u0ca1 (\u0cad\u0cbe\u0cb0\u0ca4)","ko-KR":"\ud55c\uad6d\uc5b4 (\ub300\ud55c\ubbfc\uad6d)","lo-LA":"\u0ea5\u0eb2\u0ea7 (\u0eaa.\u0e9b.\u0e9b \u0ea5\u0eb2\u0ea7)","lt-LT":"Lietuvi\u0173 (Lietuva)","lv-LV":"Latvie\u0161u (Latvija)","mk-MK":"\u041c\u0430\u043a\u0435\u0434\u043e\u043d\u0441\u043a\u0438 (\u0421\u0435\u0432\u0435\u0440\u043d\u0430 \u041c\u0430\u043a\u0435\u0434\u043e\u043d\u0438\u0458\u0430)","ml-IN":"\u0d2e\u0d32\u0d2f\u0d3e\u0d33\u0d02 (\u0d07\u0d28\u0d4d\u0d24\u0d4d\u0d2f)","mn-MN":"\u041c\u043e\u043d\u0433\u043e\u043b (\u041c\u043e\u043d\u0433\u043e\u043b)","ms-MY":"Melayu (Malaysia)","mt-MT":"Malti (Malta)","my-MM":"\u1019\u103c\u1014\u103a\u1019\u102c (\u1019\u103c\u1014\u103a\u1019\u102c)","nb-NO":"Norsk bokm\xe5l (Norge)","ne-NP":"\u0928\u0947\u092a\u093e\u0932\u0940 (\u0928\u0947\u092a\u093e\u0932)","nl-BE":"Nederlands (Belgi\xeb)","nl-NL":"Nederlands (Nederland)","pl-PL":"Polski (Polska)","ps-AF":"\u067e\u069a\u062a\u0648 (\u0627\u0641\u063a\u0627\u0646\u0633\u062a\u0627\u0646)","pt-BR":"Portugu\xeas (Brasil)","pt-PT":"Portugu\xeas (Portugal)","ro-RO":"Rom\xe2n\u0103 (Rom\xe2nia)","ru-RU":"\u0420\u0443\u0441\u0441\u043a\u0438\u0439 (\u0420\u043e\u0441\u0441\u0438\u044f)","si-LK":"\u0dc3\u0dd2\u0d82\u0dc4\u0dbd (\u0dc1\u0dca\u200d\u0dbb\u0dd3 \u0dbd\u0d82\u0d9a\u0dcf\u0dc0)","sk-SK":"Sloven\u010dina (Slovensko)","sl-SI":"Sloven\u0161\u010dina (Slovenija)","so-SO":"Soomaali (Soomaaliya)","sq-AL":"Shqip (Shqip\xebri)","sr-RS":"\u0421\u0440\u043f\u0441\u043a\u0438 (\u0421\u0440\u0431\u0438\u0458\u0430)","su-ID":"Basa sunda (Indonesia)","sv-SE":"Svenska (Sverige)","sw-KE":"Kiswahili (Kenya)","ta-IN":"\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe)","te-IN":"\u0c24\u0c46\u0c32\u0c41\u0c17\u0c41 (\u0c2d\u0c3e\u0c30\u0c24\u0c26\u0c47\u0c36\u0c02)","th-TH":"\u0e44\u0e17\u0e22 (\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28\u0e44\u0e17\u0e22)","tr-TR":"T\xfcrk\xe7e (T\xfcrkiye)","uk-UA":"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430 (\u0423\u043a\u0440\u0430\u0457\u043d\u0430)","ur-PK":"\u0627\u0631\u062f\u0648 (\u067e\u0627\u06a9\u0633\u062a\u0627\u0646)","uz-UZ":"O\u2018zbek (O\u2018zbekiston)","vi-VN":"Ti\u1ebfng Vi\u1ec7t (Vi\u1ec7t Nam)","zh-CN":"\u4e2d\u6587 (\u4e2d\u56fd)","zh-HK":"\u7cb5\u8a9e (\u9999\u6e2f) - Cantonese","zh-TW":"\u4e2d\u6587 (\u53f0\u7063)","zu-ZA":"Isizulu (iNingizimu Afrika)"};let n=[];for(const i of e){let e=i.lang;n.includes(e)||n.push(e)}for(const i of t)n.includes(i)||n.push(i);let r=[];return n.forEach(e=>{let t=c.codeToName(e,"native");(!t||t.toLowerCase()===e.toLowerCase()&&a[e])&&(t=a[e]),r.push([e,t])}),r.sort((e,t)=>e[1]>t[1]?1:e[1]==t[1]?0:-1),r}(e);((e,t)=>{for(const a of e){let e=a[0],n=d(e,t);if(n&&0!==n.length){B[e]||(B[e]={});for(const t of n)B[e][_(t)]=t.voiceURI}}})([...a,["en","English"],["es","Spanish"],["i18n","Multilingual"]],e);let n=L.get("selectedLanguageCode");["he","ar","de","fr","it","ja","pt","hi","ko","zh","ro","ru","nl"].includes(n)&&(n=c.mapLanguageToDefaultLocale[n]),(n.startsWith("he")||n.startsWith("ar"))&&(document.querySelector(".Text-box").style.direction="rtl");L.get("selectedVoiceUri")||xe({currentTarget:{value:n}}),t=i.TtsEngine.setBestMatchingVoice(null,L.get("selectedVoiceUri"),L.get("selectedLanguageCode")),n&&We(i.TtsEngine.voice.voiceURI)||(n=i.TtsEngine.voice.lang),c.areCodesEqual(n,"en-US")||c.areCodesEqual(n,"en-GB")?n="en":c.doCodesShareLanguage(n,"es")&&(n="es");let r={he:"he-IL",ko:"ko-KR",ja:"ja-JP",ar:"ar-EG",zh:"zh-CN",hi:"hi-IN",nl:"nl-NL",de:"de-DE",fr:"fr-FR",it:"it-IT",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU"};r[n]&&(n=r[n]);let o=document.querySelector(".Language-selector");if(o){let e;e=document.createElement("option"),e.value="en",e.innerHTML="<span>"+c.codeToFlag("en-US")+"</span><span>"+c.codeToFlag("en-GB")+"</span>&nbsp;English",o.appendChild(e),e=document.createElement("option"),e.value="es",e.innerHTML="<span>"+c.codeToFlag("es-ES")+"</span>&nbsp;Espa\xf1ol",o.appendChild(e),e=document.createElement("option"),e.value="",e.innerHTML="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500",e.setAttribute("disabled",!0),o.appendChild(e);for(const t of a){if(c.areCodesEqual(t[0],"en-US")||c.areCodesEqual(t[0],"en-GB")||c.doCodesShareLanguage(t[0],"es"))continue;let e=document.createElement("option");e.value=t[0],e.innerHTML=c.codeToFlag(t[0])+"&nbsp;"+t[1],o.appendChild(e)}}for(const i of document.querySelectorAll(".Language-selector"))i!==o&&(i.innerHTML=o.innerHTML);ge(n,e);let s=h(i.TtsEngine.voice,0,n);L.updateWithParams({ttsReady:!0,selectedVoiceUri:i.TtsEngine.voice.voiceURI,selectedLanguageCode:n,voiceLabel:s,selectedLanguageFlag:c.codeToFlag(n)}),Ie(),Le()},onVoicesChanged:e=>{let t=L.get("selectedVoiceUri"),a=ge(L.get("selectedLanguageCode"),e,t);for(const n of e)if(n.voiceURI===t)return;i.TtsEngine.setBestMatchingVoice(a),L.updateWithParams({selectedVoiceUri:a.voiceURI,voiceLabel:h(a)})},onDone:()=>{if(console.log("onDone"),l||document.querySelectorAll(".Highlight").forEach(e=>{let t=document.createTextNode(e.textContent);e.replaceWith(t)}),L.data.isPlayingOn){let t;if(l){let a=Y();t=a?{node:a.lineIndex,charStart:a.localOffset,charEnd:a.localOffset}:(0,e.A)((0,e.A)({},L.data.caretPosition),{},{charStart:L.data.caretPosition.charEnd})}else t=(0,e.A)((0,e.A)({},L.data.caretPosition),{},{charStart:L.data.caretPosition.charEnd});L.updateWithParams({caretPosition:t}),_e(document.querySelector(".Text-box"),t)}else Se(w,L.data.caretPosition)},onStart:()=>{L.get("isPlayingOn")&&(w instanceof HTMLTextAreaElement&&!w.value||w instanceof HTMLDivElement&&!w.innerText||be(w,L.data.caretPosition))},onError:e=>{if(console.error("ttsListener.onError: ",e),L.get("isPlayingOn"))if(429===e)Me(),alert(re("alert_quota_reached")),window.openNewUpgradeModal();else{let t="tts_error";e?e.toString().toLowerCase().indexOf("buffer")>=0?t+="/buffer":e.toString().toLowerCase().indexOf("sources")>=0?t+="/source":e.toString().toLowerCase().indexOf("not allowed")>=0?t+="/not_allowed":e.toString().toLowerCase().indexOf("supported")>=0&&(t+="/not_supported"):(t+="/unknown",e=""),window.sendLogsToFb&&window.sendLogsToFb(L.get("uid")||"anonym",t,{err:(""+e).replace("Audio playback failed with ",""),voice:L.get("selectedLanguageCode")+":"+L.get("selectedVoiceUri"),isPremium:L.get("isPremium")})}}};i.TtsEngine.init(Ye,!0,function(){return L.get("isPlayingOn")})};window.wsGlobals||(window.wsGlobals={});let fe=Date.now();function he(){return Math.round((Date.now()-fe)/1e3)+": "}function me(){_e()}"loading"===document.readyState?(console.log(he()+"Script awaiting to load all DOM"),window.addEventListener("DOMContentLoaded",e=>{me()})):(console.log(he()+"Loading script right away"),me())})()})();
//# sourceMappingURL=main.43919c59.js.map