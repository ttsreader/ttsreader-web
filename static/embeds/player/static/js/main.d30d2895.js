!function(){var e={800:function(e,t,n){var a=n(704).default;function r(e){return null==e||e.length<2?"":e.toLowerCase().split("-")[0].split("_")[0]}function i(e,t){return r(e)==r(t)}t.TtsEngine={DEFAULT_LANG:"en",voice:{},voices:[],rate:1,utteranceId:0,startedAndNotTerminatedCounter:0,listener:null,utterance:{},_googleBugTimeout:null,_speakTimeout:null,_canceledAtMs:0,init:function(e){var t=this;e&&(this.listener=e),this._populateVoices(),speechSynthesis.onvoiceschanged=function(){t._populateVoices()}},setListener:function(e){this.listener=e},setBestMatchingVoice:function(e,t,n){if(null==this.voices||0==this.voices.length)return"";if(e&&e.voiceURI||t||n||(this.voice&&this.voice.voiceURI?t=this.voice.voiceURI:n=this.DEFAULT_LANG),e&&(t=e.voiceURI||t),t){var r,o=a(this.voices);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(s.voiceURI==t)return this.voice=s,s.voiceURI}}catch(y){o.e(y)}finally{o.f()}}if(n){if(this.voice&&i(this.voice.lang,n))return this.voice.voiceURI;var l=this.voices.filter((function(e){return i(e.lang,n)}));if(l&&l.length>0){if(1==l.length)return this.voice=l[0],this.voice.voiceURI;if(!n.startsWith("en")&&!n.startsWith("es"))return this.voice=l[0],this.voice.voiceURI;var c,u,d=-1,h=a(l);try{for(h.s();!(u=h.n()).done;){var f=u.value,g=0;f.localService&&(g+=1.5),2==f.lang.length?g+=3:-1!=["en-us","en-uk","en-gb","es-es"].indexOf(f.lang.toLowerCase().replace("_","-"))?g+=4:-1==["en-in"].indexOf(f.lang.toLowerCase().replace("_","-"))&&(g+=2),console.log("score: "+g+" for: ",f),g>d&&(d=g,c=f)}}catch(y){h.e(y)}finally{h.f()}if(c)return this.voice=c,this.voice.voiceURI}}var p,v=a(this.voices);try{for(v.s();!(p=v.n()).done;){var m=p.value;if(this.voice=m,m.localService)return m.voiceURI}}catch(y){v.e(y)}finally{v.f()}return this.voice.voiceURI},_populateVoices:function(){var e=window.speechSynthesis.getVoices();e&&e.length>0&&(this.voices=e.filter((function(e){if(!e.voiceURI.includes("com.apple.eloquence")&&!e.voiceURI.includes("com.apple.speech.synthesis"))return e})),this.setBestMatchingVoice(this.voice,null,null),this.listener&&this.listener.onInit&&this.listener.onInit(this.voices))},setVoiceByUri:function(e){this.setBestMatchingVoice(null,e,null)},getVoiceURI:function(){return this.voice||this.setBestMatchingVoice(),this.voice?this.voice.voiceURI:""},setRate:function(e){"string"==typeof e&&(e=Number(e)),isNaN(e)||(e<.1&&(e=.1),e>4&&(e=4),this.rate=e)},isInitiated:function(){return null!=this.voices},_defaultOnStart:function(e){this.startedAndNotTerminatedCounter++,this._solveChromeBug()},_defaultOnEnd:function(e){this.startedAndNotTerminatedCounter>0&&this.startedAndNotTerminatedCounter--,this._clearUtteranceTimeouts()},_defaultOnError:function(e){this.startedAndNotTerminatedCounter>0&&this.startedAndNotTerminatedCounter--,this._clearUtteranceTimeouts()},_clearUtteranceTimeouts:function(){null!=this._googleBugTimeout&&(window.clearTimeout(this._googleBugTimeout),this._googleBugTimeout=null)},_solveChromeBug:function(){if(this.voice&&-1!==this.voice.voiceURI.toLowerCase().indexOf("google")){this._clearUtteranceTimeouts();var e=this;this._googleBugTimeout=window.setTimeout((function(){window.speechSynthesis.pause(),window.speechSynthesis.resume(),e._solveChromeBug()}),1e4)}},_prepareTextForSynthesis:function(e){var t=e;return(t=(t=t.replace("\xb7",", ")).replace("- ",", ")).trim(),t},speakOut:function(e){var t=this;if(this.startedAndNotTerminatedCounter>0||window.speechSynthesis.paused||window.speechSynthesis.pending||window.speechSynthesis.speaking)return console.log("tts - ronen1"),this.stop(),void(this._speakTimeout=window.setTimeout((function(){t.speakOut(e)}),200));if(e){if(e=this._prepareTextForSynthesis(e),!this.isInitiated())return!1;this.utteranceId++;var n=new SpeechSynthesisUtterance;this.utterance=n,n.text=e,null==this.voice&&this.setBestMatchingVoice(null,null,null),this.voice&&(n.lang=this.voice.lang,n.voiceURI=this.voice.voiceURI,n.voice=this.voice),n.rate=this.rate;var a=this;n.onmark=function(e){console.log("onmark ",e)},n.onstart=function(e){console.log("onstart ",e),a._defaultOnStart(e),a.listener&&a.listener.onStart&&a.listener.onStart()},n.onboundary=function(e){console.log("onboundary: "+e.name+" boundary reached after "+e.elapsedTime+" milliseconds.",e)},n.onend=function(e){a._defaultOnEnd(e),a.listener&&a.listener.onDone&&a.listener.onDone(),n=null},n.onerror=function(e){a._defaultOnError(e),n=null},console.log("tts - ronen right away"),this._speakUtterance(n)}else this.utterance&&this.utterance.onend()},stop:function(){null!=this._speakTimeout&&(window.clearTimeout(this._speakTimeout),this._speakTimeout=null),window.speechSynthesis.cancel(),this.startedAndNotTerminatedCounter=0,this._canceledAtMs=Date.now()},_speakUtterance:function(e){null!=this._speakTimeout&&(window.clearTimeout(this._speakTimeout),this._speakTimeout=null),window.speechSynthesis.paused&&window.speechSynthesis.resume(),Date.now()-this._canceledAtMs>100?window.speechSynthesis.speak(e):this._speakTimeout=window.setTimeout((function(){window.speechSynthesis.speak(e)}),200)}}},816:function(e,t,n){t.TtsEngine=n(800).TtsEngine},897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a},e.exports.__esModule=!0,e.exports.default=e.exports},704:function(e,t,n){var a=n(116);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},116:function(e,t,n){var a=n(897);e.exports=function(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function t(t,n){if(t){if("string"===typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,n):void 0}}function a(e,n){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=t(e))||n&&e&&"number"===typeof e.length){a&&(e=a);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw o}}}}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function o(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=n(816);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function h(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var f=function(){function e(t){var n=this;u(this,e),this.data={},this.listeners=[],this.effects=[],this.get=function(e){return n.data.hasOwnProperty(e)?n.data[e]:null},this.updateWithParams=function(e){e&&e instanceof Object&&(n.data=l(l({},n.data),e));var t,r=a(n.effects);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.data=l(l({},n.data),i(n.data))}}catch(c){r.e(c)}finally{r.f()}var o,s=a(n.listeners);try{for(s.s();!(o=s.n()).done;){(0,o.value)(n.data)}}catch(c){s.e(c)}finally{s.f()}},this.addChangeListener=function(e){e&&e instanceof Function&&(n.listeners.push(e),e(n.data))},this.addEffect=function(e){e&&e instanceof Function&&n.effects.push(e)},this.updateWithParams(t)}return h(e,null,[{key:"getOs",value:function(){if(!window.navigator)return"unknown";var e=(navigator.userAgent+" "+navigator.platform+" "+navigator.userAgentData).toLowerCase();return/android/i.test(e)?"android":/mac/i.test(e)&&"ontouchend"in document||/ipad|iphone|ipod|ios/i.test(e)?"ios":/mac/i.test(e)?"mac":/win/i.test(e)?"win":"unknown"}}]),e}(),g=h((function e(){u(this,e)}));g.init=function(e,t,n){if(t)for(var a=function(){var e=i[r],n=document.querySelectorAll("["+e+"]");n&&n.forEach((function(n){var a=n.getAttribute(e);a&&t[a]instanceof Function&&n.addEventListener(e.substr(10).toLowerCase(),(function(e){t[a](e)}))}))},r=0,i=["data-ws-onClick","data-ws-onPaste","data-ws-onChange","data-ws-onInput"];r<i.length;r++)a();e&&e.addChangeListener&&e.addChangeListener((function(e){console.log("received updated state on dom hooks: ",e),document.querySelectorAll("[data-ws-value-state]").forEach((function(t){var n=t.getAttribute("data-ws-value-state"),a=e[n];null!==a&&void 0!==a&&(t.value=a)})),document.querySelectorAll("[data-ws-label-state]").forEach((function(t){var n=t.getAttribute("data-ws-label-state"),a=e[n];null!==a&&void 0!==a&&(t.innerHTML=a)})),document.querySelectorAll("[data-ws-style-state]").forEach((function(t){var n=t.getAttribute("data-ws-style-state").split("="),a=n[0],r=n[1],i=e[r];null!==i&&void 0!==i&&(t.style[a]=i)})),document.querySelectorAll("[data-ws-show-if-state]").forEach((function(t){var n=t.getAttribute("data-ws-show-if-state");if(n){var a=(n=n.split("="))[0],r=n[1];"false"===r?e[a]?t.classList.add("hidden"):t.classList.remove("hidden"):"true"===r?e[a]?t.classList.remove("hidden"):t.classList.add("hidden"):r===""+e[a]?t.classList.remove("hidden"):t.classList.add("hidden")}})),document.querySelectorAll("[data-ws-select-if-state]").forEach((function(t){var n=t.getAttribute("data-ws-select-if-state");if(n){var a=(n=n.split("="))[0],r=n[1];"false"===r?e[a]?t.removeAttribute("selected"):t.setAttribute("selected",!0):"true"===r?e[a]?t.setAttribute("selected",!0):t.removeAttribute("selected"):r===""+e[a]?t.setAttribute("selected",!0):t.removeAttribute("selected")}}))})),document.querySelectorAll("[data-ws-toggle]").forEach((function(e){e.addEventListener("click",(function(t){var n=document.querySelector(e.getAttribute("data-ws-toggle"));n&&("none"===getComputedStyle(n).display?n.style.display="":n.style.display="none")}))}))},g.showModal=function(e){g.closeModals();var t=document.getElementById(e);t&&(t.style.display="")},g.closeModals=function(){document.querySelectorAll(".Modal").forEach((function(e){e.style.display="none"}))};var p={allLocales:[["Afrikaans (Suid-Afrika)","af-ZA","Afrikaans (South Africa)"],["\u12a0\u121b\u122d\u129b (\u12a2\u1275\u12ee\u1335\u12eb)","am-ET","Amharic (Ethiopia)"],["\u0540\u0561\u0575 (\u0540\u0561\u0575\u0561\u057d\u057f\u0561\u0576)","hy-AM","Armenian (Armenia)"],["Az\u0259rbaycan (Az\u0259rbaycan)","az-AZ","Azerbaijani (Azerbaijan)"],["Bahasa Indonesia (Indonesia)","id-ID","Indonesian (Indonesia)",1],["Bahasa Melayu (Malaysia)","ms-MY","Malay (Malaysia)"],["\u09ac\u09be\u0982\u09b2\u09be (\u09ac\u09be\u0982\u09b2\u09be\u09a6\u09c7\u09b6)","bn-BD","Bengali (Bangladesh)",1],["\u09ac\u09be\u0982\u09b2\u09be (\u09ad\u09be\u09b0\u09a4)","bn-IN","Bengali (India)"],["Catal\xe0 (Espanya)","ca-ES","Catalan (Spain)"],["\u010ce\u0161tina (\u010cesk\xe1 republika)","cs-CZ","Czech (Czech Republic)"],["Dansk (Danmark)","da-DK","Danish (Denmark)"],["Deutsch (Deutschland)","de-DE","German (Germany)"],["English (Australia)","en-AU","English (Australia)"],["English (Canada)","en-CA","English (Canada)"],["English (Ghana)","en-GH","English (Ghana)"],["English (Great Britain)","en-GB","English (United Kingdom)"],["English (India)","en-IN","English (India)"],["English (Ireland)","en-IE","English (Ireland)"],["English (Kenya)","en-KE","English (Kenya)"],["English (New Zealand)","en-NZ","English (New Zealand)"],["English (Nigeria)","en-NG","English (Nigeria)"],["English (Philippines)","en-PH","English (Philippines)"],["English (Singapore)","en-SG","English (Singapore)"],["English (South Africa)","en-ZA","English (South Africa)"],["English (Tanzania)","en-TZ","English (Tanzania)"],["English (United States)","en-US","English (United States)",1],["Espa\xf1ol (Argentina)","es-AR","Spanish (Argentina)"],["Espa\xf1ol (Bolivia)","es-BO","Spanish (Bolivia)"],["Espa\xf1ol (Chile)","es-CL","Spanish (Chile)"],["Espa\xf1ol (Colombia)","es-CO","Spanish (Colombia)"],["Espa\xf1ol (Costa Rica)","es-CR","Spanish (Costa Rica)"],["Espa\xf1ol (Ecuador)","es-EC","Spanish (Ecuador)"],["Espa\xf1ol (El Salvador)","es-SV","Spanish (El Salvador)"],["Espa\xf1ol (Espa\xf1a)","es-ES","Spanish (Spain)",1],["Espa\xf1ol (Estados Unidos)","es-US","Spanish (United States)"],["Espa\xf1ol (Guatemala)","es-GT","Spanish (Guatemala)"],["Espa\xf1ol (Honduras)","es-HN","Spanish (Honduras)"],["Espa\xf1ol (M\xe9xico)","es-MX","Spanish (Mexico)"],["Espa\xf1ol (Nicaragua)","es-NI","Spanish (Nicaragua)"],["Espa\xf1ol (Panam\xe1)","es-PA","Spanish (Panama)"],["Espa\xf1ol (Paraguay)","es-PY","Spanish (Paraguay)"],["Espa\xf1ol (Per\xfa)","es-PE","Spanish (Peru)"],["Espa\xf1ol (Puerto Rico)","es-PR","Spanish (Puerto Rico)"],["Espa\xf1ol (Rep\xfablica Dominicana)","es-DO","Spanish (Dominican Republic)"],["Espa\xf1ol (Uruguay)","es-UY","Spanish (Uruguay)"],["Espa\xf1ol (Venezuela)","es-VE","Spanish (Venezuela)"],["Euskara (Espainia)","eu-ES","Basque (Spain)"],["Filipino (Pilipinas)","fil-PH","Filipino (Philippines)"],["Fran\xe7ais (Canada)","fr-CA","French (Canada)"],["Fran\xe7ais (France)","fr-FR","French (France)",1],["Galego (Espa\xf1a)","gl-ES","Galician (Spain)"],["\u10e5\u10d0\u10e0\u10d7\u10e3\u10da\u10d8 (\u10e1\u10d0\u10e5\u10d0\u10e0\u10d7\u10d5\u10d4\u10da\u10dd)","ka-GE","Georgian (Georgia)"],["\u0a97\u0ac1\u0a9c\u0ab0\u0abe\u0aa4\u0ac0 (\u0aad\u0abe\u0ab0\u0aa4)","gu-IN","Gujarati (India)"],["Hrvatski (Hrvatska)","hr-HR","Croatian (Croatia)"],["IsiZulu (Ningizimu Afrika)","zu-ZA","Zulu (South Africa)"],["\xcdslenska (\xcdsland)","is-IS","Icelandic (Iceland)"],["Italiano (Italia)","it-IT","Italian (Italy)"],["Jawa (Indonesia)","jv-ID","Javanese (Indonesia)"],["\u0c95\u0ca8\u0ccd\u0ca8\u0ca1 (\u0cad\u0cbe\u0cb0\u0ca4)","kn-IN","Kannada (India)"],["\u1797\u17b6\u179f\u17b6\u1781\u17d2\u1798\u17c2\u179a (\u1780\u1798\u17d2\u1796\u17bb\u1787\u17b6)","km-KH","Khmer (Cambodia)"],["\u0ea5\u0eb2\u0ea7 (\u0ea5\u0eb2\u0ea7)","lo-LA","Lao (Laos)"],["Latvie\u0161u (latvie\u0161u)","lv-LV","Latvian (Latvia)"],["Lietuvi\u0173 (Lietuva)","lt-LT","Lithuanian (Lithuania)"],["Magyar (Magyarorsz\xe1g)","hu-HU","Hungarian (Hungary)"],["\u0d2e\u0d32\u0d2f\u0d3e\u0d33\u0d02 (\u0d07\u0d28\u0d4d\u0d24\u0d4d\u0d2f)","ml-IN","Malayalam (India)"],["\u092e\u0930\u093e\u0920\u0940 (\u092d\u093e\u0930\u0924)","mr-IN","Marathi (India)"],["Nederlands (Nederland)","nl-NL","Dutch (Netherlands)"],["\u0928\u0947\u092a\u093e\u0932\u0940 (\u0928\u0947\u092a\u093e\u0932)","ne-NP","Nepali (Nepal)"],["Norsk bokm\xe5l (Norge)","nb-NO","Norwegian Bokm\xe5l (Norway)"],["Polski (Polska)","pl-PL","Polish (Poland)"],["Portugu\xeas (Brasil)","pt-BR","Portuguese (Brazil)",1],["Portugu\xeas (Portugal)","pt-PT","Portuguese (Portugal)"],["Rom\xe2n\u0103 (Rom\xe2nia)","ro-RO","Romanian (Romania)"],["\u0dc3\u0dd2\u0d82\u0dc4\u0dbd (\u0dc1\u0dca\u0dbb\u0dd3 \u0dbd\u0d82\u0d9a\u0dcf\u0dc0)","si-LK","Sinhala (Sri Lanka)"],["Sloven\u010dina (Slovensko)","sk-SK","Slovak (Slovakia)"],["Sloven\u0161\u010dina (Slovenija)","sl-SI","Slovenian (Slovenia)"],["Urang (Indonesia)","su-ID","Sundanese (Indonesia)"],["Swahili (Tanzania)","sw-TZ","Swahili (Tanzania)"],["Swahili (Kenya)","sw-KE","Swahili (Kenya)"],["Suomi (Suomi)","fi-FI","Finnish (Finland)"],["Svenska (Sverige)","sv-SE","Swedish (Sweden)"],["\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe)","ta-IN","Tamil (India)"],["\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd)","ta-SG","Tamil (Singapore)"],["\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8)","ta-LK","Tamil (Sri Lanka)"],["\u0ba4\u0bae\u0bbf\u0bb4\u0bcd (\u0bae\u0bb2\u0bc7\u0b9a\u0bbf\u0baf\u0bbe)","ta-MY","Tamil (Malaysia)"],["\u0c24\u0c46\u0c32\u0c41\u0c17\u0c41 (\u0c2d\u0c3e\u0c30\u0c24\u0c26\u0c47\u0c36\u0c02)","te-IN","Telugu (India)"],["Ti\u1ebfng Vi\u1ec7t (Vi\u1ec7t Nam)","vi-VN","Vietnamese (Vietnam)"],["T\xfcrk\xe7e (T\xfcrkiye)","tr-TR","Turkish (Turkey)"],["\u0627\u0631\u062f\u0648 (\u067e\u0627\u06a9\u0633\u062a\u0627\u0646)","ur-PK","Urdu (Pakistan)"],["\u0627\u0631\u062f\u0648 (\u0628\u06be\u0627\u0631\u062a)","ur-IN","Urdu (India)",1],["\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac (\u0395\u03bb\u03bb\u03ac\u03b4\u03b1)","el-GR","Greek (Greece)"],["\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438 (\u0411\u044a\u043b\u0433\u0430\u0440\u0438\u044f)","bg-BG","Bulgarian (Bulgaria)"],["\u0420\u0443\u0441\u0441\u043a\u0438\u0439 (\u0420\u043e\u0441\u0441\u0438\u044f)","ru-RU","Russian (Russia)"],["\u0421\u0440\u043f\u0441\u043a\u0438 (\u0421\u0440\u0431\u0438\u0458\u0430)","sr-RS","Serbian (Serbia)"],["\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430 (\u0423\u043a\u0440\u0430\u0457\u043d\u0430)","uk-UA","Ukrainian (Ukraine)"],["\u05e2\u05d1\u05e8\u05d9\u05ea (\u05d9\u05e9\u05e8\u05d0\u05dc)","he-IL","Hebrew (Israel)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0625\u0633\u0631\u0627\u0626\u064a\u0644)","ar-IL","Arabic (Israel)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0623\u0631\u062f\u0646)","ar-JO","Arabic (Jordan)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0625\u0645\u0627\u0631\u0627\u062a)","ar-AE","Arabic (United Arab Emirates)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0628\u062d\u0631\u064a\u0646)","ar-BH","Arabic (Bahrain)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u062c\u0632\u0627\u0626\u0631)","ar-DZ","Arabic (Algeria)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629)","ar-SA","Arabic (Saudi Arabia)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0639\u0631\u0627\u0642)","ar-IQ","Arabic (Iraq)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0643\u0648\u064a\u062a)","ar-KW","Arabic (Kuwait)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0627\u0644\u0645\u063a\u0631\u0628)","ar-MA","Arabic (Morocco)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u062a\u0648\u0646\u0633)","ar-TN","Arabic (Tunisia)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0639\u064f\u0645\u0627\u0646)","ar-OM","Arabic (Oman)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0641\u0644\u0633\u0637\u064a\u0646)","ar-PS","Arabic (State of Palestine)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0642\u0637\u0631)","ar-QA","Arabic (Qatar)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0644\u0628\u0646\u0627\u0646)","ar-LB","Arabic (Lebanon)"],["\u0627\u0644\u0639\u0631\u0628\u064a\u0629 (\u0645\u0635\u0631)","ar-EG","Arabic (Egypt)",1],["\u0641\u0627\u0631\u0633\u06cc (\u0627\u06cc\u0631\u0627\u0646)","fa-IR","Persian (Iran)"],["\u0939\u093f\u0928\u094d\u0926\u0940 (\u092d\u093e\u0930\u0924)","hi-IN","Hindi (India)"],["\u0e44\u0e17\u0e22 (\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28\u0e44\u0e17\u0e22)","th-TH","Thai (Thailand)"],["\ud55c\uad6d\uc5b4 (\ub300\ud55c\ubbfc\uad6d)","ko-KR","Korean (South Korea)"],["\u570b\u8a9e (\u53f0\u7063)","zh-TW","Chinese, Mandarin (Traditional, Taiwan)"],["\u5ee3\u6771\u8a71 (\u9999\u6e2f)","yue-Hant-HK","Chinese, Cantonese (Traditional, Hong Kong)"],["\u65e5\u672c\u8a9e\uff08\u65e5\u672c\uff09","ja-JP","Japanese (Japan)"],["\u666e\u901a\u8a71 (\u9999\u6e2f)","zh-HK","Chinese, Mandarin (Simplified, Hong Kong)"],["\u666e\u901a\u8bdd (\u4e2d\u56fd\u5927\u9646)","zh","Chinese, Mandarin (Simplified, China)"]],normalizeCode:function(e){return e?e.toUpperCase().replace(/_/g,"-"):""},areCodesEqual:function(e,t){return e==t||!(!e||!t)&&this.normalizeCode(e)==this.normalizeCode(t)},isLanguageCodeSupported:function(e){return!!this.getLocaleByCode(e)},supportedLanguagesString:function(){var e,t="",n=a(this.allLocales);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=this.codeToLabel(r[1])+"\n"}}catch(i){n.e(i)}finally{n.f()}return t},codeToName:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"native";if(!e)return"";var n,r=e.includes("-")||e.includes("_")?this.allLocales:this.getSupportedLanguagesOnlyList(),i=a(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(this.areCodesEqual(o[1],e))switch(t){case"english":return o[2];case"both":return o[0]+" - "+o[2];default:return o[0]}}}catch(s){i.e(s)}finally{i.f()}return e.toUpperCase()},getFlagForCountryCode:function(e){if(null==e||2!=e.length)return e?e.substring(0,3):"";if("IL"==(e=e.toUpperCase()))return"\ud83c\uddee\ud83c\uddf1";if("PS"==e)return"\ud83c\uddf5\ud83c\uddf8";return String.fromCodePoint(e.codePointAt(0)-65+127462)+String.fromCodePoint(e.codePointAt(1)-65+127462)},codeToCountryCode:function(e){if(!e||e.length<2)return"";if((e=e.replace("-","_")).indexOf("_")>-1){var t=e.split("_");e=t[t.length-1]}else if("zh"==(e=e.substring(e.length-2,e.length))||"ZH"==e)return"CN";return e},codeToLanguageCodeOnly:function(e){return null==e||e.length<2?"":e.toLowerCase().replace("_","-").split("-")[0]},doCodesShareLanguage:function(e,t){return this.codeToLanguageCodeOnly(e)==this.codeToLanguageCodeOnly(t)},getLocaleByCode:function(e){if(!e)return"";if(!(e=this.normalizeCode(e)).includes("-"))return this.getDefaultLocaleForLanguage(e);var t,n=a(this.allLocales);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.areCodesEqual(r[1],e))return r}}catch(i){n.e(i)}finally{n.f()}return""},getSupportedLanguagesOnlyList:function(){var e,t={},n=a(this.allLocales);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[this.codeToLanguageCodeOnly(r[1])]=[r[0].split(" (")[0],this.codeToLanguageCodeOnly(r[1]),r[2].split(" (")[0]]}}catch(c){n.e(c)}finally{n.f()}var i,o=[],s=a(Object.getOwnPropertyNames(t));try{for(s.s();!(i=s.n()).done;){var l=i.value;o.push(t[l])}}catch(c){s.e(c)}finally{s.f()}return o=o.sort((function(e,t){return e[0].localeCompare(t[0])}))},getAllLocalesForLanguage:function(e){var t=this;return e?(e=this.codeToLanguageOnly(e),this.allLocales.filter((function(n){return t.codeToLanguageCodeOnly(n[1])==e}))):[]},getDefaultLocaleForLanguage:function(e){var t=this;if(!e)return"";e=this.codeToLanguageOnly(e).toLowerCase();var n=this.allLocales.filter((function(n){return t.codeToLanguageCodeOnly(n[1])==e}));if(!n||0==n.length)return"";if(1==n.length)return n[0];var a=n.filter((function(e){return e.length>3}));return a&&a.length>0?a[0]:n[0]},codeToLanguageOnly:function(e){return e?e.toLowerCase().replace("_","-").split("-")[0]:""},codeToFlag:function(e){return this.getFlagForCountryCode(this.codeToCountryCode(e))},codeToLabel:function(e){return this.codeToFlag(e)+" "+this.codeToName(e)}},v=p;function m(e,t){(e=e||"Voice").toLowerCase().includes("(enhanced)")&&(e=e.replace("(Enhanced)","2")),e.includes("(")&&e.includes(")")&&(e=e.substring(0,e.indexOf("("))),"Google US English"===e&&(e="Female, US *");var n=e.toLowerCase(),a="";return(n.includes("google")||n.includes("microsoft"))&&(e=e.replace("Google ",""),a=" *"),(e=(e=(e=e.replace("English","")).trim())||t)+a}function y(e,t){var n=v.codeToFlag(e.lang),a=m(e.name,e.lang);return!1,a.endsWith(" *")&&a.length>15?a=a.substring(0,10)+"... *":a.length>15&&(a=a.substring(0,10)+"..."),n+" "+a}var S=h((function e(t){var n=this;u(this,e),this.persist=function(e,t){null===t||void 0===t?window.localStorage.removeItem(n.preKey+e):(t instanceof Object&&(t=JSON.stringify(t)),window.localStorage.setItem(n.preKey+e,t))},this.get=function(e,t){var a=window.localStorage.getItem(n.preKey+e);return null===a||void 0===a?null:(t&&("Object"===t?a=JSON.parse(a):"number"===t?a=parseFloat(a):"bool"===t&&(a="true"===a||!0===a||"1"===a||1===a||"false"!==a&&!1!==a&&"0"!==a&&0!==a&&!!a)),a)},this.remove=function(e){window.localStorage.removeItem(n.preKey+e)},this.preKey=t+"_"})),E=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],T=[.4,.5,.6,.7,.75,.8,.85,.9,.95,1,1.1,1.2,1.3,1.4,1.5,1.7,2,2.25,2.5,2.9];var b=function(){function e(){u(this,e)}return h(e,null,[{key:"indexOfFirstSentenceEnd",value:function(t){var n,r=1/0,i="",o=a(e.SENTENCE_STRONG_ENDS);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(t.includes(s)){var l=t.indexOf(s);l<r&&(r=l,i=s)}}}catch(g){o.e(g)}finally{o.f()}if(i)return r+i.length;if(t.length>e.MAX_SEGMENT_LENGTH){t=t.substr(0,e.MAX_SEGMENT_LENGTH);var c,u=a(e.SENTENCE_SOFT_BREAKS);try{for(u.s();!(c=u.n()).done;){var d=c.value;if(t.includes(d)){var h=t.indexOf(d);h<r&&(r=h,i=d)}}}catch(g){u.e(g)}finally{u.f()}if(i)return r+i.length;var f=t.lastIndexOf(" ");if(f>-1)return f+1}return t.length}},{key:"findFirstRealPeriod",value:function(e){for(var t=0;t<e.length;t++)if("."===e.charAt(t)){if(t<e.length-1&&-1!="0123456789".indexOf(e.charAt(t+1)))continue;if(t>1&&"."==e.charAt(t-2))continue;if(t>2){var n=e.substring(t-2,t).toLowerCase();if("mr"==n||"ms"==n||"dr"==n)continue}if(t<e.length-1&&-1!="   [({])}".indexOf(e.charAt(t+1))||"\n"==e.charAt(t+1))return t}return-1}},{key:"getClosestValue",value:function(e,t){for(var n=document.getElementById(e),a=null,r=n.options[0].value,i=0;i<n.options.length;i++){var o=n.options[i].value;if(o==t)return t;var s=Math.abs(n.options[i].value-t);(null==a||s<a)&&(a=s,r=o)}return r}},{key:"sortList",value:function(e){return void 0==e||null==e?e:"[object Array]"===Object.prototype.toString.call(e)?e.sort((function(e,t){var n=e[1].toUpperCase(),a=t[1].toUpperCase();return n<a?-1:n>a?1:0})):void 0}}]),e}();b.MAX_SEGMENT_LENGTH=300,b.SENTENCE_STRONG_ENDS=[". ","\n","!","?"],b.SENTENCE_SOFT_BREAKS=[", ",": ","; ","(",")","[","]","{","}"];var w=function(){function e(){u(this,e)}return h(e,null,[{key:"loadTextFile",value:function(e,t){var n=new FileReader;n.onloadend=function(e){t(this.result.trim())},n.readAsText(e)}}]),e}();function P(n){return function(t){if(Array.isArray(t))return e(t)}(n)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||t(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=function(){function e(){u(this,e)}return h(e,null,[{key:"fetchJsFile",value:function(e,t){var n=document.createElement("script");n.src=e,n.onload=function(){t&&t()},document.getElementsByTagName("head")[0].appendChild(n)}},{key:"fetchStyleSheet",value:function(e){var t=document.createElement("link");t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}}]),e}(),L=function(){function e(){u(this,e)}return h(e,null,[{key:"loadPdfFile",value:function(t,n,a){if(window.PDFJS){var r=new FileReader;r.onload=function(e){!function(e,t,n){!function(e,t){var n,a={pages:{},lines:[],ps:[],currentPage:1};window.PDFJS.getDocument(e).promise.then((function(e){n=e.numPages,console.log("PDF loaded with "+n+" pages"),A(e,a,t)}),(function(e){console.error(e)}))}(e,n)}(this.result,0,(function(e){n(e)}))},r.readAsArrayBuffer(t)}else C.fetchJsFile("static/js/pdf.min.js",(function(){e.loadPdfFile(t,n,a)}))}}]),e}();function A(e,t,n){e.getPage(t.currentPage).then((function(r){t.pages[t.currentPage]={lines:[]},r.getTextContent().then((function(r){var i=r.items;if(i.length>0&&(R(i[0],t,!0),i.length>1))for(var o=1;o<i.length;o++)R(i[o],t,!1);if(console.log(i),t.pages[t.currentPage].lines=function(e){if(null==e||void 0==e)return[];if(e.length<=1)return e;return e.sort((function(e,t){return t.yBottom-e.yBottom}))}(t.pages[t.currentPage].lines),t.currentPage<e.numPages)t.currentPage++,A(e,t,n);else if(null!=n&&void 0!=n){var s=function(e){var t=[];if(null==e||void 0==e||0==e.length)return t;if(1==e.length)return e;t.push(O(e[0]));for(var n=0;n<e.length;n++)k(t[t.length-1],e[n])?t[t.length-1]=x(t[t.length-1],e[n]):t.push(O(e[n]));return t}(function(e,t){for(var n=[],a=1;a<=t;a++){var r=e[a];n.push.apply(n,P(r.lines))}return n}(t.pages,e.numPages));s=function(e){var t,n=[],r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;I(i)||M(i)||n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n}(s),n(function(e){if(null==e||void 0==e||0==e.length)return"";for(var t="",n=0;n<e.length;n++)t+=e[n].str+"\n\n";return t}(s))}}))}))}function I(e){return e.pageEnd==e.pageStart&&e.yTop<40}function M(e){return 0==e.str.trim().length}function O(e){return{str:e.str,pageStart:e.page,pageEnd:e.page,height:e.height,xStart:e.xStart,xEnd:e.xEnd,yTop:e.yTop,yBottom:e.yBottom}}function x(e,t){return{str:e.str+t.str,pageStart:e.pageStart,pageEnd:t.page,height:e.height,xStart:Math.min(e.xStart,t.xStart),xEnd:Math.max(e.xEnd,t.xEnd),yTop:e.yTop,yBottom:t.yBottom}}function R(e,t,n){if(null!=e&&void 0!=e)if(0!=t.pages[t.currentPage].lines.length&&!n&&function(e,t){var n=t.transform[5]-t.height,a=t.transform[5];if(n>=e.yBottom&&n<=e.yTop)return!0;if(e.yBottom>=n&&e.yBottom<=a)return!0;return!1}(t.pages[t.currentPage].lines[t.pages[t.currentPage].lines.length-1],e))t.pages[t.currentPage].lines[t.pages[t.currentPage].lines.length-1]=function(e,t){var n="",a=Math.max(t.height,e.height),r=0,i=0;return t.transform[4]>e.xStart?(i=e.xStart,r=t.transform[4]+t.width,n=e.str,e.xEnd+a<t.transform[4]&&(n+=" "),n+=t.str):(i=t.transform[4],r=e.xEnd,n=t.str,t.transform[4]+t.width+a<e.xStart&&(n+=" "),n+=e.str),{page:e.page,str:n,height:a,yTop:Math.max(t.transform[5],e.yTop),yBottom:Math.min(t.transform[5]-t.height,e.yBottom),xStart:i,xEnd:r}}(t.pages[t.currentPage].lines[t.pages[t.currentPage].lines.length-1],e);else{var a=function(e,t){return{page:t,str:e.str,height:e.height,yTop:e.transform[5],yBottom:e.transform[5]-e.height,xStart:e.transform[4],xEnd:e.transform[4]+e.width}}(e,t.currentPage);t.pages[t.currentPage].lines.push(a)}}function k(e,t){return e.height==t.height&&!(e.pageEnd==t.page&&e.yBottom-e.height>t.yTop)}var N=function(){function e(){u(this,e)}return h(e,null,[{key:"loadEpubFile",value:function(t,n,a,r){if(window.ePub){var i=new FileReader;i.onload=function(e){!function(e,t,n,a){var r=window.ePub({bookPath:e});window.book=r,r.getMetadata().then((function(e){console.log("meta = ",e);var n=e.bookTitle||t;a.persist("bookTitle",n)})),document.querySelector("#area").innerHTML="";var i=0,o="";r.on("book:atEnd",(function(){console.log("book:atEnd"),n(a.get(_(0)))})),r.on("renderer:locationChanged",(function(e){if(console.log("ronen hi"),o!=e){o=e,console.log(e);var t=document.getElementById("area").getElementsByTagName("IFRAME")[0].contentWindow.document.body,n=t.innerText;console.log(t),n.length>0&&(console.log("chapter text length = "+n.length),a.persist(_(i),n),1===++i&&a.persist("currentChapterIndex",0),a.persist("totalChapters",i))}var s=r.nextChapter();console.log("nextResponse = ",s)})),r.renderTo("area")}(e.target.result,t.name,n,r)}.bind(this),i.readAsArrayBuffer(t)}else C.fetchJsFile("static/js/zip.min.js",(function(){C.fetchJsFile("https://cdn.jsdelivr.net/epub.js/0.2.15/epub.min.js",(function(){e.loadEpubFile(t,n,a,r)}))}))}}]),e}();function _(e){return"chapter"+e}var U=h((function e(t){var n=this;u(this,e),this.MEDIA_CONSTRAINTS={video:{width:3,height:2},audio:{echoCancellation:!1,noiseSuppression:!1,sampleRate:44100}},this.TIME_OUT_LIMIT_IN_MINUTES=60,this.MinutesToMs=function(e){return 60*e*1e3},this.downloadUrl=function(e){var t=document.createElement("A");t.href=e,t.download="recording.webm",t.click(),t.remove()},this.inputParams={optionalOutputAudioElement:null,optionalDownloadButton:null,optionalOnStart:null,optionalOnDone:null,optionalOnError:null},this.isRecording=!1,this.recordedChunks=[],this.setUrlToDomElements=function(e){n.inputParams.optionalDownloadButton&&(n.inputParams.optionalDownloadButton.download="recording.webm",n.inputParams.href=e),n.inputParams.optionalOutputAudioElement&&(n.inputParams.optionalOutputAudioElement.src=e)},this.saveBlob=function(e){n.audioBlobUrl=URL.createObjectURL(e),n.setUrlToDomElements(n.audioBlobUrl),n.inputParams.optionalOnDone&&n.inputParams.optionalOnDone(n.audioBlobUrl)},this.downloadBlob=function(){n.downloadUrl(n.audioBlobUrl)},this.toggleCapture=function(){n.isRecording?n.stopCapture():n.startCapture()},this.stopCapture=function(){console.log("stopCapture"),n.mediaRecorder&&n.mediaRecorder.stop(),n.sourceMediaStream&&n.sourceMediaStream.getTracks()&&n.sourceMediaStream.getTracks().forEach((function(e){e.stop()})),n.isRecording=!1,clearTimeout(n.globalTimeout)},this.startCapture=function(){console.log("startCapture");var e=n;navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&navigator.mediaDevices.getDisplayMedia(e.MEDIA_CONSTRAINTS).catch((function(e){console.error("Error:"+e)})).then((function(t){e.sourceMediaStream=t,e.handleStream(new MediaStream(t.getAudioTracks())),e.isRecording=!0,e.inputParams.optionalOnStart&&e.inputParams.optionalOnStart(),n.globalTimeout=setTimeout(n.stopCapture,e.MinutesToMs(e.TIME_OUT_LIMIT_IN_MINUTES)),t.addEventListener("inactive",(function(t){e.stopCapture()}))}))},this.handleStream=function(e){if(e){var t={mimeType:"audio/webm;codecs=opus"};MediaRecorder.isTypeSupported(t.mimeType)||(console.log(t.mimeType+" is not Supported"),t={mimeType:"audio/webm;codecs=vorbis"},MediaRecorder.isTypeSupported(t.mimeType)||(console.log(t.mimeType+" is not Supported"),t={mimeType:"audio/webm"},MediaRecorder.isTypeSupported(t.mimeType)||(console.log(t.mimeType+" is not Supported"),t={mimeType:""}))),n.mediaRecorder=new MediaRecorder(e,t),n.mediaRecorder.ondataavailable=function(e){e.data.size>0&&n.recordedChunks.push(e.data)},n.mediaRecorder.onstop=function(e){var t=new Blob(n.recordedChunks,{type:"audio/webm;codecs=opus"});n.recordedChunks=[],n.saveBlob(t)},n.mediaRecorder.start()}},t&&(this.inputParams=l(l({},this.inputParams),t))})),B=function(){function e(){u(this,e)}return h(e,null,[{key:"getExpEpochInSecsFromPurchasesList",value:function(e){if(!e||!(e instanceof Object)||0===Object.getOwnPropertyNames(e).length)return 0;var t,n=1e3,r=[],i=a(Object.getOwnPropertyNames(e));try{for(i.s();!(t=i.n()).done;){var o=e[t.value];"SKU_TTSREADER_PREMIUM_1_YEAR__"===o.sku&&r.push(o.epochDateInSecs)}}catch(d){i.e(d)}finally{i.f()}r.length>0&&r.sort();for(var s=31536e3,l=0,c=r;l<c.length;l++){var u=c[l];u<n?n+=s:n=u+s}return n}},{key:"getHowManyDaysLeftToExpiration",value:function(t){if(!t||!(t instanceof Object)||0===Object.getOwnPropertyNames(t).length)return-999;var n=e.getExpEpochInSecsFromPurchasesList(t),a=Date.now()/1e3,r=Math.floor((n-a)/86400);return r<-999?-999:r}}]),e}();function D(){if(console.log("loaded alright"),window.Purchases=B,"win"===f.getOs()){var e=new FontFace("BabelStoneFlags","url(static/fonts/BabelStoneFlags.ttf)",{unicodeRange:"U+1F1E6-1F1FF",style:"normal",fontSize:"20px"});document.fonts.add(e),e.load().then((function(){console.log("loaded emoji font"),C.fetchStyleSheet("static/css/fonts.css")}))}}B.mockData={"47107547JJ965064G":{epochDateInSecs:1671713190,misc:"",sku:"SKU_TTSREADER_PREMIUM_1_YEAR__"},fake_purchase_id_fU6Un:{epochDateInSecs:1671636497,misc:"some misc data",sku:"SKU_TTSREADER_PREMIUM_1_YEAR__"}},B.getMockPurchasesData=function(){return B.mockData},"complete"===document.readyState?(console.log("loaded already"),D()):(console.log("waiting for load"),window.addEventListener("load",(function(e){D()})));var F=function(){console.log("Hello App");var e=document.querySelector(".Text-box"),t=new S("TTSReaderPlayer"),n=[["isPremium","bool"],["isRepeatMode","bool"],["caretPosition","Object"],["selectedFontSize",""],["selectedVoiceUri",""],["selectedLanguageCode",""],["selectedRate","number"],["selectedRateSliderValue","number"]],r=function(){for(var e={},a=0,r=n;a<r.length;a++){var i=r[a],o=i[0],s=i[1],l=t.get(o,s);null!==l&&(e[o]=l)}return e}();console.log({storedState:r});var i=!0;Object.getOwnPropertyNames(r).length>0&&(i=!1);var o=l(l({},{isFirstVisit:i,ttsReady:!1,isPlayingOn:!1,isRecordingOn:!1,caretPosition:{node:0,charStart:0,charEnd:0},selectedVoiceUri:"",selectedLanguageCode:"en-GB",selectedRate:.9,selectedRateSliderValue:10,selectedFontSize:"20px",os:f.getOs(),isRecordingSupported:"win"===f.getOs()||window.location.href.includes("localhost"),isRepeatMode:!1,isShareSupported:Boolean(window.navigator.share)}),r);o.caretPosition&&void 0!==o.caretPosition.node&&void 0!==o.caretPosition.charStart&&void 0!==o.caretPosition.charEnd||(o.caretPosition={node:0,charStart:0,charEnd:0});var s=new f(o),u=t.get("content");if(u)if(e instanceof HTMLTextAreaElement){if(u.includes("<div")){var d=document.createElement("div");d.innerHTML=u,u=d.innerText}document.querySelector(".Text-box").value=u}else u.includes("<div")?A(u,s.data.caretPosition,!0):A(u,s.data.caretPosition);function h(t){if(!s.data.isPlayingOn){var n=function(e){if(!e)return{node:0,charStart:0,charEnd:0};if(e instanceof HTMLTextAreaElement)return{node:0,charStart:e.selectionStart,charEnd:e.selectionEnd};if(e instanceof HTMLInputElement)return{node:0,charStart:e.selectionStart,charEnd:e.selectionEnd};if(e instanceof HTMLElement){var t=window.getSelection();if(0===t.rangeCount)return{node:0,charStart:0,charEnd:0};var n=t.getRangeAt(0),a=n.startContainer,r=n.startOffset;if(!a||a===e)return{node:0,charStart:0,charEnd:0};for(;a.parentElement!==e;)a=a.parentElement;for(var i=e.childNodes,o=0;o<i.length;o++)if(i[o]===a)return{node:o,charStart:r,charEnd:r}}}(e);try{s.updateWithParams({caretPosition:n})}catch(t){}}}e.addEventListener("input",h),e.addEventListener("keyup",h),e.addEventListener("click",h),e.addEventListener("mousedown",h),e.addEventListener("mouseup",h),e.addEventListener("selectionchange",h),window.updateStateWithParentData=function(e){if(s){var t={};if(t.parentData=e,e.hasOwnProperty("isPremium")&&(t.isPremium=e.isPremium),e.hasOwnProperty("purchases")){var n=e.purchases,a=B.getHowManyDaysLeftToExpiration(n);a>0&&(t.isPremium=!0),t.daysLeftForPremium=a}return e.hasOwnProperty("uid")&&""===e.uid&&(t.isPremium=!1,t.daysLeftForPremium=-999,t.isSignedIn=!1),e.hasOwnProperty("uid")&&e.uid&&(t.isSignedIn=!0),s.updateWithParams(t),!0}return!1},window.getAppState=function(){return s},_(document.querySelector(".Text-box"),o.caretPosition,!0);var p=null,P=(window.location.href.includes("localhost"),10),C=new U({optionalOnDone:function(e){p&&(clearTimeout(p),p=null);try{var t=document.createElement("A");t.href=e,t.download="recording.webm",t.click(),t.remove()}catch(n){console.log("some error: ",n)}s.updateWithParams({isRecordingOn:!1}),s.data.isPlayingOn&&M()},optionalOnStart:function(){g.closeModals(),s.updateWithParams({isRecordingOn:!0}),s.data.isPlayingOn||M(),s.data.isPremium||(console.log("setting recording timeout"),p=setTimeout((function(){p&&(console.log("recording timeout fired"),C.stopCapture(),p=null)}),1e3*P))}});function A(n,r,i){if(n){if(e instanceof HTMLTextAreaElement)e.value=n,t.persist("content",n),e.setSelectionRange(0,0),e.blur(),e.focus();else if(i)e.innerHTML=n;else{e.innerHTML="";var o,l=a(n.split("\n"));try{for(l.s();!(o=l.n()).done;){var c=o.value,u=document.createElement("div");u.textContent=c,e.appendChild(u)}}catch(h){l.e(h)}finally{l.f()}t.persist("content",e.innerHTML)}if(s){var d={caretPosition:r||{node:0,charStart:0,charEnd:0}};null!==t.get("totalChapters")&&(d.isBook=!0,d.currentChapterIndex=Number.parseInt(t.get("currentChapterIndex")||0),d.currentChapterLabel=d.currentChapterIndex+1,d.totalChapters=Number.parseInt(t.get("totalChapters")||1),d.bookTitle=t.get("bookTitle")||""),s.updateWithParams(d)}}}function I(){var e=document.querySelector(".Text-box");if(t.persist("content",""),e&&(e instanceof HTMLTextAreaElement?e.value="":e.innerHTML=""),s){var n={caretPosition:{node:0,charStart:0,charEnd:0},isBook:!1,currentChapterIndex:0};n.currentChapterLabel=n.currentChapterIndex+1,n.totalChapters=0,n.bookTitle="",s.updateWithParams(n)}if(null!==t.get("totalChapters")){t.remove("totalChapters"),t.remove("currentChapterIndex"),t.remove("bookTitle");for(var a=0;null!==t.get("chapter"+a);)t.remove("chapter"+a),a++}}s.addChangeListener((function(e){for(var a=0,r=n;a<r.length;a++){var i=r[a][0];t.persist(i,e[i])}}));var M=function(){s.data.isPlayingOn?G():R()},O=function e(t,n){if(t.childNodes.length<=n.node)return e(t,{node:0,charStart:0,charEnd:0});var a=t.childNodes[n.node].textContent;if(a.length<=n.charStart)return e(t,{node:n.node+1,charStart:0,charEnd:0});var r=a.substring(n.charStart),i="{{pause}}",o=r.indexOf(i);if(0==o)return{text:i,node:n.node,charStart:n.charStart,charEnd:n.charStart+9};var s=!1;o>-1&&(r=r.substring(0,o),s=!0);for(var c=r.trimLeft(),u=r.length-c.length,d=["*","-","_","["];d.indexOf(c.charAt(0))>-1&&c;)c=c.substr(1),u++;var h=l(l({},n),{},{charStart:n.charStart+u,charEnd:n.charStart+u});if(c){var f=b.indexOfFirstSentenceEnd(c.substr(0,b.MAX_SEGMENT_LENGTH+1));return h=l(l({},n),{},{charEnd:h.charStart+f}),l({text:c.substr(0,f)},h)}return s?e(t,h):n.node<t.childNodes.length-1?e(t,{node:n.node+1,charStart:0,charEnd:0}):{text:"",node:0,charStart:0,charEnd:0}},x=function(e,t,n,a){console.log("readNextSentence from caret: ",t),c.TtsEngine.setVoiceByUri(s.data.selectedVoiceUri),c.TtsEngine.setRate(s.data.selectedRate);var r=O(e,t),i=r.text,o=r.charEnd,u=r.charStart,d=r.node;if(!s.data.isRepeatMode&&!a&&(d<t.node||d==t.node&&u<t.charStart))return G(),void s.updateWithParams({caretPosition:{node:0,charStart:0,charEnd:0}});t={node:d,charStart:u,charEnd:o};if("{{pause}}"!==i){if(!i&&0==t.charStart&&0==t.charEnd)return G(),void s.updateWithParams({caretPosition:{node:0,charStart:0,charEnd:0}});if(i){s.updateWithParams({caretPosition:t});var h=!1;"!"!==i&&"?"!==i&&"."!==i&&","!==i||(h=!0),!h||n?n?s.updateWithParams({caretPosition:t}):c.TtsEngine.speakOut(i):(console.log("debug-speaking: ",i,t),z.onDone())}}else setTimeout((function(){var a=l(l({},t),{},n?{charStart:t.charStart+9,charEnd:t.charStart+9}:{charEnd:t.charStart+9});s.updateWithParams({caretPosition:a}),_(e,a),n||z.onDone()}),n?0:1e3)},R=function(){var e,t=document.querySelector(".Text-box"),n="";return(n=t instanceof HTMLTextAreaElement?t.value:t.textContent).trim()?n.includes(" ")||!n.toLowerCase().startsWith("https://")&&!n.toLowerCase().startsWith("http://")?(s.updateWithParams({isPlayingOn:!0}),void x(t,s.data.caretPosition,!1,!0)):((e=(e=n)||"https://en.wikipedia.org/wiki/The_Beatles").toLowerCase().startsWith("https://")||e.toLowerCase().startsWith("http://")||(e="https://"+e),void window.open("https://ttsreader.com/webplayer/?url="+e,"_self")):(c.TtsEngine.setBestMatchingVoice("","","en-GB"),c.TtsEngine.setRate(1),void c.TtsEngine.speakOut("Type some text, so I can read it out loud for you."))},k=function(e,t){var n=document.querySelector(".Voices-list"),r=function(e,t){if(!e||!t||0==t.length)return[];var n=t.filter((function(t){if(v.areCodesEqual(t.lang,e))return t}));return n.sort((function(e,t){return e.name>t.name?1:-1}))}(e,t),i=function(e,t){if(v.areCodesEqual(e,"en-US"))for(var n=0,r=["Samantha","Google","Reed"];n<r.length;n++){var i,o=r[n],s=a(t);try{for(s.s();!(i=s.n()).done;){var l=i.value;if(l.name.toLowerCase().includes(o.toLowerCase()))return l}}catch(M){s.e(M)}finally{s.f()}}else if(v.areCodesEqual(e,"en-GB"))for(var c=0,u=["Daniel","Google UK English Male","Samantha","Google","Reed"];c<u.length;c++){var d,h=u[c],f=a(t);try{for(f.s();!(d=f.n()).done;){var g=d.value;if(g.name.toLowerCase().includes(h.toLowerCase()))return g}}catch(M){f.e(M)}finally{f.f()}}var p,m=a(t);try{for(m.s();!(p=m.n()).done;){var y=p.value;if(y.name.toLowerCase().includes("google"))return y}}catch(M){m.e(M)}finally{m.f()}var S,E=a(t);try{for(E.s();!(S=E.n()).done;){var T=S.value;if(T.name.toLowerCase().includes("enhanced"))return T}}catch(M){E.e(M)}finally{E.f()}var b,w=["grandpa","grandma"],P=a(t);try{for(P.s();!(b=P.n()).done;){var C,L=b.value,A=a(w);try{for(A.s();!(C=A.n()).done;){var I=C.value;L.name.toLowerCase().includes(I)}}catch(M){A.e(M)}finally{A.f()}return L}}catch(M){P.e(M)}finally{P.f()}return t[0]}(e,r);if(i.voiceURI!==r[0].voiceURI&&(r=r.filter((function(e){if(e.voiceURI!==i.voiceURI)return e})),r.unshift(i)),n){n.innerHTML="";var o,s=a(r);try{for(s.s();!(o=s.n()).done;){var l=o.value,c=document.createElement("div"),u=l.voiceURI,d=l.name;d=m(d,e),c.classList.add("Voice-list-element"),c.setAttribute("value",u),c.setAttribute("data-ws-select-if-state","selectedVoiceUri="+u),c.innerHTML='<span value="'+u+'" onClick="window.appMethods.selectVoice(\''+u+"')\">"+d+'</span>                <span value="'+u+'" onClick="window.appMethods.testVoice(\''+u+'\')"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"></path></svg></span>',n.appendChild(c)}}catch(h){s.e(h)}finally{s.f()}}return i};function _(t,n,a){if(t instanceof HTMLTextAreaElement)!function(e,t,n){console.log("highlighting ",t);var a=e;a.blur(),a.setSelectionRange(t.charEnd,t.charEnd),a.focus(),a.setSelectionRange(t.charStart,t.charEnd)}(t,n);else try{!function(t,n,a){if(!a){var r=n.node,i=n.charStart,o=n.charEnd,s=t.childNodes[r];if(s.nodeType===Node.TEXT_NODE&&s.parentElement===e){var l=document.createElement("div");e.insertBefore(l,s),l.appendChild(s),s=l}var c=s.textContent,u=c.substring(0,i),d=c.substring(i,o),h=c.substring(o),f=document.createElement("span");f.textContent=d,f.classList.add(a?"Blink":"Highlight");var g=document.createTextNode(u),p=document.createTextNode(h),v=document.createElement("div");return v.appendChild(g),v.appendChild(f),v.appendChild(p),t.replaceChild(v,s),void f.scrollIntoView({behavior:"smooth",block:"center"})}var m=t.childNodes[0],y=n.node;t.childNodes.length>y&&y>=0&&(m=t.childNodes[y]);m instanceof Element&&(m=(t=m).childNodes[0]);t.removeChild(m);var S=document.createElement("span");S.classList.add(a?"Blink":"Highlight"),S.appendChild(m),t.prepend(S),S.scrollIntoView({behavior:"smooth",block:"center"}),a&&setTimeout((function(){var e=S.firstChild;S.parentElement.insertBefore(e,S),S.remove()}),1e3)}(t,n,a)}catch(r){}}var D=function(e,t){_(e,t,!0)},F=function e(t,n){var a=document.querySelector(".Text-box");if(a instanceof HTMLTextAreaElement){var r=a.value;if(!r)return;t=s.data.caretPosition.charStart;var i=s.data.caretPosition;if(isNaN(a.selectionStart)||(i={node:0,charStart:t=a.selectionStart>=a.value.length?0:a.selectionStart,charEnd:t}),console.log("fromIndex = ",t),!(n>0)){if(i.charStart<=0)return i={node:0,charStart:0,charEnd:0},s.updateWithParams({caretPosition:i}),void _(a,i,!0);for(var o=r.substr(0,t).trimEnd(),l=["*","-","_","["];l.indexOf(o.charAt(o.length-1))>-1&&o;)o=o.substr(0,o.length-1);for(var c=1,u=t=o.length;t-u<3&&u>0;){var d=t-9*c;if(d<=0){u=0;break}var h=O(a,{node:0,charStart:d,charEnd:d}).charEnd;u=Math.max(0,h),c++}return i={node:0,charStart:u,charEnd:u},s.updateWithParams({caretPosition:i}),void _(a,i,!0)}var f=O(a,i).charEnd;i={node:0,charStart:f,charEnd:f},s.updateWithParams({caretPosition:i}),_(a,i,!0),D(a,s.data.caretPosition)}else{if(!a.textContent)return;var g=a.childNodes;if(g.length<=1)return;var p=(t+n)%g.length;if(p<0&&(p=g.length-1),g[p].textContent.trim()){var v={node:p,charStart:0,charEnd:0};console.log("old caret: "+s.data.caretPosition.node+", new: "+v.node),s.updateWithParams({caretPosition:v}),D(a,v)}else e(p,n)}};function H(e){var n=s.data.currentChapterIndex+e;n<0?n=s.data.totalChapters-1:n>=s.data.totalChapters&&(n=0);var a=t.get("chapter"+n);t.persist("currentChapterIndex",n),A(a)}var V=function(e){var t=function(e,t){var n=0;if(T[0]===e)n=0;else for(;n<T.length&&T[n+1]<=e;)n++;return t?n--:n++,n>=T.length&&(n=T.length-1),n<0&&(n=0),[T[n],E[n]]}(s.get("selectedRate"),e),n=t[1],a=t[0];s.updateWithParams({selectedRateSliderValue:n,selectedRate:a})},j=function(e){var t=Number.parseFloat(s.get("selectedFontSize").split("px")[0])*e+"px";s.updateWithParams({selectedFontSize:t})},G=function(){var e=l(l({},s.data.caretPosition),{},{charEnd:s.data.caretPosition.charStart});s.updateWithParams({isPlayingOn:!1,caretPosition:e}),_(document.querySelector(".Text-box"),e),c.TtsEngine.stop()},W={handleFileSelect:function(e){var n=e.target.files[0];console.log("got file ",n.name),function(e){switch(s.data.isPlayingOn&&M(),I(),e.name.split(".")[e.name.split(".").length-1]){case"txt":case"json":case"rtf":case"csv":w.loadTextFile(e,A);break;case"pdf":L.loadPdfFile(e,A,(function(e){}));break;case"epub":N.loadEpubFile(e,A,(function(e){}),t);break;default:alert("File not supported. Try text / pdf / epub files.")}}(n)},toggleRepeatMode:function(){s.data.isRepeatMode?s.updateWithParams({isRepeatMode:!1}):s.updateWithParams({isRepeatMode:!0})},clearContent:I,startRecording:function(){C.toggleCapture()},toggleRecord:function(){s.data.isRecordingOn?C.toggleCapture():(s.data.isPlayingOn&&G(),s.data.isPremium?g.showModal("recordStartModal"):g.showModal("recordModalNonPremium"))},togglePlay:M,goToStart:function(e){s.updateWithParams({caretPosition:{node:0,charStart:0,charEnd:0}}),_(document.querySelector(".Text-box"),s.data.caretPosition,!0)},goToCaret:function(e){alert("This function is under development. When ready, it will bring the player position to where you manually place the caret in the text.")},rewind:function(e){F(s.data.caretPosition.node,-1)},forward:function(e){F(s.data.caretPosition.node,1)},loadNextChapter:function(){H(1)},loadPrevChapter:function(){H(-1)},onPaste:function(e){var n;n=e.currentTarget instanceof HTMLTextAreaElement?e.currentTarget.value:e.currentTarget.innerHTML,t.persist("content",n)},onRateChange:function(e){var t=e.currentTarget.value,n=function(e){var t=0;if(E[0]==e)return T[0];for(;t<E.length&&E[t+1]<=e;)t++;return T[t]}(t);s.updateWithParams({selectedRateSliderValue:t,selectedRate:n})},slower:function(e){V(!0)},faster:function(e){V(!1)},fontIncrease:function(e){j(1.1)},fontDecrease:function(e){j(1/1.1)},selectVoice:function(e){c.TtsEngine.setBestMatchingVoice(null,e,"");var t=y(c.TtsEngine.voice);s.updateWithParams({selectedVoiceUri:e,voiceLabel:t}),document.querySelector(".Modal").style.display="none"},testVoice:function(e){s.get("isPlayingOn")&&M(),c.TtsEngine.setBestMatchingVoice(null,e,""),c.TtsEngine.setRate(1);var t="Hi, my name is "+c.TtsEngine.voice.name+", and this is my voice.";c.TtsEngine.speakOut(t)},handleVoiceChange:function(e){var t=e.currentTarget.value;c.TtsEngine.setBestMatchingVoice(null,t,"");var n=y(c.TtsEngine.voice);s.updateWithParams({selectedVoiceUri:t,voiceLabel:n})},handleLanguageChange:function(e){var t=e.currentTarget.value,n=k(t,c.TtsEngine.voices),a=n.voiceURI,r=y(n);s.updateWithParams({selectedLanguageCode:t,selectedVoiceUri:a,voiceLabel:r})},onInput:function(e){var n;n=e.currentTarget instanceof HTMLTextAreaElement?e.currentTarget.value:e.currentTarget.innerHTML,t.persist("content",n)}};window.appMethods=W,g.init(s,W);var z={onInit:function(e){console.log("tts initiated");var t=function(e){if(!e||0==e.length)return[];var t,n=[],r=a(e);try{for(r.s();!(t=r.n()).done;){var i=t.value.lang;n.includes(i)||n.push(i)}}catch(s){r.e(s)}finally{r.f()}var o=[];return n.forEach((function(e){o.push([e,v.codeToName(e,"native")])})),o.sort((function(e,t){return e[1]>t[1]?1:e[1]==t[1]?0:-1})),o.unshift(["en-US",v.codeToName("en-US","native")]),o.unshift(["en-GB",v.codeToName("en-GB","native")]),o}(e);console.log("locales: ",t);var n=c.TtsEngine.setBestMatchingVoice(null,s.get("selectedVoiceUri"),s.get("selectedLanguageCode")),r=c.TtsEngine.voice.lang,i=document.querySelector(".Language-selector");if(i){var o,l=a(t);try{for(l.s();!(o=l.n()).done;){var u=o.value,d=document.createElement("option");d.value=u[0],d.innerHTML=v.codeToFlag(u[0])+"&nbsp;"+u[1],i.appendChild(d)}}catch(f){l.e(f)}finally{l.f()}}k(r,e);var h=y(c.TtsEngine.voice);s.updateWithParams({ttsReady:!0,selectedVoiceUri:n,selectedLanguageCode:r,voiceLabel:h})},onDone:function(){if(console.log("onDone"),document.querySelectorAll(".Highlight").forEach((function(e){var t=e.parentElement;t.innerHTML=t.textContent})),s.data.isPlayingOn){var e=l(l({},s.data.caretPosition),{},{charStart:s.data.caretPosition.charEnd});s.updateWithParams({caretPosition:e}),x(document.querySelector(".Text-box"),e)}},onStart:function(){s.get("isPlayingOn")&&(e instanceof HTMLTextAreaElement&&!e.value||e instanceof HTMLDivElement&&!e.innerText||_(e,s.data.caretPosition))}};c.TtsEngine.init(z)};console.log=function(){},console.debug=function(){};var H=Date.now();function V(){return Math.round((Date.now()-H)/1e3)+": "}function j(){F()}"loading"===document.readyState?(console.log(V()+"Script awaiting to load all DOM"),window.addEventListener("DOMContentLoaded",(function(e){j()}))):(console.log(V()+"Loading script right away"),j())}()}();
//# sourceMappingURL=main.d30d2895.js.map