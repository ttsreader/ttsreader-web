<!DOCTYPE html>
<html lang="ja" data-dark-mode data-no-ads>
<head>
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "TTSReader Text to Speech Player V3",
      "description": "Listen to any text with the highest-quality expressive AI voices. TTSReader's Player is a free online text to speech reader that supports multiple languages and voices. It allows you to listen to your text, save it as an audio file, and even share it with others.",
      "applicationCategory": "WebApplication",
      "operatingSystem": "All",
      "browserRequirements": "Requires JavaScript",
      "url": "https://ttsreader.com/player/",
      "datePublished": "2023-05-01T00:00:00+00:00",
      "dateModified": "2025-06-05T06:36:33.505Z",
      "version": "3.4.3",
      "publisher": {
        "@type": "Organization",
        "name": "TTSReader - Text To Speech by WellSource Ltd.",
        "url": "https://ttsreader.com"
      }
    }
  </script>
  <!-- Include Quill stylesheet -->
  <link href="https://cdn.jsdelivr.net/npm/quill@2/dist/quill.snow.css" rel="stylesheet" />
  <!-- Include the Quill library -->
  <script src="https://cdn.jsdelivr.net/npm/quill@2/dist/quill.js"></script>

  <meta charset="utf-8" />
  <link rel="icon" href="favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="#a51b14" />
  <meta
          name="description"
          content="TTSReader's Player - Free Online Text to Speech Reader"
  />
  <link rel="apple-touch-icon" href="/favicon2.svg" />
  <!--
    manifest.json provides metadata used when your web app is installed on a
    user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
  -->
  <link rel="manifest" href="manifest.json" />
  <!--
    Notice the use of  in the tags above.
    It will be replaced with the URL of the `public` folder during the build.
    Only files inside the `public` folder can be referenced from the HTML.

    Unlike "/favicon.ico" or "favicon.ico", "/favicon.ico" will
    work correctly both with client-side routing and a non-root public URL.
    Learn how to configure a non-root public URL by running `npm run build`.
  -->
  <title>TTSReader V3.4.3 - TTSReaderのテキスト音声変換プレーヤー</title><!-- TTSReader's Text to Speech Player -->

  <!-- Google Analytics: -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-47292499-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-47292499-3');
  </script>
  <!-- End of Google Analytics: -->

  <script>
    // Dark mode toggle:
    let storedTheme = localStorage.getItem('theme-player-only');
    let DEFAULT_THEME = 'light-bg';

    if (!storedTheme) {
      let storedBlogTheme = localStorage.getItem('theme');

      if (!storedBlogTheme) {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          storedTheme = 'dark-no-bg';
        } else {
          storedTheme = DEFAULT_THEME;
        }
      } else {
        if (storedBlogTheme === 'dark') {
          storedTheme = 'dark-no-bg';
        } else {
          storedTheme = 'light-no-bg';
        }
      }
    }

    if (storedTheme === 'dark-no-bg') {
      window.setUiToDarkModeAndBgTheme(true, false);
    } else if (storedTheme === 'dark-bg') {
      window.setUiToDarkModeAndBgTheme(true, true);
    } else if (storedTheme === 'light-no-bg') {
      window.setUiToDarkModeAndBgTheme(false, false);
    } else if (storedTheme === 'light-bg') {
      window.setUiToDarkModeAndBgTheme(false, true);
    } else {
      window.setUiToDarkModeAndBgTheme(true, false);
    }

    // Drawer open
    let storedDrawerMode = localStorage.getItem('drawer-mode');
    if (!storedDrawerMode) {
      storedDrawerMode = 'close'; // Default to close if not set
    }

    if ((storedDrawerMode === 'open' || !storedDrawerMode) && window.matchMedia && window.matchMedia('(min-width: 800px)').matches && window.matchMedia('(min-height: 600px)').matches ) {
      toggleDrawerOpen();
    }

    function setUiToDarkModeAndBgTheme(isDark, isBg) {
      if (isBg===null || isBg===undefined) {
        isBg = document.documentElement.hasAttribute('data-theme-bg');
      }
      if (isDark && isBg) {
        document.documentElement.setAttribute('data-dark-mode','true');
        document.documentElement.setAttribute('data-theme-bg','true');
        localStorage.setItem('theme-player-only','dark-bg');
      } else if (isDark && !isBg) {
        document.documentElement.setAttribute('data-dark-mode','true');
        document.documentElement.removeAttribute('data-theme-bg');
        localStorage.setItem('theme-player-only','dark-no-bg');
      } else if (!isDark && isBg) {
        document.documentElement.removeAttribute('data-dark-mode');
        document.documentElement.setAttribute('data-theme-bg','true');
        localStorage.setItem('theme-player-only','light-bg');
      } else {
        document.documentElement.removeAttribute('data-dark-mode');
        document.documentElement.removeAttribute('data-theme-bg');
        localStorage.setItem('theme-player-only','light-no-bg');
      }
    }

    function toggleDrawerOpen() {
      let isOpen = document.documentElement.getAttribute('data-drawer-open')==='true';
      if (isOpen) {
        document.documentElement.removeAttribute('data-drawer-open');
        localStorage.setItem('drawer-mode','closed');
      } else {
        document.documentElement.setAttribute('data-drawer-open','true');
        localStorage.setItem('drawer-mode','open');
      }
    }

    function toggleTheme() {
      if (!window.setUiToDarkModeAndBgTheme) {
        console.log('no window.setUiToDarkModeAndBgTheme');
        return;
      }

      // dark -> dark+bg -> light -> light+bg -> dark
      let isDark = document.documentElement.getAttribute('data-dark-mode')==='true';
      let isBgImage = document.documentElement.getAttribute('data-theme-bg')==='true';

      if (isDark && isBgImage) {
        setUiToDarkModeAndBgTheme(false, false);
      } else if (isDark && !isBgImage) {
        setUiToDarkModeAndBgTheme(true, true);
      } else if (!isDark && !isBgImage) {
        setUiToDarkModeAndBgTheme(false, true);
      } else {
        setUiToDarkModeAndBgTheme(true, false);
      }
    }
  </script>

  <style>
    .highlight {
      background-color: #ff0;
      color: black;
    }
    .modal-step {
      background: url('./images/anima2_transparent_white.webp') no-repeat center;
      background-size: cover;
    }
    [data-dark-mode] .modal-step {
      background: url('./images/anima2_transparent_black.webp') no-repeat center;
      background-size: cover;
    }
    .modal-step-overlay {
      background: url('./images/anima2_transparent_white.webp') no-repeat center;
      background-size: cover;
    }
    [data-dark-mode] .modal-step-overlay {
      background: url('./images/anima2_transparent_black.webp') no-repeat center;
      background-size: cover;
    }
    body {
      transition: background 0.3s, color 0.3s;
    }

    .theme-toggle {
      display: flex;
      align-items: center;
      gap: 10px;
      user-select: none;
      font-size: 16px;
      margin: auto;
    }

    .theme-toggle .label {
      cursor: pointer;
    }

    .theme-toggle .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 28px;
    }

    .theme-toggle .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .theme-toggle .slider {
      position: absolute;
      cursor: pointer;
      inset: 0;
      background-color: #bbb;
      transition: 0.3s;
      border-radius: 30px;
    }

    .theme-toggle .slider::before {
      content: "";
      position: absolute;
      width: 22px;
      height: 22px;
      left: 3px;
      top: 3px;
      background-color: #fff;
      border-radius: 50%;
      transition: 0.3s;
    }

    .theme-toggle input:checked + .slider {
      background-color: #3b82f6;
    }

    .theme-toggle input:checked + .slider::before {
      transform: translateX(32px);
    }

    /* Quill styles */
    .ql-toolbar.ql-snow {
      border: none !important;
    }
  </style>
<script defer src="/static/js/main.099d1fb3.js"></script><link href="/static/css/main.ceaa6ee2.css" rel="stylesheet"></head>
<body>

<div id="root" style="display: flex;flex-direction: column; flex: 1;">

  <div class="Go-premium-banner" data-ws-show-if-state="isPremium=false" style="text-align: center;text-transform: uppercase;
    color: white;
    font-weight: bold;
    font-size: smaller;
    background-color: darkgreen;"><a style="cursor: pointer; text-decoration: none;color: white;display: block; padding: 10px;" data-ws-toggle="#upgradeModal" onclick="signInIfNeeded();">
    アップグレードするにはここをクリック。100%満足保証<!-- Click here to upgrade. 100% satisfaction guaranteed -->
  </a></div>

  <div style="flex: 1; display: flex;max-height: 100%;overflow: hidden;">
    <drawer style="overflow: hidden;max-height: 100%;">
      <div style="position: absolute;top:10px;right:10px;padding: 10px;cursor: pointer;" onclick="toggleDrawerOpen();">
        <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-chevron-left"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 6l-6 6l6 6" /></svg>
      </div>
      <div style="padding: 10px;margin-top: 50px;overflow-x: hidden;overflow-y: auto;padding-bottom: 100px;">
        <div>
          <a title="Text To Speech Solutions"  aria-label="Text To Speech Solutions" class="Menu-list-element" href="https://ttsreader.com" target="_blank" style="text-decoration:none;display: flex;align-items: center">
            <svg  class="Top-btn-svg" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l-2 0l9 -9l9 9l-2 0" /><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" /><path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" /></svg>&nbsp;&nbsp;<strong style="display: block"><span style="color: darkred">TTS</span>Reader Text To Speech</strong>
          </a>
        </div>
        <div data-ws-show-if-state="isSignedIn=false">
          <a class="Menu-list-element" onclick="toggleSignIn();" style="text-decoration: none;display: block"><svg class="Top-btn-svg"><path d="M11 7 9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5-5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8v14z"></path></svg>&nbsp;&nbsp;サインイン / サインアップ<!-- Sign in / Sign up --></a>
        </div>
        <div data-ws-show-if-state="isSignedIn=true" style="display: flex;align-items: center;">
          <p data-ws-show-if-state="isSignedIn=true" style="text-decoration: none;padding-left:10px; display: block;flex:1"><i><span data-ws-label-state="email"></span></i></p>
          <a class="Menu-list-element" onclick="toggleSignIn();" style="padding: 10px;" title="Sign out" aria-label="Sign out">
            <svg class="Top-btn-svg"><path d="m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"></path></svg>
          </a>
        </div>
        <div data-ws-show-if-state="isPremium=false">
          <a class="Menu-list-element" data-ws-toggle="#upgradeModal" onclick="signInIfNeeded();" style="cursor: pointer;text-decoration: none;display: block">🏆&nbsp;&nbsp;&nbsp;プレミアムにアップグレード<!-- Go Premium -->&nbsp;&nbsp;&nbsp;</a>
        </div>
        <div data-ws-show-if-state="isPremium=true">
          <a class="Menu-list-element" data-ws-toggle="#upgradeModal" style="cursor: pointer;text-decoration: none;display: block">-&nbsp;&nbsp;<svg class="Top-btn-svg" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round" ><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z" /></svg>&nbsp;&nbsp;プレミアム🏆ステータス<!-- Premium 🏆 Status --></a>
        </div>
        <div data-ws-show-if-state="isSignedIn=true">
          <a href="https://ttsreader.com/account/" rel="nofollow" target="_blank" data-ws-show-if-state="isSignedIn=true" class="Menu-list-element" style="text-decoration: none;display: block">-&nbsp;&nbsp;<svg class="Top-btn-svg" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round" ><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" /><path d="M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855" /></svg>&nbsp;&nbsp;Manage Account</a>
        </div>

        <div class="Menu-list-element" style="position: relative;">
          <input style="position: absolute;display: block;opacity: 0; right:0;left:0;top:0;bottom:0; cursor: pointer" type="file" accept=".csv, .json, .txt, .rtf, .pdf, .epub, .docx, .html, .htm" data-ws-onChange="handleFileSelect">
          <a onclick="gtag('event','import_file_click_player_drawer',{value:'1'})"  data-ws-onClick="openFile" style="text-decoration:none;display: flex;align-items: center">
            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-file-word"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2" /><path d="M9 12l1.333 5l1.667 -4l1.667 4l1.333 -5" /></svg>&nbsp;&nbsp;<span style="display: block;flex: 1;">Import File (DOCX, TXT, PDF, EPUB, ...)</span> <!-- Document Stats -->
          </a>
        </div>
        <div>
          <a class="Menu-list-element" onclick="gtag('event','stats_click_player_drawer',{value:'1'})" data-ws-onClick="calculateStats" data-ws-toggle="#statsModal" style="text-decoration:none;">
            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-file-analytics"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M9 17l0 -5" /><path d="M12 17l0 -1" /><path d="M15 17l0 -3" /></svg>&nbsp;&nbsp;Document Stats <!-- Document Stats -->
          </a>
        </div>
        <div>
          <a class="Menu-list-element" onclick="gtag('event','mp3_export_click_player_drawer',{value:'1'})" data-ws-onClick="calculateStats" data-ws-toggle="#exportModal" style="text-decoration:none;">
            <svg class="Top-btn-svg" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M11 16m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M12 16l0 -5l2 1" /></svg>&nbsp;&nbsp;mp3音声ファイルをダウンロード<!-- Download mp3 audio file -->
          </a>
        </div>
        <a class="Menu-list-element" data-ws-toggle="#voicesModal" onclick="gtag('event','more_voices_click_player_drawer',{value:'1'});">
          <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-user"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" /><path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" /></svg>&nbsp;&nbsp;もっと多くの音声が必要です<!-- Need more voices -->
        </a>
        <div>
          <a href="https://ttsreader.com/docs/guides/voiceover/#mix-languages-voices--speeds" target="_blank" class="Menu-list-element" onclick="gtag('event','drawer_click_multivoices',{value:'1'})" style="text-decoration:none;">
            <svg class="Top-btn-svg" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" /><path d="M3 21v-2a4 4 0 0 1 4 -4h4c.96 0 1.84 .338 2.53 .901" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /><path d="M16 19h6" /><path d="M19 16v6" /></svg>&nbsp;&nbsp;Multi-Voice Dialogs
          </a>
        </div>

        <a class="Menu-list-element" href="/docs/guides/quick-start-new-player/" target="_blank" style="text-decoration: none;display: block">
          <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-file-info"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M11 14h1v4h1" /><path d="M12 11h.01" /></svg>&nbsp;&nbsp;ユーザーマニュアル<!-- User manual -->
        </a>
        <a class="Menu-list-element" data-ws-toggle="#helpModal" onclick="loadImages('#helpImgId');">
          <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-help"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M12 17l0 .01" /><path d="M12 13.5a1.5 1.5 0 0 1 1 -1.5a2.6 2.6 0 1 0 -3 -4" /></svg>&nbsp;&nbsp;ヘルプオーバーレイ<!-- Help overlay -->
        </a>


        <a class="Menu-list-element" href="/docs/guides/commercial/" target="_blank" style="text-decoration: none;display: block">
          <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-video"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l4.553 -2.276a1 1 0 0 1 1.447 .894v6.764a1 1 0 0 1 -1.447 .894l-4.553 -2.276v-4z" /><path d="M3 6m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z" /></svg>&nbsp;&nbsp;商業出版<!-- Commercial & publishing -->
        </a>
        <!--<a class="Menu-list-element" href="https://speechnotes.co/files/webm_to_mp3/" target="_blank" style="text-decoration: none;display: block">Convert webm to mp3</a>-->
        <!--<a class="Menu-list-element" href="/mobile/" target="_blank" style="text-decoration: none;display: block">
          モバイルバージョン&lt;!&ndash; Mobile versions &ndash;&gt;
        </a>-->
        <a class="Menu-list-element" href="https://docs.google.com/forms/d/e/1FAIpQLSecnm9ZnFje9S6OSSQqP4Ts4av-hSmhAUbuLvQAojWUdckAtg/viewform?usp=sf_link" target="_blank" style="text-decoration: none;display: block">
          <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-message-circle"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 20l1.3 -3.9c-2.324 -3.437 -1.426 -7.872 2.1 -10.374c3.526 -2.501 8.59 -2.296 11.845 .48c3.255 2.777 3.695 7.266 1.029 10.501c-2.666 3.235 -7.615 4.215 -11.574 2.293l-4.7 1" /></svg>&nbsp;&nbsp;フィードバックフォーム<!-- Feedback form -->
        </a>
        <div data-ws-show-if-state="isShareSupported=true">
          <a class="Menu-list-element" onclick="share();"><svg style="vertical-align: middle" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-share" width="27" height="27" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
            <path d="M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
            <path d="M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
            <path d="M8.7 10.7l6.6 -3.4"></path>
            <path d="M8.7 13.3l6.6 3.4"></path>
          </svg>&nbsp;&nbsp;Share</a>
        </div>
        <div data-ws-show-if-state="isShareSupported=false">
          <a class="Menu-list-element" data-ws-toggle="#shareModal"><svg style="vertical-align: middle" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-share" width="27" height="27" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
            <path d="M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
            <path d="M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
            <path d="M8.7 10.7l6.6 -3.4"></path>
            <path d="M8.7 13.3l6.6 3.4"></path>
          </svg>&nbsp;&nbsp;Share</a>
        </div>
        <div class="Menu-list-element" >
          <a class="Menu-list-element" href="/versions/" target="_blank" style="display: block; text-decoration: none">
          <b>V3.4.3</b> Build 2025-06-05T06:36:33.505Z
          <br/><span style="margin-top: 10px;display: block">ALL VERSIONS <svg style="vertical-align: bottom;" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-external-link"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6" /><path d="M11 13l9 -9" /><path d="M15 4h5v5" /></svg></span></a>
        </div>
        <div style="margin: 20px auto; text-align: center;">
          <b>Complementary Utils</b>
        </div>
        <div>
          <a class="Menu-list-element" href="https://speechnotes.co/dictate/" target="_blank" style="text-decoration: none;display: block">
            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-microphone"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 2m0 3a3 3 0 0 1 3 -3h0a3 3 0 0 1 3 3v5a3 3 0 0 1 -3 3h0a3 3 0 0 1 -3 -3z" /><path d="M5 10a7 7 0 0 0 14 0" /><path d="M8 21l8 0" /><path d="M12 17l0 4" /></svg>&nbsp;&nbsp;Speech to Text
          </a>
        </div>
        <div>
          <a class="Menu-list-element" href="https://speechnotes.co/transcribe/" target="_blank" style="text-decoration: none;display: block">
            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-device-audio-tape"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 5m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z" /><path d="M3 17l4 -3h10l4 3" /><circle cx="7.5" cy="9.5" r=".5" fill="currentColor" /><circle cx="16.5" cy="9.5" r=".5" fill="currentColor" /></svg>&nbsp;&nbsp;Automatic AI Transcription
          </a>
        </div>
        <div>
          <a class="Menu-list-element" onclick="gtag('event','audioread_click_player_drawer',{value:'1'})" href="https://audioread.com/?via=ttsreader" target="_blank" rel="nofollow" style="text-decoration:none;">
            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon-tabler-headphones"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 13m0 2a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v3a2 2 0 0 1 -2 2h-1a2 2 0 0 1 -2 -2z" /><path d="M15 13m0 2a2 2 0 0 1 2 -2h1a2 2 0 0 1 2 2v3a2 2 0 0 1 -2 2h-1a2 2 0 0 1 -2 -2z" /><path d="M4 15v-3a8 8 0 0 1 16 0v3" /></svg>&nbsp;&nbsp;ポッドキャストに変換<!-- Turn into podcast -->
            <span style="font-size: 0.5em; color: orange; position: relative; top: -5px; left: 2px; display: inline-block;">パートナー<!-- Partner --></span>
          </a>
        </div>
        <div>
          <a class="Menu-list-element" href="/sounds/" target="_blank" style="text-decoration: none;display: block">
            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="Top-btn-svg icon icon-tabler icons-tabler-outline icon-tabler-bell-ringing"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 5a2 2 0 0 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6" /><path d="M9 17v1a3 3 0 0 0 6 0v-1" /><path d="M21 6.727a11.05 11.05 0 0 0 -2.794 -3.727" /><path d="M3 6.727a11.05 11.05 0 0 1 2.792 -3.727" /></svg>&nbsp;&nbsp;Beeps Generator
          </a>
        </div>
      </div>

    </drawer>
    <div style="display: flex; flex-direction: column; flex: 1;max-width: 100%;">

      <div class="Buttons-bar" style="display: flex">
        <button title="Open / close main drawer" aria-label="Open / close main drawer" style="" onclick="toggleDrawerOpen();">
          <svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg>
        </button>
        <!--<a class="Hide-on-narrow-screens" href="https://ttsreader.com" alt="TTSReader Home" title="TTSReader Home" style="background-image: url('favicon2.svg');background-size: contain;width: 40px;height: 40px; border-radius: 10px;"></a>-->
        <span style="display: inline-block;flex: 1"></span>
        <button title="Open file" aria-label="Open file" data-ws-onClick="openFile" style="display: inline-block;position: relative;overflow: hidden;"><span>📂<span class="Hide-on-narrow-screens">&nbsp;開く<!-- Open --></span></span><input style="position: absolute;display: block;opacity: 0; right:0;left:0;top:0;bottom:0; cursor: pointer" type="file" accept=".csv, .json, .txt, .rtf, .pdf, .epub, .docx, .html, .htm" data-ws-onChange="handleFileSelect"></button>
        &nbsp;
        <button class="Clear-btn" data-ws-toggle="#openUrlModal" title="Read Web Page" aria-label="Read Web Page">
          <svg style="position: relative; bottom: -2px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-world-www"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19.5 7a9 9 0 0 0 -7.5 -4a8.991 8.991 0 0 0 -7.484 4" /><path d="M11.5 3a16.989 16.989 0 0 0 -1.826 4" /><path d="M12.5 3a16.989 16.989 0 0 1 1.828 4" /><path d="M19.5 17a9 9 0 0 1 -7.5 4a8.991 8.991 0 0 1 -7.484 -4" /><path d="M11.5 21a16.989 16.989 0 0 1 -1.826 -4" /><path d="M12.5 21a16.989 16.989 0 0 0 1.828 -4" /><path d="M2 10l1 4l1.5 -4l1.5 4l1 -4" /><path d="M17 10l1 4l1.5 -4l1.5 4l1 -4" /><path d="M9.5 10l1 4l1.5 -4l1.5 4l1 -4" /></svg>
        </button>
        &nbsp;
        <button class="Clear-btn" data-ws-onClick="clearContent" title="Erase all text from document" aria-label="Erase all text from document">🗑️</button>
        &nbsp;
        <button title="Select language, voice and speed" aria-label="Select language, voice and speed" style="" data-ws-toggle="#voicesModal">
          <svg class="Top-btn-svg" style="width:1.5em;height: 1.5em;" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><circle cx="9" cy="9" r="4"></circle><path d="M9 15c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4zm7.76-9.64-1.68 1.69c.84 1.18.84 2.71 0 3.89l1.68 1.69c2.02-2.02 2.02-5.07 0-7.27zM20.07 2l-1.63 1.63c2.77 3.02 2.77 7.56 0 10.74L20.07 16c3.9-3.89 3.91-9.95 0-14z"></path></svg>
          <span class="Hide-on-narrow-screens">
        &nbsp;
        <span class="Voice-label Flag-font" data-ws-label-state="voiceLabel"></span>
        <span data-ws-label-state="selectedRate"></span>X
        &nbsp;
        <svg class="Top-btn-svg" style="margin-left: -10px;" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="m7 10 5 5 5-5z"></path></svg>
      </span>
        </button>
        &nbsp;
        <button data-ws-toggle="#addPauseModal" title="Insert pause in reading" aria-label="Insert pause in reading">
          <svg xmlns="http://www.w3.org/2000/svg" class="Top-btn-svg" style="width: 1.3em; height: 1.3em;" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M20.942 13.018a9 9 0 1 0 -7.909 7.922"></path>
            <path d="M12 7v5l2 2"></path>
            <path d="M17 17v5"></path>
            <path d="M21 17v5"></path>
          </svg>
        </button>
        &nbsp;
        <div class="Dropdown-header" style="display: inline-block; vertical-align: middle;cursor: pointer;position: relative;"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M5 17v2h14v-2H5zm4.5-4.2h5l.9 2.2h2.1L12.75 4h-1.5L6.5 15h2.1l.9-2.2zM12 5.98 13.87 11h-3.74L12 5.98z"></path></svg>
          <div class="Dropdown-content" style="left:0;width:120px; translate: -40px;">
            <span data-ws-onClick="fontDecrease" style="display: inline-block; line-height: 20px; font-size: 18px; margin: 5px; padding: 5px; border-radius: 50%;background-color: white; color: blue;fill:blue;"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M.99 19h2.42l1.27-3.58h5.65L11.59 19h2.42L8.75 5h-2.5L.99 19zm4.42-5.61L7.44 7.6h.12l2.03 5.79H5.41zM23 11v2h-8v-2h8z"></path></svg></span>
            <span data-ws-onClick="fontIncrease" style="display: inline-block; line-height: 20px; font-size: 18px; margin: 5px; padding: 5px; border-radius: 50%;background-color: white; color: blue;fill:blue;"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M.99 19h2.42l1.27-3.58h5.65L11.59 19h2.42L8.75 5h-2.5L.99 19zm4.42-5.61L7.44 7.6h.12l2.03 5.79H5.41zM20 11h3v2h-3v3h-2v-3h-3v-2h3V8h2v3z"></path></svg></span>
          </div>
        </div>
        &nbsp;
        <button onclick="toggleTheme();" class="btn btn-link" type="button" aria-label="Toggle user interface mode">
          <span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path></svg></span><span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
        </button>
        &nbsp;
        <button data-ws-show-if-state="isPremium=true" data-ws-toggle="#upgradeModal" style="position: relative;top:-1px;">🏆</button>
        <span style="flex: 1"></span>

        <button title="Text analytics - word counter & more" aria-label="Text analytics - word counter & more" style="" data-ws-onClick="calculateStats" data-ws-toggle="#statsModal">
          <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-file-analytics"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /><path d="M9 17l0 -5" /><path d="M12 17l0 -1" /><path d="M15 17l0 -3" /></svg>
        </button>
        <button title="Interface Language Selector" aria-label="Interface Language Selector" style="" data-ws-toggle="#interfaceLangModal">
          <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-language"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7" /><path d="M9 3v2c0 4.418 -2.239 8 -5 8" /><path d="M5 9c0 2.144 2.952 3.908 6.7 4" /><path d="M12 20l4 -9l4 9" /><path d="M19.1 18h-6.2" /></svg>
        </button>
      </div>

      <div style="display: flex;flex: 1;overflow: hidden;">

        <div style="flex: 1;display: flex;flex-direction: column;overflow: hidden;">
          <div class="App"  style="flex: 1;position: relative;display: flex;flex-direction: column">
            <div class="Book-bar" data-ws-show-if-state="isBook=true" style="text-align: center">
              <span data-ws-label-state="bookTitle"></span>&nbsp;-&nbsp;
              <button data-ws-onClick="loadPrevChapter" title="Load Previous Chapter" aria-label="Load Previous Chapter"><b>&lArr;</b></button>
              <span data-ws-label-state="currentChapterLabel"></span> / <span data-ws-label-state="totalChapters"></span>
              <button data-ws-onClick="loadNextChapter" title="Load Next Chapter" aria-label="Load Next Chapter"><b>&rArr;</b></button>
            </div>
            <div class="Text-box-container" data-ws-style-state="font-size=selectedFontSize">
              <!-- Create the toolbar container -->
              <!--<div id="toolbar"></div>-->
              <!-- Create the editor container -->
              <div id="editor" class="Text-box Text-box-quill" style="font-size: 1em;">
              </div>

              <!-- Initialize Quill editor -->
              <script>

                // ✅ Define the custom highlight blot
                const Inline = Quill.import('blots/inline');
                class HighlightBlot extends Inline {
                  static create(value) {
                    return super.create();
                  }
                  static formats(node) {
                    return true;
                  }
                }
                HighlightBlot.blotName = 'highlight';
                HighlightBlot.tagName = 'span';
                HighlightBlot.className = 'Highlight';
                Quill.register(HighlightBlot);

                class BlinkBlot extends Inline {
                  static create(value) {
                    return super.create();
                  }
                  static formats(node) {
                    return true;
                  }
                }
                BlinkBlot.blotName = 'blink';
                BlinkBlot.tagName = 'span';
                BlinkBlot.className = 'Blink';
                Quill.register(BlinkBlot);

                const quill = new Quill('#editor', {
                  modules: {
                    toolbar: [
                      [{ header: [1, 2, 3, 4, false] }],
                      ['bold', 'underline', 'italic'],
                      ['clean'] // remove formatting button
                    ]
                  },
                  formats: [
                    'highlight',
                    'blink',        // Custom blink format
                    'link',
                    'header',      // h1, h2, ...
                    'bold',        // <strong>
                    'underline',   // <u>
                    'italic',       // <em>
                    'strike'       // <strike>
                  ],
                  theme: 'snow',
                  placeholder: 'このボックスにテキストを入力または貼り付けて、再生ボタンをクリックすると、あなたのためにそれを読み上げます。ウェブページを読み取るには、URLを貼り付けて再生をクリックしてください。また、ファイルのアップロード、音声、テーマ、フォントサイズなどを変更することもできます。' // Placeholder text
                });

                window.quill = quill; // Make Quill accessible globally

                const sentenceBreakRegex = /[.?!…]+[\s\n]+|[\n]+/g;

                function getCaretIndexOrHighlightEnd() {
                  const highlight = quill.root.querySelector('span.highlight');
                  const fullText = quill.getText();
                  if (highlight) {
                    const highlightedText = highlight.innerText;
                    const start = fullText.indexOf(highlightedText);
                    if (start !== -1) return start + highlightedText.length;
                  }
                  const sel = quill.getSelection();
                  return sel ? sel.index : 0;
                }

                function findNextSentence(caretIndex) {
                  const text = quill.getText();
                  sentenceBreakRegex.lastIndex = caretIndex;

                  const breakMatch = sentenceBreakRegex.exec(text);
                  if (!breakMatch) return null;

                  const sentenceStart = sentenceBreakRegex.lastIndex;
                  const nextBreak = sentenceBreakRegex.exec(text);
                  const sentenceEnd = nextBreak ? nextBreak.index : text.length;

                  return { start: sentenceStart, end: sentenceEnd };
                }

                function findPreviousSentence(caretIndex) {
                  const text = quill.getText();
                  let lastBreak = 0;
                  let nextBreak;

                  sentenceBreakRegex.lastIndex = 0;

                  while ((nextBreak = sentenceBreakRegex.exec(text)) !== null) {
                    if (nextBreak.index >= caretIndex) break;
                    lastBreak = sentenceBreakRegex.lastIndex;
                  }

                  const sentenceStart = lastBreak;
                  const sentenceEnd = caretIndex;

                  return sentenceStart < sentenceEnd ? { start: sentenceStart, end: sentenceEnd } : null;
                }

                function highlightRange(start, end) {
                  quill.formatText(0, quill.getLength(), 'highlight', false); // clear previous
                  quill.formatText(start, end - start, 'highlight', true);

                  const el = quill.root.querySelector('span.highlight');
                  if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }

                /*document.getElementById('nextBtn').addEventListener('click', () => {
                  console.log('Previous button clicked');
                  const caret = getCaretIndexOrHighlightEnd();
                  const range = findNextSentence(caret);
                  if (range) highlightRange(range.start, range.end);
                });

                document.getElementById('prevBtn').addEventListener('click', () => {
                  console.log('Previous button clicked');
                  const caret = getCaretIndexOrHighlightEnd();
                  const range = findPreviousSentence(caret);
                  if (range) highlightRange(range.start, range.end);
                });*/

              </script>

              <!--<div class="Text-box" contentEditable="plaintext-only" data-ws-style-state="font-size=selectedFontSize" data-ws-onPaste="onPaste" data-ws-onInput="onInput" placeholder="このボックスにテキストを入力または貼り付けて、再生ボタンをクリックすると、あなたのためにそれを読み上げます。ウェブページを読み取るには、URLを貼り付けて再生をクリックしてください。また、ファイルのアップロード、音声、テーマ、フォントサイズなどを変更することもできます。" placeholder2="このプレーヤーは活発に開発中で、毎日改善に努めています。❤️リスニングをお楽しみください！🎧"></div>-->
            </div>
            <div class="Playback-buttons-bar" style="direction: ltr;">
          <span>
            <button data-ws-show-if-state="isRepeatMode=false" title="Loop" aria-label="Loop"                              data-ws-onClick="toggleRepeatMode"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 12v-3a3 3 0 0 1 3 -3h13m-3 -3l3 3l-3 3"></path><path d="M20 12v3a3 3 0 0 1 -3 3h-13m3 3l-3 -3l3 -3"></path></svg></button>
            <button data-ws-show-if-state="isRepeatMode=true" title="Loop" aria-label="Loop" style="color: cornflowerblue" data-ws-onClick="toggleRepeatMode"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 12v-3a3 3 0 0 1 3 -3h13m-3 -3l3 3l-3 3"></path><path d="M20 12v3a3 3 0 0 1 -3 3h-13m3 3l-3 -3l3 -3"></path></svg></button>
            <button class="Hide-on-narrow-screens" data-ws-show-if-state="isRecordingSupported=true" title="Go to beginning" aria-label="Go to beginning" data-ws-onClick="goToStart"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6 8.5 6V6z"></path></svg></button>
            <button title="Jump backwards" aria-label="Jump backwards" data-ws-onClick="rewind"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M11 18V6l-8.5 6 8.5 6zm.5-6 8.5 6V6l-8.5 6z"></path></svg></button>
            <span style="display: inline-block; width: 80px;"></span>
            <button title="Jump forward" aria-label="Jump forward" data-ws-onClick="forward"><svg class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="m4 18 8.5-6L4 6v12zm9-12v12l8.5-6L13 6z"></path></svg></button>
            <button class="Hide-on-narrow-screens" title="Toggle recording" aria-label="Toggle recording" data-ws-show-if-state="isRecordingSupported=true" data-ws-onClick="toggleRecord">
              <svg data-ws-show-if-state="isRecordingOn=false" class="Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path></svg>
              <svg data-ws-show-if-state="isRecordingOn=true"  class="hidden Blinking-record-btn Top-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path></svg>
            </button>
            <button title="Export to audio file" aria-label="Click to generate downloadable audio file" data-ws-onClick="calculateStats" data-ws-toggle="#exportModal">
              <svg  class="Top-btn-svg" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>
            </button>
            <button id="Play-btn" data-ws-onClick="togglePlay" title="Play / Pause" aria-label="Play / Pause">
              <span data-ws-show-if-state="isPlayingOn=true" class="hidden"><svg class="Play-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg></span>
              <span data-ws-show-if-state="isPlayingOn=false"><svg class="Play-btn-svg" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></svg></span>
            </button>
          </span>
            </div>
          </div>

          <div class="remaining-chars-line" data-ws-show-if-state="isPremium=false" style="text-align: center; cursor: pointer; padding: 2px 10px;" data-ws-toggle="#upgradeModal">
            <p>
              使用済み<!-- Used -->
              <b>
                <span data-ws-label-state="charsUsedToday"></span>&nbsp;/&nbsp;
                <span data-ws-label-state="dailyCharsLimit"></span>
              </b>
              1日あたりの無料文字数。制限を解除するにはクリックしてください。<!-- free chars per day. Click to remove limit. -->
            </p>
          </div>
          <!--<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5434274073094626"
                  crossorigin="anonymous"></script>-->
          <!-- ResponsiveHorizontal20230518 -->
          <!--<ins class="adsbygoogle Ad Ad-bottom-banner"
               data-ad-client="ca-pub-5434274073094626"
               data-ad-slot="8622089184" data-ws-show-if-state="isPremium=false"></ins>
          -->
          <div class="Bottom-lift-up" style="height: 0;width: 100%;"></div>
        </div>

        <!-- ResponsiveVertical20230518 -->
        <!--<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5434274073094626"
                crossorigin="anonymous"></script>-->
        <!--<ins class="adsbygoogle Ad Ad-right-banner"
             data-ad-client="ca-pub-5434274073094626"
             data-ad-slot="1642597928" data-ws-show-if-state="isPremium=false"></ins>-->

      </div>

    </div>
  </div>

  <div id="onboardingModal" style="display: none;" dir="">
    <div data-ws-step="1" class="modal-step" style="background: url('/images/anima2.webp') no-repeat center;background-size: cover;">
      <div style="flex:1"></div>
      <h1><span style="color:darkred;">TTS</span>Reader 3へようこそ<!-- Welcome to <span style="color:darkred;">TTS</span>Reader 3 --></h1>
      <h2 style="font-size: smaller; font-weight: normal">日本語などの言語でのテキスト読み上げ</h2>
      <p>リアルなAI音声でテキストに命を吹き込もう<!-- Bring text to life with realistic AI voices --></p>
      <br/>
      <button class="primary" onclick="nextStep(this)" style="margin: auto;">はじめる<!-- Let's Start --></button>
      <br/><br/>
      <div data-nosnippet class="theme-toggle">
        <span class="label">🌞 ライト<!-- 🌞 Light --></span>
        <label class="switch">
          <input type="checkbox" class="themeSwitch">
          <span class="slider"></span>
        </label>
        <span class="label">🌙 ダーク<!-- 🌙 Dark --></span>
      </div>

      <br/>
      <p style="font-size: smaller"><i>By continuing you agree to our <a href="/docs/legal/terms/" target="_blank">terms</a> & <a href="/docs/legal/privacy/" target="_blank">privacy policy</a></i></p>

      <div style="flex:1;" ></div>
    </div>

    <div data-ws-step="2" class="modal-step" style="display: none">
      <div class="modal-content">
        <div style="flex:1"></div>
        <p style="font-size: larger;">読み取り言語を選択<!-- Select Your Reading Language --></p>
        <select class="Language-selector Flag-font" data-ws-onChange="handleLanguageChange" data-ws-value-state="selectedLanguageCode" style="font-size: 1.1em;"></select>
        <p>後でいつでも変更できます。<!-- You can always change it later. --></p>
        <br/>
        <div>
          <button class="primary" onclick="nextStep(this)">次へ<!-- Next --></button>
        </div>
        <br/>
        <div style="flex:0.67"></div>
        <div data-nosnippet class="theme-toggle">
          <span class="label">🌞 ライト<!-- 🌞 Light --></span>
          <label class="switch">
            <input type="checkbox" class="themeSwitch">
            <span class="slider"></span>
          </label>
          <span class="label">🌙 ダーク<!-- 🌙 Dark --></span>
        </div>
        <div style="flex:0.33"></div>
      </div>

      <div data-ws-show-if-state="ttsReady=false" style="position: absolute;top:0;bottom:0;right:0;left:0;text-align: center;">
        <div style="width: 100%;height: 100%;display: flex;flex-direction: column;background-color: white;">
          <div style="flex: 1"></div>
          <div class="voice-loader-container">
            <div class="wave-loader">
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
              <div class="bar"></div>
            </div>
            <br/>
            <div class="loading-text">
              <p style="font-size: larger;">音声を読み込み中...<!-- Loading voices... --></p>
              <p>しばらくお待ちください<!-- This will only take a moment --></p>
            </div>
          </div>
          <div style="flex: 1"></div>
        </div>
      </div>
    </div>

    <div data-ws-step="3" class="modal-step" style="display: none">
      <div class="modal-header">
        <span>好みの音声を選択<!-- Select Your Preferred Voice --></span><br/>
        <span style="font-size: 16px;opacity: 0.8;">音声をクリックしてその音を確認してください。準備ができたら、<a style="color: orangered;cursor: pointer" onclick="nextStep(this)">次へ</a>をタップしてください。<!-- Click a voice to hear how it sounds. When ready, tap <a style="color: orangered;cursor: pointer" onclick="nextStep(this)">Next</a>. --></span>
      </div>
      <div class="modal-content">
        <div style="flex:1"></div>
        <div class="Voices-Gallery" style="max-width: 600px; margin: auto;">
          <!-- Container to be filled by js. Keep empty. -->
        </div>
        <template id="voiceTileTemplate">
          <div class="voice-tile" data-ws-voiceURI="ttsreader.gcp.standard-A" data-ws-audio-src="https://ttsreader.com/player/audio/Christopher.mp3" style="font-size: larger; position: relative;">
            <div>
              <span class="voice-name">David</span>
            </div>
            <div class="Voice-Icons">
              <span class="voice-gender-male" title="Male">👨</span>
              <span class="voice-gender-female" title="Female">👩</span>
              <span class="voice-lang Flag-font">🇬🇧</span>
              <span class="voice-premium" title="Premium Voice">🌟</span>
              <span class="voice-publishing" title="Allowed for Publishing for Premium Users">
                <svg style="width:1em;height:1em;position: relative;top:3px;" class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1phnduy" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
                  <path d="M14 12c0 .74-.4 1.38-1 1.72V22h-2v-8.28c-.6-.35-1-.98-1-1.72 0-1.1.9-2 2-2s2 .9 2 2m-2-6c-3.31 0-6 2.69-6 6 0 1.74.75 3.31 1.94 4.4l1.42-1.42C8.53 14.25 8 13.19 8 12c0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.19-.53 2.25-1.36 2.98l1.42 1.42C17.25 15.31 18 13.74 18 12c0-3.31-2.69-6-6-6m0-4C6.48 2 2 6.48 2 12c0 2.85 1.2 5.41 3.11 7.24l1.42-1.42C4.98 16.36 4 14.29 4 12c0-4.41 3.59-8 8-8s8 3.59 8 8c0 2.29-.98 4.36-2.53 5.82l1.42 1.42C20.8 17.41 22 14.85 22 12c0-5.52-4.48-10-10-10"></path>
                </svg>&nbsp;
              </span>
            </div>
            <div class="checkmark">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="icon icon-tabler icons-tabler-filled icon-tabler-circle-check">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z" />
              </svg>
            </div>
          </div>
        </template>
        <div style="flex:2"></div>
      </div>
      <div class="modal-footer">
        <p style="opacity: 0.8">
          <svg style="width:1em;height:1em;" class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-1phnduy" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
            <path d="M14 12c0 .74-.4 1.38-1 1.72V22h-2v-8.28c-.6-.35-1-.98-1-1.72 0-1.1.9-2 2-2s2 .9 2 2m-2-6c-3.31 0-6 2.69-6 6 0 1.74.75 3.31 1.94 4.4l1.42-1.42C8.53 14.25 8 13.19 8 12c0-2.21 1.79-4 4-4s4 1.79 4 4c0 1.19-.53 2.25-1.36 2.98l1.42 1.42C17.25 15.31 18 13.74 18 12c0-3.31-2.69-6-6-6m0-4C6.48 2 2 6.48 2 12c0 2.85 1.2 5.41 3.11 7.24l1.42-1.42C4.98 16.36 4 14.29 4 12c0-4.41 3.59-8 8-8s8 3.59 8 8c0 2.29-.98 4.36-2.53 5.82l1.42 1.42C20.8 17.41 22 14.85 22 12c0-5.52-4.48-10-10-10"></path>
          </svg>&nbsp;
          これは、<a style="color: orangered;cursor: pointer;" data-ws-toggle="#upgradeModal">プレミアムライセンス</a>により、音声の公開が許可されていることを示します。<!-- Indicates voice is allowed for publishing, given a <a style="color: orangered;cursor: pointer;" data-ws-toggle="#upgradeModal">Premium License</a>. -->
        </p>
        <button class="secondary" onclick="prevStep(this)">戻る<!-- Back --></button>
        <button class="primary" onclick="nextStep(this)">次へ<!-- Next --></button>
      </div>
    </div>

    <div data-ws-step="4" class="modal-step" style="display: none;">
      <div style="flex:1"></div>
      <h1>すべて整いました<!-- You're all set --></h1>
      <p style="max-width: 600px; margin: auto;">次の画面にはテキストボックスがあり、そこに自分のテキストを入力するか、上部のボタンを使ってファイルを選択できます。準備ができたら、下部の「再生」ボタンをクリックしてお楽しみください。<!-- In the next view you'll have a text box, where you can input your own text or select a file using the buttons at the top. When ready, click the 'play' button at the bottom and enjoy listening. --></p>
      <br/>
      <button class="primary" onclick="closeOnboarding()" style="margin: auto;">さあ、始めましょう<!-- Let's Go --></button>
      <div style="flex:2"></div>

      <!-- Sign in overlay if premium voice -->
      <div data-ws-show-if-state="isSignedIn=false">
        <div data-ws-show-if-state="isVoicePremium=true" class="hidden">
          <div class="modal-step-overlay" style="display:flex;position: absolute;top:0;bottom:0;left:0;right:0;flex-direction: column">
            <div style="flex:1"></div>
            <p style="max-width: 600px; margin: auto;font-size: larger;">選択した音声 <span data-ws-label-state="voiceLabel"></span>&nbsp; は優れた選択です！プレミアム音声のため、サインインが必要です。<br/><br/>続行するにはGoogleで安全にサインインしてください。<!-- The voice you selected <span data-ws-label-state="voiceLabel"></span>&nbsp; is an excellent choice! As it is a premium voice, sign-in is required.
              <br/><br/>Please securely sign in with Google to continue. --></p>
            <br/><br/>
            <button onclick="signIn();" class="primary" style="margin: auto;border: 1px solid;max-width: 500px;border-radius: 10px;">Googleでサインイン<!-- Sign In with Google --></button>
            <br/>
            <p>パスワードや支払い方法は必要ありません。<!-- No password or payment method required. --></p>
            <div style="flex:2"></div>
            <div class="modal-footer">
              <button class="secondary" onclick="prevStep(this)">戻る<!-- Back --></button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div data-ws-show-if-state="isSignedIn=false">
  <div class="Modal" id="premiumVoiceSignInModal" style="display: none;">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="display: flex; flex-direction: column;">
      <button class="Close-modal" style="z-index: 999">
        <svg focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <div style="flex: 1"></div>
      <p style="font-size: larger;">選択した音声 <span data-ws-label-state="voiceLabel"></span>&nbsp; は優れた選択です！プレミアム音声のため、サाइनインが必要です。続行するにはGoogleで安全にサインインしてください。<!-- The voice you selected <span data-ws-label-state="voiceLabel"></span>&nbsp; is an excellent choice! As it is a premium voice, sign-in is required. Please securely sign in with Google to continue. --></p>
      <br/>
      <button onclick="signIn();" class="Full-width-btn" style="background-color: transparent;color: red;border-color: red">Googleでサインイン<!-- Sign In with Google --></button>
      <div style="flex: 2"></div>
    </div>
    <div style="height:20px;"></div>
  </div>
  </div>

  <div class="Modal" id="voicesModal" style="display: none;">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="display: flex; flex-direction: column;">
      <button class="Close-modal" style="z-index: 999">
        <svg focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <h4 style="font-size: 1.2em;">
        <select class="Language-selector Flag-font" data-ws-onChange="handleLanguageChange" data-ws-value-state="selectedLanguageCode" style="font-size: 1.1em;"></select>
      </h4>
      <div style="max-width: 100%; width: 350px; margin: -5px auto 30px; flex: 1;overflow-y: auto;text-align: left">

        <div style="text-align: center;position: relative">
          <div style="position: absolute;left: 0;top: 7px;opacity: 0.7;font-size: smaller;">
            速度<!-- Speed --> X
          </div>
          <span data-ws-onClick="slower" style="user-select: none;vertical-align: baseline;border: 1px solid blue;text-align: center;cursor: pointer;display: inline-block; line-height: 16px; font-size: 18px; margin: 5px; width: 20px;height: 20px; border-radius: 10px;background-color: white; color: blue;">-</span>
          <span data-ws-label-state="selectedRate" style="width: 2em;display:inline-block;text-align: center">1</span>
          <span data-ws-onClick="faster" style="user-select: none;vertical-align: baseline;border: 1px solid blue;text-align: center;cursor: pointer;display: inline-block; line-height: 16px; font-size: 18px; margin: 5px; width: 20px;height: 20px; border-radius: 10px;background-color: white; color: blue;">+</span>
          <input type="range" data-ws-value-state="selectedRateSliderValue" style="width: 300px;max-width:90%; margin: auto;display: block;height: 50px;" min="1" max="16" data-ws-onInput="onRateChange">
        </div>
        <div style="text-align: right;opacity: 0.7;margin-bottom: 15px;margin-right: 10px;">
          <svg xmlns="http://www.w3.org/2000/svg" class="Middle-vertical-align" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path>
            <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
          </svg>
          <a href="/docs/guides/voiceover/#mix-languages-voices--speeds" target="_blank" style="text-decoration: none;">
            コピー<!-- Copy -->
            <svg xmlns="http://www.w3.org/2000/svg" class="Middle-vertical-align" width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <path d="M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6"></path>
              <path d="M11 13l9 -9"></path>
              <path d="M15 4h5v5"></path>
            </svg>
          </a>
        </div>
        <div class="Best-voices"></div>
        <div class="Voices-list"></div>
      </div>
      <!--<select class="Voice-selector" data-ws-onChange="handleVoiceChange" data-ws-value-state="selectedVoiceUri"></select>-->
      <p style="text-align: center">
        <span style="color: green">✓</span> プレミアムユーザー向けに音声が公開許可されていることを示します<!-- Indicates voice is allowed for publishing for premium users --> <span data-ws-show-if-state="isPremium=true" data-ws-toggle="#upgradeModal">自分自身として🏆<!-- as yourself 🏆 --></span><a data-ws-show-if-state="isPremium=false" data-ws-toggle="#upgradeModal" style="cursor: pointer;">- <u>アップグレードするにはここをクリック<!-- click here to upgrade --></u></a>
      </p>
    </div>
  </div>

  <div class="Modal" id="interfaceLangModal" style="display: none;">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="padding: 20px; overflow: auto;">
      <button class="Close-modal" style="z-index: 999">
        <svg focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <h4 style="font-size: 1.2em;">
        インターフェース言語を選択<!-- Interface Language -->
      </h4>
      <div class="language-selector">
        <!-- Latin Alphabet -->
        <a href="/player/" target="_parent"><img src="https://flagcdn.com/us.svg" alt="English">English</a>
        <a href="/es/" target="_parent"><img src="https://flagcdn.com/es.svg" alt="Español">Español</a>
        <a href="/fr/" target="_parent"><img src="https://flagcdn.com/fr.svg" alt="Français">Français</a>
        <a href="/de/" target="_parent"><img src="https://flagcdn.com/de.svg" alt="Deutsch">Deutsch</a>
        <a href="/it/" target="_parent"><img src="https://flagcdn.com/it.svg" alt="Italiano">Italiano</a>
        <a href="/pt/" target="_parent"><img src="https://flagcdn.com/br.svg" alt="Português">Português</a>
        <a href="/ro/" target="_parent"><img src="https://flagcdn.com/ro.svg" alt="Română">Română</a>
        <a href="/nl/" target="_parent"><img src="https://flagcdn.com/nl.svg" alt="Nederlands">Nederlands</a>

        <!-- Cyrillic Alphabet -->
        <a href="/ru" target="_parent"><img src="https://flagcdn.com/ru.svg" alt="Русский">Русский</a>

        <!-- Indic Alphabet -->
        <a href="/hi/" target="_parent"><img src="https://flagcdn.com/in.svg" alt="हिन्दी">हिन्दी</a>

        <!-- East Asian Scripts -->
        <a href="/zh/" target="_parent"><img src="https://flagcdn.com/cn.svg" alt="中文">中文</a>
        <a href="/ja/" target="_parent"><img src="https://flagcdn.com/jp.svg" alt="日本語">日本語</a>
        <a href="/ko/" target="_parent"><img src="https://flagcdn.com/kr.svg" alt="한국어">한국어</a>

        <!-- Semic Alphabet -->
        <a href="/ar/" target="_parent"><img src="https://flagcdn.com/sa.svg" alt="العربية">العربية</a>
        <a href="/he/" target="_parent"><img src="https://flagcdn.com/il.svg" alt="עברית">עברית</a>

      </div>
    </div>
  </div>

  <div class="Modal" id="openUrlModal" style="display: none;">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="padding: 20px; overflow: auto;">
      <button class="Close-modal" style="z-index: 999">
        <svg focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <br/>
      <p style="text-align: justify"><b>聞きたいウェブページのURLを貼り付けてください。<!-- Paste the URL of the webpage you would like to listen to. --></b>
        &nbsp;URLを取得する方法: 別のタブで目的のページを開き、アドレスバーからアドレスをコピーします。<!-- How to get the URL? Open the desired page in a different tab - then copy its address from the address bar --></p>
      <br/>
      <div class="input-container">
        <input type="text" id="urlInput" class="styled-input" placeholder="https://en.wikipedia.org/wiki/The_Beatles">
        <button class="styled-button" id="urlSubmitButton" data-ws-onClick="onUrlSubmitClick">GO</button>
      </div>

      <br/>
      <p style="text-space: 1.2">URLの例<!-- Examples of valid URLs: --></p>
      <div style="text-align: left; color: orangered; line-height: 1.3em; font-style: italic">
        <p>https://en.wikipedia.org/wiki/The_Beatles</i></p>
        <p>https://www.bbc.com/sport/football/articles/c97dllq4gg1o</p>
      </div>
    </div>
  </div>

  <div class="Modal" id="exportModal" style="display: none;">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="padding: 20px; overflow: auto;">
      <button class="Close-modal" style="z-index: 999">
        <svg focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <h4>NEW Export Text to Audio - MP3 / WAV</h4><!-- TODO: replace with:  -->
      <p><strong>Instant MP3 / WAV generation</strong> for premium users. <strong>You own the copyrights! Use the generated audio for ANY purpose.</strong></p>
      <div style="text-align: justify; font-size: smaller;">
      <p>If you need to export more than 5k chars, or mix voices, or add in-text pauses - please use the 'RECORD ◉' button for now. We're developing solutions to overcome these limitations.</p>
      <ul style="text-align: justify">
        <li>Requires Premium<span data-ws-show-if-state="isPremium=true">, which you are! Fantastic.</span><span data-ws-show-if-state="isPremium=false">. <a href="#" data-ws-toggle="#upgradeModal">Click to upgrade.</a></span></li>
        <li><strong>Please PLAY before export - to make sure it ALL sounds exactly as you like it to. Edit to perfection. Then export when ready.</strong></li>
        <li>It's new - so it may have issues we're unaware of.</li>
        <li>It consumes chars from your quota just like PLAY would.</li>
        <li>Limited to 5,000 chars. Your current text has <span data-ws-label-state="charsCount"></span> chars.</li>
        <li>It only works with premium voices (those marked with a star at the voices gallery)</li>
        <li>It does NOT respect the codes for pauses in text, or for setting voice & rate in text. So <b>make sure the voice & rate are set correctly by the voice-selector controls</b>.</li>
      </ul>
      </div>
      <br/>
      <div>
        <button onclick="sendAnalyticsEvent('exportMP3');" class="full-width-button" data-ws-params="mp3" data-ws-onClick="exportToMp3">Create & Download MP3</button>
        <button onclick="sendAnalyticsEvent('exportWAV');" class="full-width-button" data-ws-params="wav" data-ws-onClick="exportToMp3">Create & Download WAV</button>
      </div>
      <br/>
      <p>How are we doing? Let us know please! <a href="https://docs.google.com/forms/d/e/1FAIpQLSecnm9ZnFje9S6OSSQqP4Ts4av-hSmhAUbuLvQAojWUdckAtg/viewform?usp=sf_link" target="_blank">Feedback Form Link</a></p>
    </div>
  </div>

  <div class="Modal" id="statsModal" style="display: none;">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="padding: 20px; overflow: auto;">
      <button class="Close-modal" style="z-index: 999">
        <svg focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <p style="font-weight: bold">
        Words Count: <span data-ws-label-state="wordsCount">...</span>
      </p>
      <p style="font-weight: bold">
        Characters Count: <span data-ws-label-state="charsCount">...</span>
      </p>
      <p style="font-weight: bold">
        Paragraphs Count: <span data-ws-label-state="paragraphsCount">...</span>
      </p>
      <p style="font-weight: bold">
        Duration:&nbsp;~<span data-ws-label-state="expectedDuration"></span>&nbsp;<span style="font-weight:normal">(at speed X1)</span>.
      </span>

      <br/>
      <button class="full-width-button" data-ws-onClick="calculateStats">Refresh</button>
    </div>
  </div>

  <div class="Modal" id="recordModalNonPremium" style="display: none;">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="display: flex; flex-direction: column;border: orangered 1px solid;">
      <button class="Close-modal">
        <svg style="width: 26px;height: 26px;position: relative;top: 2px;" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <div style="overflow: auto;padding:10px;">
        <h4>合成音声の録音<!-- Recording the Synthesized Speech --></h4>
        <div data-ws-show-if-state="isPremium=false">
          <p style="text-align: justify">
            録音にはプレミアムが必要で、商用利用と出版のライセンスが含まれます（出版条件を参照<!-- Recording requires premium and includes licensing for commercial use & publishing (see publishing terms --> <a href="https://ttsreader.com/docs/guides/commercial/" target="_blank">ここ<!-- here --></a>).
          </p>
          <button data-ws-toggle="#upgradeModal" onclick="signInIfNeeded();" class="Full-width-btn" style="background-color: darkgreen;color: white">プレミアムにアップグレード<!-- Upgrade to Premium --></button>
          <div data-ws-show-if-state="isSignedIn=false">
            <p style="text-align: center">すでにプレミアムですか？サインイン<!-- Already premium? Sign in --></p>
            <button onclick="signIn();" class="Full-width-btn" style="background-color: transparent;color: red;border-color: red">Googleでサインイン<!-- Sign In with Google --></button>
          </div>
        </div>
        <div data-ws-show-if-state="isPremium=true">
          <p style="text-align: center;font-size: larger;">🏆 🍾🥂 アップグレードありがとうございます!!!<!-- Thank you for upgrading!!! --> 🎉🚀 🏆 </p>
          <button data-ws-toggle="#recordStartModal" class="Full-width-btn" style="background-color: transparent;color: cornflowerblue;border-color: cornflowerblue">録音を続ける<!-- Continue with recording --></button>
        </div>
        <br/><br/>
      </div>
    </div>
    <div style="height:20px;"></div>
  </div>

  <div class="Modal" id="recordStartModal" style="display: none;">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="display: flex; flex-direction: column;border: orangered 1px solid;">
      <button class="Close-modal">
        <svg style="width: 26px;height: 26px;position: relative;top: 2px;" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <div style="overflow: auto;padding:10px 30px;">
        <p style="text-align: justify">Once you click the following button a popup will show. There select the 'Entire Screen' & 'Also share system audio' options. Finally, click 'Share'.</p>
        <button data-ws-onClick="startRecording" class="Full-width-btn" style="background-color: darkgreen;color: white">録音を開始<!-- Start Recording --></button>
        <br/>
        <div>
          <img src="images/share_audio.png" style="max-width: 90%; margin: auto;"/>
        </div>
        <p><a target="_blank" href="https://ttsreader.com/docs/guides/voiceover/">Learn on generating mp3 files and the different options here.</a></p>
        <!--<p style="text-align: justify">手順を理解するためにこの短いビデオを見てください。準備ができたら、「録音を開始」ボタンをクリックしてください。&lt;!&ndash; Watch this short video for understanding the steps. When ready - click the 'Start Recording' button. &ndash;&gt;</p>
        <div class="videowrapper">
          <iframe style="display:block" src="https://www.youtube.com/embed/Xq09r01GetQ" title="YouTube video player - Generate audio mp3 files from synthesized speech with TTSReader" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
        </div>
        <br/>-->
      </div>
    </div>
    <div style="height:20px;"></div>
  </div>

  <div class="Modal" id="upgradeModal" style="display: none">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="display: flex; line-height: 1.5em; flex-direction: column;border: orangered 1px solid;width: 800px;max-width: 90%;margin: auto;">
      <button class="Close-modal">
        <svg style="width: 26px;height: 26px;position: relative;top: 2px;" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <div data-ws-show-if-state="isPremium=true" style="padding: 20px;text-align: center;">
        <p style="font-size: larger;">おめでとうございます！あなたは今プレミアムです！<!-- Congrats! You are now Premium! --></p>
        <p style="font-size: 70px; padding: 20px;margin-block: 0.3em;">🏆</p>
        <p data-ws-show-if-state="subscriptionId=true">
          サブスクリプションによる<!-- Via --> <a style="cursor: pointer;text-decoration: underline" data-ws-toggle="#subscriptionModal">サブスクリプション<!-- Subscription --> - 表示と管理にはここをクリック<!-- click here to view & manage --></a>
        </p>
        <p data-ws-show-if-state="subscriptionId=false">
          <span data-ws-show-if-state="isPremiumByLegacy=false">
            1年間のライセンス購入による。有効期限は<!-- Via purchase of 1 year license. Expires in --> <span data-ws-label-state="daysLeftForPremium"></span> 日後に切れます。<!-- days. --> <a target="_blank" href="https://ttsreader.com/upgrade/">延長するにはここをクリック<!-- Click here to extend --></a>
          </span>
          <span data-ws-show-if-state="isPremiumByLegacy=true">
            レガシープランによる - あなたは素晴らしい!!<!-- Via legacy plan - you rock!! -->
          </span>
        </p>
      </div>
      <div style="overflow: auto;padding:10px 30px;" data-ws-show-if-state="isPremium=false">
        <h4>さらにサポートを受ける＆チームをサポートする 🔥🔥🔥<!-- Get More & Support the Team 🔥🔥🔥 --></h4>
        <br/>
        <div data-ws-show-if-state="isSignedIn=false">
          <button class="styled-btn" onclick="toggleSignIn();">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:v="https://vecta.io/nano" width="12" height="12" viewBox="0 0 186.69 190.5">
              <g transform="translate(1184.583 765.171)">
                <path clip-path="none" mask="none" d="M-1089.333-687.239v36.888h51.262c-2.251 11.863-9.006 21.908-19.137 28.662l30.913 23.986c18.011-16.625 28.402-41.044 28.402-70.052 0-6.754-.606-13.249-1.732-19.483z" fill="#4285f4"/>
                <path clip-path="none" mask="none" d="M-1142.714-651.791l-6.972 5.337-24.679 19.223h0c15.673 31.086 47.796 52.561 85.03 52.561 25.717 0 47.278-8.486 63.038-23.033l-30.913-23.986c-8.486 5.715-19.31 9.179-32.125 9.179-24.765 0-45.806-16.712-53.34-39.226z" fill="#34a853"/>
                <path clip-path="none" mask="none" d="M-1174.365-712.61c-6.494 12.815-10.217 27.276-10.217 42.689s3.723 29.874 10.217 42.689c0 .086 31.693-24.592 31.693-24.592-1.905-5.715-3.031-11.776-3.031-18.098s1.126-12.383 3.031-18.098z" fill="#fbbc05"/>
                <path d="M-1089.333-727.244c14.028 0 26.497 4.849 36.455 14.201l27.276-27.276c-16.539-15.413-38.013-24.852-63.731-24.852-37.234 0-69.359 21.388-85.032 52.561l31.692 24.592c7.533-22.514 28.575-39.226 53.34-39.226z" fill="#ea4335" clip-path="none" mask="none"/>
              </g>
            </svg>
            &nbsp;&nbsp;Googleでサインインして開始<!-- Sign In with Google to Start -->
          </button>
          <p style="text-transform: uppercase; opacity: 0.7;font-size: 0.7em;">
            Googleで安全にサインイン<!-- Secure sign in with Google -->
          </p>
        </div>

        <div data-ws-show-if-state="isSignedIn=true" style="box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); padding: 12px; background-color: white; border-radius: 10px;">
          <h2 style="color: black">プレミアムプランを選択<!-- Select Your Premium Plan --></h2>
          <form id="subscriptionForm">
            <div class="option selected" id="option1" onclick="updateStateWithParentData({recurringTab: true})">
              <input type="radio" id="monthly" name="plan" value="monthly" checked>
              <label for="monthly">
                <strong>サブスクリプション<!-- Subscription --> <span class="price-tag">$10.99 / mo.</span></strong><br>
                <span>いつでもキャンセル可能。<!-- Cancel anytime. --></span>
              </label>
            </div>
            <div class="option" id="option2" onclick="updateStateWithParentData({recurringTab: false})">
              <input type="radio" id="yearly" name="plan" value="yearly">
              <label for="yearly">
                <strong>一括払い<!-- One-Time Payment --> <span class="price-tag">$39.00</span></strong><br>
                <span>定期支払いなし。有効期限は<!-- No recurring payments. Valid for a --> <u>1年間<!-- whole year --></u>. <u>自動更新されません</u>。キャンセルの心配なし。<!-- Does <u>NOT</u> auto-renew. Never worry about canceling. --></span>
              </label>
            </div>
          </form>
          <script>
            document.querySelectorAll('#upgradeModal .option').forEach(option => {
              option.addEventListener('click', () => {
                document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                option.querySelector('input').checked = true;
              });
            });
          </script>
          <div data-ws-show-if-state="recurringTab=true">
            <p style="text-align: center">Selected monthly subscription</p>
            <div id="paypal-button-container-subscription"></div>
          </div>
          <div data-ws-show-if-state="recurringTab=false">
            <p style="text-align: center">Selected 1 yr license, non recurring</p>
            <div id="paypal-button-container"></div>
          </div>
          <p style="color: #282c34; font-weight: bolder;">安全な購入。100%満足保証<!-- Secure purchase. 100% satisfaction guaranteed --></p>
        </div>
        <br/>
        <h4 style="text-align: start">&nbsp;&nbsp;&nbsp;主なメリット<!-- Main Benefits --></h4>
        <ul style="list-style-type: '\2705   '; list-style-position: outside; margin: 0 0 1em 0; text-align: start">
          <li>広告なし<!-- No Ads --></li>
          <li>読み込み速度が速い<!-- Faster loading --></li>
          <li>無制限の連続読み上げ - For non premium voices<!-- Unlimited continuous reading --></li>
          <li>Lift daily limit to 200,000 chars per day, 1M char per month for premium voices</li>
          <li>Export to MP3 & WAV</li>
          <li>Windows PCで録音が有効<!-- Recording enabled on Windows PC --></li>
          <li>商用ライセンス and Publishing<!-- Commercial license --></li>
          <li>すべての機能をアンロック<!-- Unlock all features --></li>
          <li>プレミアムサポート<!-- Premium support --></li>
        </ul>
      </div>
    </div>
    <div style="height:20px;"></div>
  </div>


  <div class="Modal" id="subscriptionModal" style="display: none">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="display: flex; line-height: 1.5em; flex-direction: column;border: orangered 1px solid;">
      <button data-ws-hide-all=".Modal" class="Close-modal">
        <svg style="width: 26px;height: 26px;position: relative;top: 2px;" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <div style="overflow: auto;padding:10px 30px;text-align: center">
        <h4 style="text-align: center">サブスクリプションを管理<!-- Manage Subscription --></h4>
        <div data-ws-show-if-state="isPremium=true">
          <p style="font-size: 1em;text-align: center">ℹ️ サブスクリプションID<!-- Subscription id -->: <b><span data-ws-label-state="subscriptionId"></span></b></p>
          <p style="line-height: 1.8em;margin: 10px;"><a href="https://docs.google.com/forms/d/e/1FAIpQLSc-gAEGNiCixhSjTjkJXu3cYSqDJYEMa9vPzRPKnY6Pei_yrQ/viewform?usp=sf_link" target="_blank" style="text-decoration: none;">問題？質問？お問い合わせください（新しいウィンドウでプレミアムコンタクトフォームが開きます）<!-- Issues? Questions? Contact us (opens a premium contact form in new window) --></a></p>
          <br/>
          <p style="color: red;line-height: 1.8em;margin: 10px;">危険ゾーン<!-- DANGER ZONE --></p>
          <p style="color: red; cursor: pointer; padding: 5px 10px; border: red 1px solid; border-radius: 20px; line-height: 1.8em;margin: 10px;" onclick="cancelSubscription();">サブスクリプションをキャンセル。これをクリックするとプレミアムステータスが即座に失われます。<!-- Cancel subscription. Clicking this will result in losing your premium status - taking effect immediately. --></p>
        </div>
        <div data-ws-show-if-state="isPremium=false">
          <br/>
          <p style="font-size: 1em;text-align: center">現在プレミアムに登録していません<!-- You are now not subscribed to Premium --></p>
        </div>
      </div>
    </div>
    <div style="height:20px;"></div>
  </div>

  <!--<div class="Modal" id="mp3GuideModal" style="display: none">
    <div style="height:20px;"></div>
    <div class="Modal-content" style="display: flex; line-height: 1.5em; flex-direction: column;border: orangered 1px solid;">
      <button class="Close-modal">
        <svg style="width: 26px;height: 26px;position: relative;top: 2px;" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <h3>TTSReaderでテキストからmp3ファイルを生成する方法は？&lt;!&ndash; How to generate mp3 files from text with TTSReader? &ndash;&gt;</h3>
      <div class="videowrapper">
        <iframe style="display:block" src="https://www.youtube.com/embed/Xq09r01GetQ" title="YouTube video player - Generate audio mp3 files from synthesized speech with TTSReader" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
      </div>
      <br/>
    </div>
    <div style="height:20px;"></div>
  </div>-->

  <div class="Modal" id="helpModal" style="display: none;">
    <div style="flex:1"></div>
    <div class="Modal-content" style="max-width: 100%;max-height: 90vh;">
      <button class="Close-modal"><svg style="" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></button>
      <div>
        <img id="helpImgId" data-src="images/help.png" style="max-width: 95%;
    margin: auto;
    max-height: 90vh;
    border: orangered 2px solid;
    border-radius: 10px;">
      </div>
    </div>
    <div style="flex:1"></div>
  </div>

  <div class="Modal" id="moreVoices" style="display: none;">
    <div style="flex:1"></div>
    <div class="Modal-content">
      <button class="Close-modal">
        <svg style="" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <div style="overflow-y: auto;max-height: 90%;text-align: justify;">
        <h3 style="text-align: center">さらに多くの音声<!-- More Voices --></h3>

        <p style="text-align: center"><a href="#" onclick="appMethods.showModal('voicesModal');">Click here to preview & select a voice available on your browser</a></p>
        <br/>
        <!--<p style="text-align: center"><b>Other voices on other browsers</b></p>
        <div data-ws-show-if-state="os=win">
          <div data-ws-show-if-state="isChrome=true">
            <p>EdgeブラウザでTTSReaderを使用する際により多くの音声が利用可能です。特に、クリストファーとミシェルはどちらも素晴らしいです！&lt;!&ndash; More voices are available when using TTSReader on the Edge browser. Specifically - Christopher & Michelle are both exceptional! &ndash;&gt;</p>
          </div>
          <div data-ws-show-if-state="isChrome=false">
            <p>Chrome/EdgeブラウザでTTSReaderを使用する際により多くの音声が利用可能です。特に、Chromeではノアが推奨されます。Edgeでは、クリストファーとミシェルの両方が素晴らしいです！&lt;!&ndash; More voices are available when using TTSReader on Chrome / Edge browsers. Specifically - on Chrome - Noah is our recommendation. On Edge - Christopher & Michelle are both exceptional! &ndash;&gt;</p>
          </div>
        </div>
        <div data-ws-show-if-state="os=mac">
          <p>Chrome/EdgeブラウザでTTSReaderを使用する際により多くの音声が利用可能です。特に、Chromeではノアが推奨されます。Edgeでは、クリストファーとミシェルの両方が素晴らしいです！&lt;!&ndash; More voices are available when using TTSReader on Chrome / Edge browsers. Specifically - on Chrome - Noah is our recommendation. On Edge - Christopher & Michelle are both exceptional! &ndash;&gt;</p>
        </div>
        <div>
          <p style="font-weight: bold">利用可能な音声の一部をご紹介します：&lt;!&ndash; Here are some of the available voices: &ndash;&gt;</p>
          <p><u>Edgeで：&lt;!&ndash; On Edge: &ndash;&gt;</u></p>
          <div>Christopher: <audio style="vertical-align: middle" controls src="audio/Christopher.mp3" preload="metadata"/></div>
          <br/>
          <div>Michelle: <audio controls src="audio/Michelle.mp3" preload="metadata"/></div>
          <br/>
          <p><u>Chromeで：&lt;!&ndash; On Chrome: &ndash;&gt;</u></p>
          <div>Noah: <audio controls src="audio/Noah.mp3" preload="metadata"></audio></div>
          <br/>
          <div>Lily: <audio controls src="audio/Lily.mp3" preload="metadata"></audio></div>
          <br/>
        </div>-->
        <p><b>SAPI5 (custom / locally installed) Voices Supported</b></p>
        <p>カスタムSAPI5音声はFirefoxブラウザを使用するWindowsで可能です。<!-- Using custom SAPI5 voices is possible on Windows using Firefox browser. --></p>
        <p><a target="_blank" href="/blog/exciting-news-use-custom-sapi5-voices-on-ttsreader/">See how to use SAPI5 voices with TTSReader</a></p>
        <p>モバイルでは、私たちの<!-- On mobile, you will find more voices using our --> <a href="/mobile/" target="_blank">テキスト音声変換モバイルアプリ<!-- text-to-speech mobile apps --></a></p>
        <p>プレミアムユーザー向けにさらに多くの音声を提供するために取り組んでいます<!-- We're working on making even more voices available for Premium users --></p>
      </div>
    </div>
    <div style="flex:1"></div>
  </div>

  <div class="Modal" id="addPauseModal" style="display: none;">
    <div style="flex:1"></div>
    <div class="Modal-content" style="max-width: 100%;max-height: 100vh;">
      <button class="Close-modal">
        <svg style="" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <div style="overflow-y: auto;max-height: 90%;text-align: center;">
        <h3>読み取りタイマーを追加<!-- Add Pause Reading Timer --></h3>
        <p>次の行をコピーしてテキストに貼り付けます。停止時間の長さをミリ秒で編集します。<!-- Copy the following line and paste into the text. Edit the duration of the pause in milliseconds. --></p>
        <br/>
        <code>{{pause:1000}}</code>
        <br/>
        <a style="text-decoration: none;" class="Link-btn" data-ws-toggle="#addPauseModal" onclick="navigator.clipboard.writeText('\n{{pause:1000}}\n')">
          <svg xmlns="http://www.w3.org/2000/svg" class="Middle-vertical-align" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path>
            <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path>
          </svg>&nbsp;コピー<!-- Copy -->
        </a>
        <br/><br/><br/>
      </div>
    </div>
    <div style="flex:1"></div>
  </div>

  <div class="Modal" id="shareModal" style="display: none;">
    <div style="flex:1"></div>
    <div class="Modal-content" style="max-width: 100%;max-height: 100vh;">
      <button class="Close-modal">
        <svg style="" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
          <path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </button>
      <div>
        <p><a href="https://www.facebook.com/sharer.php?u=https://ttsreader.com/player/" target="_blank">Facebookで共有<!-- Share on Facebook --></a></p>
        <p><a href="https://twitter.com/intent/tweet?url=https://ttsreader.com/player/" target="_blank">Twitterで共有<!-- Share on Twitter --></a></p>
        <p><a href="https://api.whatsapp.com/send?text=https://ttsreader.com/player/" target="_blank">WhatsAppで共有<!-- Share on WhatsApp --></a></p>
        <p><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ttsreader.com/player/" target="_blank">LinkedInで共有<!-- Share on LinkedIn --></a></p>
        <p><a href="#" onclick="copy('https://ttsreader.com/player/');">リンクをコピー<!-- Copy link --></a></p>
      </div>
    </div>
  </div>

  <div class="Modal" id="processingModal" style="display: none; flex-direction: column; align-items: center; justify-content: center;">
    <div style="flex: 1"></div>
    <div class="Modal-content" style="max-width: 100%; max-height: 100vh; text-align: center;">
      <p>Generating audio file... Expect results in:</p>
      <p id="processingTimer" style="font-size: 1.2em;font-weight: bold">01:00</p>
      <p>If results aren't yet ready - please keep waiting - it make take up to a minute in some cases for longer texts.</p>
    </div>
    <div style="flex: 1"></div>
  </div>

</div>


<script>
  function copy(text) {
    navigator.clipboard.writeText(text).then(function() {
      console.log('Copied!');
    }, function() {
      console.log('Copy error')
    });
  }

  function share() {
    const shareData = {
      title: "TTSReader",
      text: "Listen to any text with TTSReader. AI powered natural sounding voices.",
      url: "https://ttsreader.com/player/",
    };

    navigator.share(shareData)
            .then(() => console.log('Share was successful.'))
            .catch((error) => console.log('Sharing failed', error));
  }

  function loadImages(selector) {
    document.querySelectorAll(selector).forEach((el)=>{
      if (!el.getAttribute('src')) {
        el.setAttribute('src', el.getAttribute('data-src'));
      }
    });
  }

  /*var ce = document.querySelector('[contenteditable]')
  ce.addEventListener('paste', function (e) {
    e.preventDefault()
    var text = e.clipboardData.getData('text/plain')
    document.execCommand('insertText', false, text)
  })*/

  document.querySelectorAll('.Modal').forEach((el)=>{
    el.addEventListener('click',((evt) => {
      if (!evt.target.closest('.Modal-content')) {
        evt.target.closest('.Modal').style.display = "none";
      }
    }));
  });

  document.querySelectorAll('.Close-modal').forEach((el)=>{
    el.addEventListener('click',((evt) => {
      evt.target.closest('.Modal').style.display = "none";
    }));
  });

  if (window.matchMedia( "(hover: none)" ).matches) {
    // hover unavailable
    document.addEventListener('click', ({ target }) => {
      if (!target.closest('.Dropdown-content')) {
        document.querySelectorAll('.Dropdown-content').forEach((el)=>{
          el.style.display = 'none';
          document.querySelector('.Text-box').setAttribute('contentEditable',true);
        })
      }
    });

    document.querySelectorAll('.Dropdown-header').forEach((el)=>{
      if (el instanceof Element) {
        el.addEventListener('click',(ev)=>{
          if (ev.target.closest('.Dropdown-content')) {
            return;
          }
          let child = el.querySelector('.Dropdown-content');
          let textBox = document.querySelector('.Text-box');
          if (getComputedStyle(child).display!=="none") {
            child.style.display = 'none';
            textBox.setAttribute('contentEditable',true);
          } else {
            child.style.display = 'block';
            textBox.removeAttribute('contentEditable');
            ev.preventDefault();
            ev.stopPropagation();
          }
        });
      }
    })
  }

  function sendAnalyticsEvent(name) {
    let pre = "ttsreader_player_";
    if (gtag) {
      gtag('event', pre + name, {'value': "1"});
    }
  }

  function feedback(value) {
    if (gtag) {
      gtag('event', value>0 ? "feedback_good" : "feedback_bad", {
        'value': value>0 ? "good" : "bad"
      });
    }

    if (value<0) {
      window.open("https://docs.google.com/forms/d/e/1FAIpQLSecnm9ZnFje9S6OSSQqP4Ts4av-hSmhAUbuLvQAojWUdckAtg/viewform?usp=sf_link","_blank");
    } else {
      alert('Thank you for your feedback ❤️');
    }
  }
</script>

<div id="area" style="height: 0;width: 0; visibility: hidden"></div>

<script>
  /*
  This script is for sign-in and for premium status.
   */

  window.getIdToken = async () => null;

  let clockStartedOn = Date.now();
  function stopper() {
    return Math.round((Date.now()-clockStartedOn)/1000) + ": ";
  }

  function fetchJsFile(url, callback) {
    let newEl = document.createElement('script');
    newEl.src=url;
    newEl.onload = function(){
      if (callback) {
        callback();
      }
    };
    document.getElementsByTagName("head")[0].appendChild(newEl);
  }

  if (document.readyState == "loading") {
    // Still loading, no need for optional added scripts. Wait.
    console.log(stopper() + 'Script awaiting to load all DOM');
    addEventListener('DOMContentLoaded', (event) => {
      runPostLoadScript();
    });
  } else {
    console.log(stopper() + 'Loading script right away');
    runPostLoadScript();
  }

  function runPostLoadScript() {

    console.log(stopper() + 'Loading script post DOM');

    let srcs = [
      "https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js",
      "https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js",
      "https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js",
      "https://unpkg.com/mammoth/mammoth.browser.min.js"
    ]

    let loadedScripts = 0;
    function onScriptLoaded() {
      loadedScripts++;
      if (loadedScripts==srcs.length) {
        runDependentScript();
      } else {
        fetchJsFile(srcs[loadedScripts], onScriptLoaded);
      }
    }

    fetchJsFile(srcs[0], onScriptLoaded);

    function runDependentScript() {
      let firebaseConfig = {
        apiKey: "AIzaSyDqtWayB72nqpH81RMSEgUzFDN1ES0hrcY",
        authDomain: "ttsreader.com",
        databaseURL: "https://ttsreader.firebaseio.com",
        projectId: "ttsreader",
        messagingSenderId: "656667743185"
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      firebase.auth().onAuthStateChanged(function(user) {
        //window.globalMethods.closeModalById("modalSigninVertical");
        console.log(stopper() + 'user signed ' + (user ? "IN" : "OUT"));

        if (user) {
          window.getIdToken = async () => {
            return await user.getIdToken();
          }

          // User is signed in.
          window.updateStateWithParentData({
            wasAuthReceived: true,
            uid: user.uid,
            email: user.email,
            ronenMock: true,
          });
          window.uid = user.uid;
          listenToDatabaseData(user.uid);
          if (window.resetPayPalButtons) {resetPayPalButtons(user.uid);}
        } else {
          // User signed out.
          window.getIdToken = async () => null;

          window.updateStateWithParentData({
            isPremium: false,
            wasAuthReceived: false,
            uid:  "",
            email: "",
            ronenMock: {key: true},
          });
          window.uid = null;
          if (window.getAppState && !getAppState().data.isPremium) {
            injectAds();
          }
        }
      });
    }
  }

  function hashFromString(str) {
    let hash = 0,
            i, chr;
    if (str.length === 0) return hash;
    for (i = 0; i < str.length; i++) {
      chr = str.charCodeAt(i);
      hash = ((hash << 5) - hash) + chr;
      hash |= 0; // Convert to 32bit integer
    }
    return hash;
  }

  function cancelSubscription() {
    if (!window.subscriptionId) {
      alert('No subscription to cancel. If you think this is an error, please contact us via the form or via admin@speechlogger.com');
      return;
    }

    if (confirm('Are you sure you want to cancel your subscription?')) {
      if (window.subscriptionId) {
        // `curl -H 'Content-Type: application/json' -d '{"appId":"speechninja","uid":"", "subId": "I-XBC6BF63D347", "checkSum":"822831988"}' -X POST https://us-central1-ttsreader.cloudfunctions.net/cancelPayPalSubById2`
        let url = "https://us-central1-ttsreader.cloudfunctions.net/cancelPayPalSubById2";  // Production
        // let url = "http://127.0.0.1:5001/ttsreader/us-central1/cancelPayPalSubById2"; // Local testing
        let uid = window.uid;
        let subId = window.subscriptionId;
        let checkSum = "" + hashFromString(uid + subId);
        fetch(url, {
          method: 'POST',
          mode: 'cors',
          headers: {
            'Content-Type': 'text/plain',
          },
          body: JSON.stringify({
            appId: "ttsreader",
            uid: uid,
            subId: subId,
            checkSum: checkSum
          })
        }).then((response) => {
          if (!response.ok) {
            console.log('Error ' + response.status);
            throw new Error('Error ' + response.status);
          } else {
            firebase.database().ref('/subs/' + uid + "/" + subId).remove().then(()=>{
              console.log('Subscription removed');
              alert('Subscription cancelled successfully.');
              window.updateStateWithParentData({
                isPremium: false,
                subs: [],
              });
              injectAds();
            }).catch((err)=>{
              console.log('Subscription remove failed', err);
            });
            updateStateWithParentData({isPremium: false})
          }
        }).then((data) => {
          console.log('Success:', data);
        }).catch((error) => {
          console.error('Error:', error);
          alert('Error cancelling subscription. Please try again later or contact us via the form or via admin@speechlogger.com');
        });
      }
    }
  }



  function listenToDatabaseData(uid) {
    firebase.database().ref('/users/' + uid).on('value', (snapshot) => {
      let data = snapshot.val();
      console.log(stopper() + 'got user data from db: ', data);
      if (!data) {
        window.updateStateWithParentData({
          wasUserDataReceived: true,
          isPremiumByLegacy: false,
        })
        return;
      }

      if (data.isPremium) {
        window.updateStateWithParentData({
          wasUserDataReceived: true,
          isPremiumByLegacy: true,
          isPremium: true,
        });
      } else {
        window.updateStateWithParentData({
          wasUserDataReceived: true,
          isPremiumByLegacy: false,
        });
      }
    });

    // Listen to subs and purchases:
    firebase.database().ref('/subs/' + uid).on('value', (snapshot) => {
      let data = snapshot.val();
      console.log(stopper() + 'got subscriptions data from db: ', data);
      if (data) {
        let subs = data;
        let subsIds = Object.getOwnPropertyNames(subs);
        let additionalParams = {};
        for (const subId of subsIds) {
          let sub = subs[subId];
          if (sub.hasOwnProperty('sku') && sub.sku === "SKU_TTSREADER_PREMIUM_MONTHLY__" && sub.hasOwnProperty('state') && sub.state === "active") {
            additionalParams.isPremium = true;
            additionalParams.subscriptionId = subId; // This will let us determine iof premium comes from sub or other (legacy / purchase)
            window.subscriptionId = subId;
          }
        }
        window.updateStateWithParentData({
          wereSubsReceived: true,
          subs: data,
          ...additionalParams
        });
      } else {
        window.updateStateWithParentData({
          wereSubsReceived: true,
          subs: [],
        });
      }
    });

    firebase.database().ref('/purchases/' + uid).on('value', (snapshot) => {
      let data = snapshot.val();
      console.log(stopper() + 'got purchases data from db: ', data);
      if (data) {
        window.updateStateWithParentData({
          werePurchasesReceived: true,
          purchases: data,
        });
      } else {
        window.updateStateWithParentData({
          werePurchasesReceived: true,
          purchases: [],
        });
      }
    });

    setTimerToCheckIfAllDbDataReceived(()=>{if (!getAppState().data.isPremium) injectAds();});
  }

  function setTimerToCheckIfAllDbDataReceived(onAllDataReceived) {
    let interval = setInterval(() => {
      if (window.getAppState && window.getAppState().data &&
              window.getAppState().data.werePurchasesReceived &&
              window.getAppState().data.wereSubsReceived) {
        clearInterval(interval);
        onAllDataReceived();
      }
    }, 2000);
  }

  function getOs() {
    if (!window.navigator) {
      return "unknown";
    }

    let userAgentLowerCaseString = ("" + navigator.userAgent + " " + navigator.platform + " " + navigator.userAgentData).toLowerCase();

    if (/android/i.test(userAgentLowerCaseString)) {
      return "android";
    }

    if (/mac/i.test(userAgentLowerCaseString) && "ontouchend" in document) {
      return "ios";
    }

    if (/ipad|iphone|ipod|ios/i.test(userAgentLowerCaseString)) {
      return "ios";
    }

    if (/mac/i.test(userAgentLowerCaseString)) {
      return "mac";
    }

    if (/win/i.test(userAgentLowerCaseString)) {
      return "win";
    }

    return "unknown"
  }

  function injectAds() {
    console.log("inject ads");
    if (!window.paypal) {
      // Fetch the following js files:
      const url1 = "https://www.paypal.com/sdk/js?client-id=AUZU9gCiVB9cPTl9r8lUGSUvD-dn8dSsmYzxysRH2Ec4Dv6fpq2g4gK7nZYYrltIFnyAMMS7F5IfN0LG&vault=true"
      const url2 = "static/js/paypal-utils4.js"
      fetchJsFile(url1, ()=>{
        fetchJsFile(url2, ()=>{
          console.log('Paypal loaded');
        });
      });
    }

    let isSafari = window.safari !== undefined;
    let isIos = getOs() === 'ios';
    let DISABLE_ADS = true;

    if (DISABLE_ADS || isSafari || isIos) {
      // TODO: Inject static images links to amazon, or write about premium advantages with a call to action button...
      return;
    } else {
      // Actually inserting ads:
      document.documentElement.removeAttribute('data-no-ads');
      // Inject Adsense:
      let newScriptEl = document.createElement('script');
      newScriptEl.setAttribute("src", "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5434274073094626");
      newScriptEl.setAttribute("async", "true");
      newScriptEl.setAttribute("crossorigin", "anonymous");
      document.getElementsByTagName("head")[0].appendChild(newScriptEl);
      (adsbygoogle = window.adsbygoogle || []).push({});
    }
  }

  function toggleSignIn() {
    var user = firebase.auth().currentUser;
    //console.log("user " , user);

    if (user) {
      // User is signed in.
      signOut();
    } else {
      // No user is signed in.
      signIn();
    }
  }

  function signInIfNeeded() {
    /*let uid = firebase.auth().currentUser ? firebase.auth().currentUser.uid : null;
    if (!uid) {
      signIn();
    }*/
  }

  async function sendWelcome() {
    try {
      let idToken = await firebase.auth().currentUser.getIdToken();
      const response = await fetch('https://us-central1-ttsreader.cloudfunctions.net/welcome', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${idToken}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ name: 'value' })
      });

      if (!response.ok) {
        const errorText = await response.text();
        throw new Error(`HTTP ${response.status} – ${errorText}`);
      }

      const data = await response.json();
      console.log('Success:', data);
      return data;
    } catch (err) {
      console.error('Error:', err.message);
      return null;
    }
  }

  function signOut() {
    firebase.auth().signOut();
  }

  function signIn() {
    let provider = new firebase.auth.GoogleAuthProvider();
    provider.setCustomParameters({
      prompt: 'select_account'  // 🔑 This forces the account selection UI
    });
    firebase.auth().signInWithPopup(provider).then(function(result) {
      // This gives you a Google Access Token. You can use it to access the Google API.
      let token = result.credential.accessToken;
      // The signed-in user info.
      let user = result.user;
      let isNewUser = result.additionalUserInfo.isNewUser;
      if (isNewUser) {
        try {
          sendWelcome();
        } catch (err) {
          console.error('Error on isNewUser: ', err.message);
        }
      }
    }).catch(function(error) {
      // Handle Errors here.
      let errorCode = error.code;
      let errorMessage = error.message;
      // The email of the user's account used.
      let email = error.email;
      // The firebase.auth.AuthCredential type that was used.
      let credential = error.credential;
      // ...
    });
  }
</script>

<script>
  function getUrl(url) {
    fetch(url).then(function(response) {
      return response.text();
    }).then(function(data) {
      console.log(data);
    }).catch(function(err) {
      console.log('Fetch Error :-S', err);
    });
  }
</script>

<script>

  let currentAudio = new Audio();

  document.querySelector(".Voices-Gallery").addEventListener('click',(ev) => {
    if (ev.target.closest("[data-ws-voiceURI]")?.getAttribute("data-ws-voiceURI")) {
      ev.stopPropagation();
      let voiceURI = ev.target.closest("[data-ws-voiceURI]")?.getAttribute("data-ws-voiceURI");
      if (!voiceURI) {
        return;
      }

      appMethods.handleVoiceChange({currentTarget: {value: voiceURI}});
      ev.target.closest('.Voices-Gallery').querySelectorAll('.selected').forEach((el)=> {
        el.classList.remove('selected');
      });
      ev.target.closest(".voice-tile").classList.add('selected');
      let audioSrc = ev.target.closest("[data-ws-voiceURI]").getAttribute("data-ws-audio-src");
      console.log(audioSrc);

      console.log(currentAudio.src.endsWith(audioSrc), currentAudio.src)
      console.log(currentAudio.paused)
      console.log(currentAudio.ended)

      let shouldSimplyStop = audioSrc && currentAudio.src.endsWith(audioSrc) && !currentAudio.paused && !currentAudio.ended;
      // Stop:
      currentAudio.currentTime = 0;  // Always restart from beginning
      currentAudio.pause();

      // Potentially play something else:
      if (!shouldSimplyStop) {
        appMethods.testVoice(voiceURI);
      }
    }
  });

  function openOnboarding() {
    document.getElementById('onboardingModal').style.display = 'flex';
  }

  function closeOnboarding() {
    document.getElementById('onboardingModal').style.display = 'none';
    localStorage.setItem("ttsreader.wasOnboarding3", "true");
  }

  function isVoicePremium() {
    return appMethods.isVoicePremium();
  }

  function jumpToStep(el, index) {
    let parent = el.closest("[data-ws-step]")?.parentElement;
    if (parent) {
      parent.querySelectorAll("[data-ws-step]").forEach((el)=> {
        if (el.getAttribute("data-ws-step")===index) {
          el.style.display = "flex";
        } else {
          el.style.display = "none";
        }
      });
    }
  }

  function nextStep(el) {
    let currentStep = "" + el.closest("[data-ws-step]")?.getAttribute("data-ws-step");
    jumpToStep(el, "" + (Number.parseInt(currentStep) + 1));
  }

  function prevStep(el) {
    let currentStep = "" + el.closest("[data-ws-step]")?.getAttribute("data-ws-step");
    jumpToStep(el, "" + (Number.parseInt(currentStep) - 1));
  }

  const themeSwitches = document.querySelectorAll('.themeSwitch');
  if (document.documentElement.hasAttribute('data-dark-mode')) {
    themeSwitches.forEach((el)=>{
      el.setAttribute('checked', true);
    });
  }
  themeSwitches.forEach((themeSwitch)=>{
    themeSwitch.addEventListener('change', () => {
      if(themeSwitch.checked) {
        setUiToDarkModeAndBgTheme(true);
      } else {
        setUiToDarkModeAndBgTheme(false);
      }
    });
  });

  if (!localStorage.getItem("ttsreader.wasOnboarding3")) {
    openOnboarding();
  }

</script>

</body>
</html>
